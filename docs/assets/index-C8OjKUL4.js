(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))l(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&l(r)}).observe(document,{childList:!0,subtree:!0});function a(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(n){if(n.ep)return;n.ep=!0;const s=a(n);fetch(n.href,s)}})();const y=[{id:"cowden",name:"Cowden",fileName:"Cowden Gauge Sheet1.xlsx",parser:"CowdenParser"},{id:"bigmax",name:"Big Max",fileName:"Big Max Gauge Sheet.xlsx",parser:"BigMaxParser"},{id:"bigmax1h",name:"Big Max 1H",fileName:"Big Max 1H Gauge Sheet.xlsx",parser:"BigMax1HParser"},{id:"southandrews",name:"South Andrews",fileName:"South Andrews Gauge Sheet.xlsm",parser:"SouthAndrewsParser"},{id:"polaris",name:"Polaris",fileName:"Polaris Gauge Sheet.xlsx",parser:"PolarisParser"},{id:"shusa",name:"Shusa",fileName:"Shusa Gauge Sheet.xlsx",parser:"ShusaParser"},{id:"mwwemac",name:"MW-Wemac-Sabrina-Berkley",fileName:"Mw-Wemac-Sabrina-Berkley.xlsx",parser:"MWWemacParser"},{id:"unit130",name:"1-30 Unit 1H",fileName:"1-30 Unit 1H Gauge Sheet.xlsx",parser:"Unit130Parser"},{id:"uls35h",name:"ULS 3-5H",fileName:"ULS 3-5H Gauge Sheet.xlsx",parser:"ULS35HParser"}],H="oilWellData",L="oilWellTheme",m={appData:{},currentSheet:null,currentWell:null,wellProductionCharts:{},batteryProductionChart:null,currentWellData:null,productionDateRange:{min:null,max:null},chartState:{oil:{aggregation:"month",selectedWells:null},water:{aggregation:"month",selectedWells:null},gas:{aggregation:"month",selectedWells:null}},aggregateOilChart:null,aggregateWaterChart:null,aggregateGasChart:null,oilChartDateRange:{min:null,max:null},waterChartDateRange:{min:null,max:null},gasChartDateRange:{min:null,max:null},currentEditSection:null};function ee(){const e=localStorage.getItem(L);e?document.documentElement.setAttribute("data-theme",e):q(),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{localStorage.getItem(L)||q()}),P()}function q(){const e=window.matchMedia("(prefers-color-scheme: dark)").matches;document.documentElement.setAttribute("data-theme",e?"dark":"light"),P()}function te(){const e=document.getElementById("themeToggle");e&&e.addEventListener("click",ae)}function ae(){const t=(document.documentElement.getAttribute("data-theme")||"dark")==="dark"?"light":"dark";document.documentElement.setAttribute("data-theme",t),localStorage.setItem(L,t),P()}function P(){const e=document.querySelector(".theme-toggle-label");if(e){const t=document.documentElement.getAttribute("data-theme")||"dark";e.textContent=t==="dark"?"Light Mode":"Dark Mode"}}function ne(){try{const e=localStorage.getItem(H);e&&(m.appData=JSON.parse(e),Object.values(m.appData).forEach(t=>{t.wells&&t.wells.forEach(a=>{a.production&&(a.production=a.production.map(l=>({...l,date:new Date(l.date)}))),a.wellTests&&(a.wellTests=a.wellTests.map(l=>({...l,date:new Date(l.date)})))})}))}catch(e){console.error("Error loading from storage:",e),m.appData={}}}function N(){try{localStorage.setItem(H,JSON.stringify(m.appData))}catch(e){console.error("Error saving to storage:",e),alert("Error saving data. Storage may be full.")}}function v(e){if(!e)return"-";try{const t=new Date(e);return isNaN(t.getTime())?e:t.toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit"})}catch{return e}}function M(e){if(!e)return"";try{const t=new Date(e);return isNaN(t.getTime())?"":t.toISOString().split("T")[0]}catch{return""}}function K(e){if(!e)return"";const t=document.createElement("div");return t.textContent=e,t.innerHTML}function W(e,t=null,a=null){const l=document.getElementById("productionChartsWrapper");m.currentWellData=e,Object.values(m.wellProductionCharts).forEach(i=>{i&&i.destroy()}),m.wellProductionCharts={},l.innerHTML="";const n=e.production||[],s=e.wellTests||[],r=n.filter(i=>i.date).map(i=>new Date(i.date)).filter(i=>!isNaN(i.getTime()));r.length>0&&(m.productionDateRange.min=new Date(Math.min(...r)),m.productionDateRange.max=new Date(Math.max(...r)),le(t,a));const c=[{key:"oil",label:"Oil (BBL)",unit:"BBL",color:"#78716c",dataKey:"oil",source:"production"},{key:"water",label:"Water (BBL)",unit:"BBL",color:"#3b82f6",dataKey:"water",source:"production"},{key:"gas",label:"Gas (MCF)",unit:"MCF",color:"#22c55e",dataKey:"gas",source:"production"}].filter(i=>(i.source==="production"?n:s).some(u=>u[i.dataKey]!==null&&u[i.dataKey]!==void 0&&!isNaN(u[i.dataKey])));if(c.length===0){l.innerHTML='<div class="chart-placeholder">No production data available</div>';return}c.forEach(i=>{const d=document.createElement("div");d.className="chart-section",d.innerHTML=`
            <div class="chart-label">${i.label}</div>
            <div class="canvas-wrapper">
                <canvas id="chart-${i.key}"></canvas>
            </div>
        `,l.appendChild(d);let h=(i.source==="production"?n:s).filter(p=>p.date&&p[i.dataKey]!==null&&p[i.dataKey]!==void 0).map(p=>({x:new Date(p.date),y:Number(p[i.dataKey])})).filter(p=>!isNaN(p.y)).sort((p,g)=>p.x-g.x);(t||a)&&(h=h.filter(p=>{const g=p.x.getTime();return!(t&&g<t.getTime()||a&&g>a.getTime())}));const f=document.getElementById(`chart-${i.key}`).getContext("2d");m.wellProductionCharts[i.key]=new Chart(f,{type:"scatter",data:{datasets:[{label:i.label,data:h,backgroundColor:i.color,borderColor:i.color,pointRadius:3,pointHoverRadius:5}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:"#282c33",titleColor:"#e8e9eb",bodyColor:"#e8e9eb",callbacks:{title:p=>new Date(p[0].parsed.x).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),label:p=>`${i.label}: ${p.parsed.y}`}}},scales:{x:{type:"time",time:{displayFormats:{day:"MMM-yy",week:"MMM-yy",month:"MMM-yy",quarter:"MMM-yy",year:"yyyy"}},grid:{color:"#3a3f47"},ticks:{color:"#9ea3ab",maxTicksLimit:8}},y:{beginAtZero:!0,title:{display:!0,text:i.unit,color:"#9ea3ab"},grid:{color:"#3a3f47"},ticks:{color:"#9ea3ab"}}}}})})}function le(e=null,t=null){const a=document.getElementById("productionStartDate"),l=document.getElementById("productionEndDate"),n=document.getElementById("btnResetDates");if(!a||!l||!m.productionDateRange.min||!m.productionDateRange.max)return;const s=u=>u?new Date(u).toISOString().split("T")[0]:"",r=s(m.productionDateRange.min),o=s(m.productionDateRange.max);a.min=r,a.max=o,l.min=r,l.max=o,a.value=e?s(e):r,l.value=t?s(t):o;const c=a.cloneNode(!0),i=l.cloneNode(!0),d=n.cloneNode(!0);a.parentNode.replaceChild(c,a),l.parentNode.replaceChild(i,l),n.parentNode.replaceChild(d,n),c.addEventListener("change",G),i.addEventListener("change",G),d.addEventListener("click",se)}function G(){if(!m.currentWellData)return;const e=document.getElementById("productionStartDate"),t=document.getElementById("productionEndDate"),a=e.value?new Date(e.value):null,l=t.value?new Date(t.value+"T23:59:59"):null;W(m.currentWellData,a,l)}function se(){m.currentWellData&&W(m.currentWellData,null,null)}let $=null;function re(e){$=e}function oe(){document.querySelectorAll(".btn-edit[data-edit]").forEach(s=>{const r=s.cloneNode(!0);s.parentNode.replaceChild(r,s),r.addEventListener("click",o=>{o.stopPropagation();const c=r.dataset.edit;ie(c)})});const t=document.getElementById("btnCloseModal"),a=document.getElementById("btnCancelEdit"),l=document.getElementById("editModalOverlay"),n=document.getElementById("btnSaveEdit");if(t){const s=t.cloneNode(!0);t.parentNode.replaceChild(s,t),s.addEventListener("click",x)}if(a){const s=a.cloneNode(!0);a.parentNode.replaceChild(s,a),s.addEventListener("click",x)}if(l){const s=l.cloneNode(!0);l.parentNode.replaceChild(s,l),s.addEventListener("click",x)}if(n){const s=n.cloneNode(!0);n.parentNode.replaceChild(s,n),s.addEventListener("click",fe)}}function ie(e){if(!m.currentSheet||!m.currentWell)return;const t=m.appData[m.currentSheet];if(!t||!t.wells)return;const a=t.wells.find(o=>o.id===m.currentWell);if(!a)return;m.currentEditSection=e;const l=document.getElementById("editModal"),n=document.getElementById("editModalTitle"),s=document.getElementById("editModalBody"),r={chemicalProgram:"Edit Chemical Program",failureHistory:"Edit Failure History",actionItems:"Edit Action Items",pressureReadings:"Edit Pressure Readings"};switch(n.textContent=r[e]||"Edit",e){case"chemicalProgram":s.innerHTML=ce(a.chemicalProgram||{});break;case"failureHistory":s.innerHTML=de(a.failureHistory||[]),ue();break;case"actionItems":s.innerHTML=me(a.actionItems||[]),he();break;case"pressureReadings":s.innerHTML=pe(a.pressureReadings||[]),ge();break}l.classList.add("visible")}function x(){document.getElementById("editModal").classList.remove("visible"),m.currentEditSection=null}function ce(e){const t=e.continuous||{},a=e.truckTreat||{};return`
        <div class="chemical-form-grid">
            <div class="form-column-header"></div>
            <div class="form-column-header">Continuous</div>
            <div class="form-column-header">Truck Treat</div>

            <div class="form-row-label">Rate (gal/month)</div>
            <input type="text" class="edit-form-input" id="editChemContRate" value="${t.rate||""}" placeholder="-">
            <input type="text" class="edit-form-input" id="editChemTruckRate" value="${a.rate||""}" placeholder="-">

            <div class="form-row-label">Chems Used</div>
            <input type="text" class="edit-form-input" id="editChemContChems" value="${t.chems||""}" placeholder="-">
            <input type="text" class="edit-form-input" id="editChemTruckChems" value="${a.chems||""}" placeholder="-">

            <div class="form-row-label">PPM</div>
            <input type="text" class="edit-form-input" id="editChemContPPM" value="${t.ppm||""}" placeholder="-">
            <input type="text" class="edit-form-input" id="editChemTruckPPM" value="${a.ppm||""}" placeholder="-">
        </div>
    `}function de(e){let t="";return e.length>0&&(t=e.map((a,l)=>`
            <tr data-row-index="${l}">
                <td><input type="date" class="edit-table-input" name="dateDown" value="${M(a.dateDown)}"></td>
                <td><input type="date" class="edit-table-input" name="dateUp" value="${M(a.dateUp)}"></td>
                <td><input type="number" class="edit-table-input" name="downtime" value="${a.downtime||""}" placeholder="-"></td>
                <td><input type="number" class="edit-table-input" name="oil" value="${a.oil||""}" placeholder="-"></td>
                <td><input type="text" class="edit-table-input" name="reason" value="${a.reason||""}" placeholder="-"></td>
                <td><input type="text" class="edit-table-input" name="comments" value="${a.comments||""}" placeholder="-"></td>
                <td>
                    <button type="button" class="btn-delete-row" title="Delete row">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </td>
            </tr>
        `).join("")),`
        <div class="edit-table-container">
            <table class="edit-table" id="failureEditTable">
                <thead>
                    <tr>
                        <th>Date Down</th>
                        <th>Date Up</th>
                        <th>Downtime (days)</th>
                        <th>Oil Lost</th>
                        <th>Reason</th>
                        <th>Comments</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody id="failureEditBody">
                    ${t}
                </tbody>
            </table>
        </div>
        <button type="button" class="btn-add-row" id="btnAddFailureRow">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
            Add Entry
        </button>
    `}function ue(){const e=document.getElementById("btnAddFailureRow"),t=document.getElementById("failureEditBody");e&&e.addEventListener("click",()=>{const a=document.createElement("tr");a.innerHTML=`
                <td><input type="date" class="edit-table-input" name="dateDown"></td>
                <td><input type="date" class="edit-table-input" name="dateUp"></td>
                <td><input type="number" class="edit-table-input" name="downtime" placeholder="-"></td>
                <td><input type="number" class="edit-table-input" name="oil" placeholder="-"></td>
                <td><input type="text" class="edit-table-input" name="reason" placeholder="-"></td>
                <td><input type="text" class="edit-table-input" name="comments" placeholder="-"></td>
                <td>
                    <button type="button" class="btn-delete-row" title="Delete row">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </td>
            `,t.appendChild(a),D(a.querySelector(".btn-delete-row"))}),t.querySelectorAll(".btn-delete-row").forEach(a=>{D(a)})}function me(e){let t="";return e.length>0?t=e.map((a,l)=>`
            <div class="action-item-row" data-item-index="${l}">
                <input type="text" class="edit-form-input" name="actionItem" value="${K(a)}">
                <button type="button" class="btn-delete-item" title="Delete item">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
        `).join(""):t='<div class="action-items-empty">No action items. Add one below.</div>',`
        <div class="action-items-editor" id="actionItemsEditor">
            ${t}
        </div>
        <div class="action-items-add-row">
            <input type="text" class="edit-form-input" id="newActionItem" placeholder="Enter new action item...">
            <button type="button" class="btn-add-item" id="btnAddActionItem">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="12" y1="5" x2="12" y2="19"></line>
                    <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
                Add
            </button>
        </div>
    `}function he(){const e=document.getElementById("btnAddActionItem"),t=document.getElementById("newActionItem"),a=document.getElementById("actionItemsEditor"),l=()=>{const n=t.value.trim();if(!n)return;const s=a.querySelector(".action-items-empty");s&&s.remove();const r=document.createElement("div");r.className="action-item-row",r.innerHTML=`
            <input type="text" class="edit-form-input" name="actionItem" value="${K(n)}">
            <button type="button" class="btn-delete-item" title="Delete item">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        `,a.appendChild(r),j(r.querySelector(".btn-delete-item")),t.value="",t.focus()};e&&e.addEventListener("click",l),t&&t.addEventListener("keypress",n=>{n.key==="Enter"&&(n.preventDefault(),l())}),a.querySelectorAll(".btn-delete-item").forEach(n=>{j(n)})}function j(e){e.addEventListener("click",()=>{e.closest(".action-item-row").remove();const a=document.getElementById("actionItemsEditor");a.querySelectorAll(".action-item-row").length===0&&(a.innerHTML='<div class="action-items-empty">No action items. Add one below.</div>')})}function pe(e){let t="";return e.length>0&&(t=e.map((a,l)=>`
            <tr data-row-index="${l}">
                <td><input type="date" class="edit-table-input" name="date" value="${M(a.date)}"></td>
                <td><input type="number" class="edit-table-input" name="casingPsi" value="${a.casingPsi||""}" placeholder="-"></td>
                <td><input type="number" class="edit-table-input" name="tubingPsi" value="${a.tubingPsi||""}" placeholder="-"></td>
                <td><input type="number" class="edit-table-input" name="flowlinePsi" value="${a.flowlinePsi||""}" placeholder="-"></td>
                <td>
                    <button type="button" class="btn-delete-row" title="Delete row">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </td>
            </tr>
        `).join("")),`
        <div class="edit-table-container">
            <table class="edit-table" id="pressureEditTable">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Casing PSI</th>
                        <th>Tubing PSI</th>
                        <th>Flowline PSI</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody id="pressureEditBody">
                    ${t}
                </tbody>
            </table>
        </div>
        <button type="button" class="btn-add-row" id="btnAddPressureRow">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
            Add Entry
        </button>
    `}function ge(){const e=document.getElementById("btnAddPressureRow"),t=document.getElementById("pressureEditBody");e&&e.addEventListener("click",()=>{const a=document.createElement("tr");a.innerHTML=`
                <td><input type="date" class="edit-table-input" name="date"></td>
                <td><input type="number" class="edit-table-input" name="casingPsi" placeholder="-"></td>
                <td><input type="number" class="edit-table-input" name="tubingPsi" placeholder="-"></td>
                <td><input type="number" class="edit-table-input" name="flowlinePsi" placeholder="-"></td>
                <td>
                    <button type="button" class="btn-delete-row" title="Delete row">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </td>
            `,t.appendChild(a),D(a.querySelector(".btn-delete-row"))}),t.querySelectorAll(".btn-delete-row").forEach(a=>{D(a)})}function D(e){e.addEventListener("click",()=>{e.closest("tr").remove()})}function fe(){if(!m.currentSheet||!m.currentWell||!m.currentEditSection)return;const e=m.appData[m.currentSheet];if(!e||!e.wells)return;const t=e.wells.findIndex(l=>l.id===m.currentWell);if(t===-1)return;const a=e.wells[t];switch(m.currentEditSection){case"chemicalProgram":a.chemicalProgram=we();break;case"failureHistory":a.failureHistory=Ce();break;case"actionItems":a.actionItems=ye();break;case"pressureReadings":a.pressureReadings=be();break}N(),x(),$&&$(m.currentSheet,m.currentWell)}function we(){var e,t,a,l,n,s;return{continuous:{rate:((e=document.getElementById("editChemContRate"))==null?void 0:e.value)||"",chems:((t=document.getElementById("editChemContChems"))==null?void 0:t.value)||"",ppm:((a=document.getElementById("editChemContPPM"))==null?void 0:a.value)||""},truckTreat:{rate:((l=document.getElementById("editChemTruckRate"))==null?void 0:l.value)||"",chems:((n=document.getElementById("editChemTruckChems"))==null?void 0:n.value)||"",ppm:((s=document.getElementById("editChemTruckPPM"))==null?void 0:s.value)||""}}}function Ce(){const t=document.getElementById("failureEditBody").querySelectorAll("tr"),a=[];return t.forEach(l=>{var d,u,h,f,p,g;const n=(d=l.querySelector('input[name="dateDown"]'))==null?void 0:d.value,s=(u=l.querySelector('input[name="dateUp"]'))==null?void 0:u.value,r=(h=l.querySelector('input[name="downtime"]'))==null?void 0:h.value,o=(f=l.querySelector('input[name="oil"]'))==null?void 0:f.value,c=(p=l.querySelector('input[name="reason"]'))==null?void 0:p.value,i=(g=l.querySelector('input[name="comments"]'))==null?void 0:g.value;(n||s||r||o||c||i)&&a.push({dateDown:n||null,dateUp:s||null,downtime:r?Number(r):null,oil:o?Number(o):null,reason:c||"",comments:i||""})}),a}function ye(){const t=document.getElementById("actionItemsEditor").querySelectorAll('input[name="actionItem"]'),a=[];return t.forEach(l=>{const n=l.value.trim();n&&a.push(n)}),a}function be(){const t=document.getElementById("pressureEditBody").querySelectorAll("tr"),a=[];return t.forEach(l=>{var c,i,d,u;const n=(c=l.querySelector('input[name="date"]'))==null?void 0:c.value,s=(i=l.querySelector('input[name="casingPsi"]'))==null?void 0:i.value,r=(d=l.querySelector('input[name="tubingPsi"]'))==null?void 0:d.value,o=(u=l.querySelector('input[name="flowlinePsi"]'))==null?void 0:u.value;(n||s||r||o)&&a.push({date:n||null,casingPsi:s?Number(s):null,tubingPsi:r?Number(r):null,flowlinePsi:o?Number(o):null})}),a}function Se(){let e=0,t=0,a=0;const l=new Date;return l.setHours(23,59,59,999),Object.keys(m.appData).forEach(n=>{const s=m.appData[n];s&&s.wells&&s.wells.length>0&&s.wells.forEach(r=>{if(r.status!=="inactive"&&r.wellTests&&r.wellTests.length>0){const o=r.wellTests.filter(c=>new Date(c.date)<=l);if(o.length>0){const c=o[0];c.oil!==null&&!isNaN(c.oil)&&(e+=Number(c.oil)),c.water!==null&&!isNaN(c.water)&&(t+=Number(c.water)),c.gas!==null&&!isNaN(c.gas)&&(a+=Math.max(0,Number(c.gas)))}}})}),{totalOil:Math.round(e*100)/100,totalWater:Math.round(t*100)/100,totalGas:Math.round(a*100)/100}}function ve(e="oil",t=null,a=null,l="month",n=null){const s=new Map;let r=null,o=null;const c=new Date;c.setHours(23,59,59,999);const i=u=>{const h=new Date(u);if(l==="week"){const f=h.getUTCDay(),p=f===0?-6:1-f;h.setUTCDate(h.getUTCDate()+p)}else l==="month"&&h.setUTCDate(1);return h.setUTCHours(0,0,0,0),h};Object.keys(m.appData).forEach(u=>{const h=m.appData[u];h&&h.wells&&h.wells.length>0&&h.wells.forEach(f=>{if(f.status==="inactive"||n&&!n.has(f.id))return;(f.production||[]).forEach(g=>{if(!g.date)return;const w=new Date(g.date);if(isNaN(w.getTime())||w>c)return;let C=g[e];if(C==null||isNaN(C))return;e==="gas"&&C<0&&(C=0);const b=i(w);(!r||b<r)&&(r=b),(!o||b>o)&&(o=b);const _=b.toISOString().split("T")[0],Q=s.get(_)||0;s.set(_,Q+Number(C))})})});let d=Array.from(s.entries()).map(([u,h])=>({x:new Date(u),y:h})).sort((u,h)=>u.x-h.x);return(t||a)&&(d=d.filter(u=>{const h=u.x.getTime();return!(t&&h<t.getTime()||a&&h>a.getTime())})),{data:d,dateRange:{min:r,max:o}}}function Te(e=10){const t=[],a=new Date;return a.setHours(23,59,59,999),Object.keys(m.appData).forEach(l=>{const n=m.appData[l],s=y.find(r=>r.id===l);n&&n.wells&&s&&n.wells.forEach(r=>{if(r.status==="inactive")return;let o=null,c=null;if(r.wellTests&&r.wellTests.length>0){const i=r.wellTests.filter(d=>new Date(d.date)<=a);if(i.length>0){const d=i[0];o=d.oil,c=d.water}}t.push({wellId:r.id,wellName:r.name,sheetId:l,batteryName:s.name,oil:o!==null?Math.round(Number(o)*100)/100:0,water:c!==null?Math.round(Number(c)*100)/100:0})})}),t.sort((l,n)=>n.oil-l.oil),t.slice(0,e)}function Ee(e=10){const t=[],a=new Date;return a.setHours(23,59,59,999),Object.keys(m.appData).forEach(l=>{const n=m.appData[l],s=y.find(r=>r.id===l);n&&n.wells&&s&&n.wells.forEach(r=>{r.status!=="inactive"&&r.wellTests&&r.wellTests.length>0&&r.wellTests.forEach(o=>{if(o.date){const c=new Date(o.date);if(c>a)return;t.push({date:c,wellId:r.id,wellName:r.name,sheetId:l,batteryName:s.name,oil:o.oil!==null?Math.round(o.oil*100)/100:null,water:o.water!==null?Math.round(o.water*100)/100:null,gas:o.gas!==null?Math.round(Math.max(0,o.gas)*100)/100:null})}})})}),t.sort((l,n)=>n.date-l.date),t.slice(0,e)}function xe(e=15){const t=[];return Object.keys(m.appData).forEach(a=>{const l=m.appData[a],n=y.find(s=>s.id===a);l&&l.wells&&n&&l.wells.forEach(s=>{s.status!=="inactive"&&s.actionItems&&s.actionItems.length>0&&s.actionItems.forEach(r=>{r&&r.trim()&&t.push({content:r,wellId:s.id,wellName:s.name,sheetId:a,batteryName:n.name})})})}),t.slice(0,e)}function Y(){return Object.keys(m.appData).some(e=>m.appData[e]&&m.appData[e].wells&&m.appData[e].wells.length>0)}const ke={id:"cowden",name:"Cowden",expectedFileName:"Cowden Gauge Sheet1.xlsx",wells:[{id:"601h",name:"Cowden 601H",oilCol:1,waterCol:2,gasCol:3},{id:"602h",name:"Cowden 602H",oilCol:7,waterCol:8,gasCol:9},{id:"angus",name:"Angus 7-18-1H",oilCol:13,waterCol:14,gasCol:15}],parse(e){const t={id:this.id,name:this.name,lastUpdated:new Date().toISOString(),wells:[],runTickets:[],rawRowCount:0};if(e.Sheets["Well Test"]){const a=this.parseWellTestSheet(e.Sheets["Well Test"]);t.wells=a.wells,t.rawRowCount=a.rowCount}return e.Sheets["Run Tickets"]&&(t.runTickets=this.parseRunTicketsSheet(e.Sheets["Run Tickets"])),t},parseWellTestSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),a=this.wells.map(n=>({id:n.id,name:n.name,status:"active",wellTests:[],production:[],chemicalProgram:{continuous:{rate:null,chems:"-",ppm:null},truckTreat:{rate:null,chems:"-",ppm:null}},failureHistory:[],pressureReadings:[],actionItems:[]}));let l=0;for(let n=4;n<t.length;n++){const s=t[n];if(!s||!s[0])continue;const r=s[0];let o=null;if(r instanceof Date)o=r.toISOString().split("T")[0];else if(typeof r=="number"){const c=XLSX.SSF.parse_date_code(r);c&&(o=`${c.y}-${String(c.m).padStart(2,"0")}-${String(c.d).padStart(2,"0")}`)}else typeof r=="string"&&(o=r.split(" ")[0]);o&&(l++,this.wells.forEach((c,i)=>{const d=this.parseNumber(s[c.oilCol]),u=this.parseNumber(s[c.waterCol]),h=this.parseNumber(s[c.gasCol]);(d!==null||u!==null||h!==null)&&(a[i].wellTests.push({date:o,oil:d,water:u,gas:h}),a[i].production.push({date:new Date(o),oil:d,water:u,gas:h}))}))}return a.forEach(n=>{n.wellTests.sort((s,r)=>new Date(r.date)-new Date(s.date)),n.wellTests=n.wellTests.slice(0,60),n.production.sort((s,r)=>s.date-r.date)}),{wells:a,rowCount:l}},parseRunTicketsSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),a=[];for(let l=3;l<t.length;l++){const n=t[l];if(!n)continue;const s=n[1];if(!s)continue;let r=null;const o=n[0];if(o)if(o instanceof Date)r=o.toISOString().split("T")[0];else if(typeof o=="number"){const c=XLSX.SSF.parse_date_code(o);c&&(r=`${c.y}-${String(c.m).padStart(2,"0")}-${String(c.d).padStart(2,"0")}`)}else typeof o=="string"&&o.trim()&&(r=o.split(" ")[0]);a.push({date:r,ticketNum:String(s),tank:this.parseNumber(n[2]),ftTop:this.parseNumber(n[3]),inTop:this.parseNumber(n[4]),ftBttm:this.parseNumber(n[5]),inBttm:this.parseNumber(n[6]),calcVol:this.parseNumber(n[7]),vol:this.parseNumber(n[8]),gravity:this.parseNumber(n[9]),bsw:this.parseNumber(n[10])})}return a.sort((l,n)=>!l.date&&!n.date?0:l.date?n.date?new Date(n.date)-new Date(l.date):-1:1),a.slice(0,100)},parseNumber(e){if(e==null||e==="")return null;const t=parseFloat(e);return isNaN(t)?null:t<0?0:t}},De={id:"bigmax",name:"Big Max",expectedFileName:"Big Max Gauge Sheet.xlsx",wells:[{id:"bigmax-1-1",name:"Big Max 1 #1",oilCol:1,waterCol:2,gasCol:3,status:"active"},{id:"bigmax-4-1",name:"Big Max 4 #1",oilCol:7,waterCol:8,gasCol:9,status:"active"},{id:"bigmax-5-2",name:"Big Max 5 #2",oilCol:13,waterCol:14,gasCol:15,status:"active"},{id:"bigmax-11-1",name:"Big Max 11 #1",oilCol:19,waterCol:20,gasCol:21,status:"active"},{id:"bigmax-11-2",name:"Big Max 11 #2",oilCol:25,waterCol:26,gasCol:27,status:"active"},{id:"bigmax-12-1",name:"Big Max 12 #1",oilCol:31,waterCol:32,gasCol:33,status:"active"},{id:"bigmax-12-2",name:"Big Max 12 #2",oilCol:37,waterCol:38,gasCol:39,status:"active"},{id:"bigmax-13-3",name:"Big Max 13 #3",oilCol:43,waterCol:44,gasCol:45,status:"active"},{id:"bigmax-13-5",name:"Big Max 13 #5",oilCol:49,waterCol:50,gasCol:51,status:"active"},{id:"bigmax-14-4",name:"Big Max 14 #4",oilCol:55,waterCol:56,gasCol:57,status:"active"},{id:"bigmax-swd",name:"Big Max 12-101 SWD",oilCol:61,waterCol:62,gasCol:63,status:"active",wellType:"swd"}],parse(e){const t={id:this.id,name:this.name,lastUpdated:new Date().toISOString(),wells:[],runTickets:[],rawRowCount:0};if(e.Sheets["Well Test"]){const a=this.parseWellTestSheet(e.Sheets["Well Test"]);t.wells=a.wells,t.rawRowCount=a.rowCount}return e.Sheets["Run Tickets"]&&(t.runTickets=this.parseRunTicketsSheet(e.Sheets["Run Tickets"])),t},parseWellTestSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),a=this.wells.map(n=>({id:n.id,name:n.name,status:n.status||"active",wellType:n.wellType||"production",wellTests:[],production:[],chemicalProgram:{continuous:{rate:null,chems:"-",ppm:null},truckTreat:{rate:null,chems:"-",ppm:null}},failureHistory:[],pressureReadings:[],actionItems:[]}));let l=0;for(let n=4;n<t.length;n++){const s=t[n];if(!s||!s[0])continue;const r=this.parseDate(s[0]);r&&(l++,this.wells.forEach((o,c)=>{const i=this.parseNumber(s[o.oilCol]),d=this.parseNumber(s[o.waterCol]),u=this.parseNumber(s[o.gasCol]);(i!==null||d!==null||u!==null)&&(a[c].wellTests.push({date:r,oil:i,water:d,gas:u}),a[c].production.push({date:new Date(r),oil:i,water:d,gas:u}))}))}return a.forEach(n=>{n.wellTests.sort((s,r)=>new Date(r.date)-new Date(s.date)),n.wellTests=n.wellTests.slice(0,60),n.production.sort((s,r)=>s.date-r.date)}),{wells:a,rowCount:l}},parseRunTicketsSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),a=[];for(let l=3;l<t.length;l++){const n=t[l];!n||!n[1]||a.push({date:this.parseDate(n[0]),ticketNum:String(n[1]||""),tank:this.parseNumber(n[2]),ftTop:this.parseNumber(n[3]),inTop:this.parseNumber(n[4]),ftBttm:this.parseNumber(n[5]),inBttm:this.parseNumber(n[6]),vol:this.parseNumber(n[8])})}return a.sort((l,n)=>(n.date||"").localeCompare(l.date||"")),a.slice(0,100)},parseDate(e){if(!e)return null;if(e instanceof Date)return e.toISOString().split("T")[0];if(typeof e=="number"){const t=XLSX.SSF.parse_date_code(e);if(t)return`${t.y}-${String(t.m).padStart(2,"0")}-${String(t.d).padStart(2,"0")}`}return typeof e=="string"?e.split(" ")[0]:null},parseNumber(e){if(e==null||e==="")return null;const t=parseFloat(e);return isNaN(t)?null:t<0?0:t}},Ne={id:"bigmax1h",name:"Big Max 1H",expectedFileName:"Big Max 1H Gauge Sheet.xlsx",wells:[{id:"bigmax-1-1h",name:"Big Max 1-1H",oilCol:1,waterCol:2,gasCol:3}],parse(e){const t={id:this.id,name:this.name,lastUpdated:new Date().toISOString(),wells:[],runTickets:[],rawRowCount:0};if(e.Sheets["Well Test"]){const a=this.parseWellTestSheet(e.Sheets["Well Test"]);t.wells=a.wells,t.rawRowCount=a.rowCount}return e.Sheets["Run Tickets"]&&(t.runTickets=this.parseRunTicketsSheet(e.Sheets["Run Tickets"])),t},parseWellTestSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),a=this.wells.map(n=>({id:n.id,name:n.name,status:"active",wellTests:[],production:[],chemicalProgram:{continuous:{rate:null,chems:"-",ppm:null},truckTreat:{rate:null,chems:"-",ppm:null}},failureHistory:[],pressureReadings:[],actionItems:[]}));let l=0;for(let n=4;n<t.length;n++){const s=t[n];if(!s||!s[0])continue;const r=this.parseDate(s[0]);r&&(l++,this.wells.forEach((o,c)=>{const i=this.parseNumber(s[o.oilCol]),d=this.parseNumber(s[o.waterCol]),u=this.parseNumber(s[o.gasCol]);(i!==null||d!==null||u!==null)&&(a[c].wellTests.push({date:r,oil:i,water:d,gas:u}),a[c].production.push({date:new Date(r),oil:i,water:d,gas:u}))}))}return a.forEach(n=>{n.wellTests.sort((s,r)=>new Date(r.date)-new Date(s.date)),n.wellTests=n.wellTests.slice(0,60),n.production.sort((s,r)=>s.date-r.date)}),{wells:a,rowCount:l}},parseRunTicketsSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),a=[];for(let l=3;l<t.length;l++){const n=t[l];!n||!n[1]||a.push({date:this.parseDate(n[0]),ticketNum:String(n[1]||""),tank:this.parseNumber(n[2]),ftTop:this.parseNumber(n[3]),inTop:this.parseNumber(n[4]),ftBttm:this.parseNumber(n[5]),inBttm:this.parseNumber(n[6]),vol:this.parseNumber(n[8])})}return a.sort((l,n)=>(n.date||"").localeCompare(l.date||"")),a.slice(0,100)},parseDate(e){if(!e)return null;if(e instanceof Date)return e.toISOString().split("T")[0];if(typeof e=="number"){const t=XLSX.SSF.parse_date_code(e);if(t)return`${t.y}-${String(t.m).padStart(2,"0")}-${String(t.d).padStart(2,"0")}`}return typeof e=="string"?e.split(" ")[0]:null},parseNumber(e){if(e==null||e==="")return null;const t=parseFloat(e);return isNaN(t)?null:t<0?0:t}},Ie={id:"southandrews",name:"South Andrews",expectedFileName:"South Andrews Gauge Sheet.xlsm",wellsPg1:[{id:"uls-1-30-6h",name:"1-30-6H",oilCol:1,waterCol:2,gasCol:3},{id:"uls-1-30-8h",name:"1-30-8H",oilCol:7,waterCol:8,gasCol:9},{id:"uls-1-31-2h",name:"1-31-2H",oilCol:13,waterCol:14,gasCol:15},{id:"uls-1-36-1h",name:"1-36-1H",oilCol:19,waterCol:20,gasCol:21},{id:"uls-1-36-2h",name:"1-36-2H",oilCol:25,waterCol:26,gasCol:27},{id:"uls-1-36-3h",name:"1-36-3H",oilCol:31,waterCol:32,gasCol:33},{id:"uls-1-36-4h",name:"1-36-4H",oilCol:37,waterCol:38,gasCol:39},{id:"uls-1-36-5h",name:"1-36-5H",oilCol:43,waterCol:44,gasCol:45},{id:"uls-1-36-6h",name:"1-36-6H",oilCol:49,waterCol:50,gasCol:51},{id:"uls-1-37-1h",name:"1-37-1H",oilCol:55,waterCol:56,gasCol:57},{id:"uls-1-37-3h",name:"1-37-3H",oilCol:61,waterCol:62,gasCol:63},{id:"uls-1-37-4h",name:"1-37-4H",oilCol:67,waterCol:68,gasCol:69},{id:"uls-1-37-6h",name:"1-37-6H",oilCol:73,waterCol:74,gasCol:75}],wellsPg2:[{id:"cobra-5h",name:"Cobra 5H",oilCol:1,waterCol:2,gasCol:3,status:"active"},{id:"cobra-3012",name:"Cobra 3012",oilCol:7,waterCol:8,gasCol:9,status:"active"},{id:"cobra-3033",name:"Cobra 3033",oilCol:13,waterCol:14,gasCol:15,status:"active"},{id:"fn-3731",name:"FN 3731",oilCol:19,waterCol:20,gasCol:21,status:"active"},{id:"pinnacle-1",name:"Pinnacle #1",oilCol:25,waterCol:26,gasCol:27,status:"active"},{id:"pinnacle-2h",name:"Pinnacle 2H",oilCol:31,waterCol:32,gasCol:33,status:"active"},{id:"sawgrass-2h",name:"Sawgrass 2H",oilCol:37,waterCol:38,gasCol:39,status:"inactive"},{id:"sawgrass-5h",name:"Sawgrass 5H",oilCol:43,waterCol:44,gasCol:45,status:"active"}],parse(e){const t={id:this.id,name:this.name,lastUpdated:new Date().toISOString(),wells:[],runTickets:[],rawRowCount:0};if(e.Sheets["Well Test pg1"]){const a=this.parseWellTestSheet(e.Sheets["Well Test pg1"],this.wellsPg1);t.wells.push(...a.wells),t.rawRowCount=a.rowCount}if(e.Sheets["Well Test pg2"]){const a=this.parseWellTestSheet(e.Sheets["Well Test pg2"],this.wellsPg2);t.wells.push(...a.wells)}return["36-4H Tickets","37-6H Tickets","36 6H Tickets"].forEach(a=>{if(e.Sheets[a]){const l=this.parseRunTicketsSheet(e.Sheets[a]);t.runTickets.push(...l)}}),t.runTickets.sort((a,l)=>(l.date||"").localeCompare(a.date||"")),t.runTickets=t.runTickets.slice(0,100),t},parseWellTestSheet(e,t){const a=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),l=t.map(s=>({id:s.id,name:s.name,status:s.status||"active",wellTests:[],production:[],chemicalProgram:{continuous:{rate:null,chems:"-",ppm:null},truckTreat:{rate:null,chems:"-",ppm:null}},failureHistory:[],pressureReadings:[],actionItems:[]}));let n=0;for(let s=4;s<a.length;s++){const r=a[s];if(!r||!r[0])continue;const o=this.parseDate(r[0]);o&&(n++,t.forEach((c,i)=>{const d=this.parseNumber(r[c.oilCol]),u=this.parseNumber(r[c.waterCol]),h=this.parseNumber(r[c.gasCol]);(d!==null||u!==null||h!==null)&&(l[i].wellTests.push({date:o,oil:d,water:u,gas:h}),l[i].production.push({date:new Date(o),oil:d,water:u,gas:h}))}))}return l.forEach(s=>{s.wellTests.sort((r,o)=>new Date(o.date)-new Date(r.date)),s.wellTests=s.wellTests.slice(0,60),s.production.sort((r,o)=>r.date-o.date)}),{wells:l,rowCount:n}},parseRunTicketsSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),a=[];for(let l=3;l<t.length;l++){const n=t[l];!n||!n[1]||a.push({date:this.parseDate(n[0]),ticketNum:String(n[1]||""),tank:this.parseNumber(n[2]),ftTop:this.parseNumber(n[3]),inTop:this.parseNumber(n[4]),ftBttm:this.parseNumber(n[5]),inBttm:this.parseNumber(n[6]),vol:this.parseNumber(n[8])})}return a},parseDate(e){if(!e)return null;if(e instanceof Date)return e.toISOString().split("T")[0];if(typeof e=="number"){const t=XLSX.SSF.parse_date_code(e);if(t)return`${t.y}-${String(t.m).padStart(2,"0")}-${String(t.d).padStart(2,"0")}`}return typeof e=="string"?e.split(" ")[0]:null},parseNumber(e){if(e==null||e==="")return null;const t=parseFloat(e);return isNaN(t)?null:t<0?0:t}},Be={id:"polaris",name:"Polaris",expectedFileName:"Polaris Gauge Sheet.xlsx",wells:[{id:"polaris-1",name:"Polaris #1",oilCol:1,waterCol:2,gasCol:3,status:"active"},{id:"polaris-2",name:"Polaris #2",oilCol:5,waterCol:6,gasCol:7,status:"inactive"}],parse(e){const t={id:this.id,name:this.name,lastUpdated:new Date().toISOString(),wells:[],runTickets:[],rawRowCount:0};if(e.Sheets["Well Test"]){const a=this.parseWellTestSheet(e.Sheets["Well Test"]);t.wells=a.wells,t.rawRowCount=a.rowCount}return e.Sheets["Run Tickets"]&&(t.runTickets=this.parseRunTicketsSheet(e.Sheets["Run Tickets"])),t},parseWellTestSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),a=this.wells.map(n=>({id:n.id,name:n.name,status:n.status||"active",wellTests:[],production:[],chemicalProgram:{continuous:{rate:null,chems:"-",ppm:null},truckTreat:{rate:null,chems:"-",ppm:null}},failureHistory:[],pressureReadings:[],actionItems:[]}));let l=0;for(let n=4;n<t.length;n++){const s=t[n];if(!s||!s[0])continue;const r=this.parseDate(s[0]);r&&(l++,this.wells.forEach((o,c)=>{const i=this.parseNumber(s[o.oilCol]),d=this.parseNumber(s[o.waterCol]),u=this.parseNumber(s[o.gasCol]);(i!==null||d!==null||u!==null)&&(a[c].wellTests.push({date:r,oil:i,water:d,gas:u}),a[c].production.push({date:new Date(r),oil:i,water:d,gas:u}))}))}return a.forEach(n=>{n.wellTests.sort((s,r)=>new Date(r.date)-new Date(s.date)),n.wellTests=n.wellTests.slice(0,60),n.production.sort((s,r)=>s.date-r.date)}),{wells:a,rowCount:l}},parseRunTicketsSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),a=[];for(let l=3;l<t.length;l++){const n=t[l];!n||!n[1]||a.push({date:this.parseDate(n[0]),ticketNum:String(n[1]||""),tank:this.parseNumber(n[2]),ftTop:this.parseNumber(n[3]),inTop:this.parseNumber(n[4]),ftBttm:this.parseNumber(n[5]),inBttm:this.parseNumber(n[6]),vol:this.parseNumber(n[8])})}return a.sort((l,n)=>(n.date||"").localeCompare(l.date||"")),a.slice(0,100)},parseDate(e){if(!e)return null;if(e instanceof Date)return e.toISOString().split("T")[0];if(typeof e=="number"){const t=XLSX.SSF.parse_date_code(e);if(t)return`${t.y}-${String(t.m).padStart(2,"0")}-${String(t.d).padStart(2,"0")}`}return typeof e=="string"?e.split(" ")[0]:null},parseNumber(e){if(e==null||e==="")return null;const t=parseFloat(e);return isNaN(t)?null:t<0?0:t}},Le={id:"shusa",name:"Shusa",expectedFileName:"Shusa Gauge Sheet.xlsx",wells20RB:[{id:"shusa-20-1",name:"Shusa 20 #1",oilCol:1,waterCol:2,gasCol:null},{id:"shusa-20-2",name:"Shusa 20 #2",oilCol:5,waterCol:6,gasCol:null},{id:"shusa-20-3",name:"Shusa 20 #3",oilCol:9,waterCol:10,gasCol:null},{id:"shusa-20-4",name:"Shusa 20 #4",oilCol:13,waterCol:14,gasCol:null},{id:"shusa-20-5",name:"Shusa 20 #5",oilCol:17,waterCol:18,gasCol:null},{id:"rosebud-20-1",name:"Rosebud 20 #1",oilCol:21,waterCol:22,gasCol:null},{id:"rosebud-20-3",name:"Rosebud 20 #3",oilCol:25,waterCol:26,gasCol:null},{id:"rosebud-20-4",name:"Rosebud 20 #4",oilCol:29,waterCol:30,gasCol:null},{id:"rosebud-yates-1",name:"Rosebud-Yates #1",oilCol:33,waterCol:34,gasCol:35},{id:"link-2",name:"Link #2",oilCol:39,waterCol:40,gasCol:null},{id:"link-3",name:"Link #3",oilCol:43,waterCol:44,gasCol:null},{id:"link-4",name:"Link #4",oilCol:47,waterCol:48,gasCol:null},{id:"link-5",name:"Link #5",oilCol:51,waterCol:52,gasCol:null},{id:"link-6",name:"Link #6",oilCol:55,waterCol:56,gasCol:null}],wells1415:[{id:"shusa-14-1",name:"Shusa 14 #1",oilCol:4,waterCol:5,gasCol:null},{id:"shusa-14-2",name:"Shusa 14 #2",oilCol:8,waterCol:9,gasCol:null},{id:"shusa-14-3",name:"Shusa 14 #3",oilCol:12,waterCol:13,gasCol:null},{id:"shusa-14-4",name:"Shusa 14 #4",oilCol:16,waterCol:17,gasCol:null},{id:"shusa-14-5",name:"Shusa 14 #5",oilCol:20,waterCol:21,gasCol:null},{id:"shusa-14-6",name:"Shusa 14 #6",oilCol:24,waterCol:25,gasCol:null},{id:"shusa-14-7",name:"Shusa 14 #7",oilCol:28,waterCol:29,gasCol:null},{id:"shusa-14-8",name:"Shusa 14 #8",oilCol:32,waterCol:33,gasCol:null},{id:"shusa-14-9",name:"Shusa 14 #9",oilCol:36,waterCol:37,gasCol:null},{id:"shusa-14-10",name:"Shusa 14 #10",oilCol:40,waterCol:41,gasCol:null},{id:"shusa-14-12",name:"Shusa 14 #12",oilCol:44,waterCol:45,gasCol:null},{id:"shusa-15-1",name:"Shusa 15 #1",oilCol:48,waterCol:49,gasCol:null},{id:"shusa-15-2",name:"Shusa 15 #2",oilCol:52,waterCol:53,gasCol:null},{id:"shusa-15-3",name:"Shusa 15 #3",oilCol:56,waterCol:57,gasCol:null},{id:"shusa-15-4",name:"Shusa 15 #4",oilCol:60,waterCol:61,gasCol:null},{id:"shusa-15-6",name:"Shusa 15 #6",oilCol:64,waterCol:65,gasCol:null},{id:"shusa-15-7",name:"Shusa 15 #7",oilCol:68,waterCol:69,gasCol:null},{id:"shusa-15-8",name:"Shusa 15 #8",oilCol:72,waterCol:73,gasCol:null},{id:"shusa-15-9",name:"Shusa 15 #9",oilCol:76,waterCol:77,gasCol:null},{id:"shusa-15-10",name:"Shusa 15 #10",oilCol:80,waterCol:81,gasCol:null},{id:"shusa-15-11",name:"Shusa 15 #11",oilCol:84,waterCol:85,gasCol:null},{id:"shusa-15-12",name:"Shusa 15 #12",oilCol:88,waterCol:89,gasCol:null},{id:"shusa-15-13",name:"Shusa 15 #13",oilCol:92,waterCol:93,gasCol:null},{id:"shusa-15-14",name:"Shusa 15 #14",oilCol:96,waterCol:97,gasCol:null},{id:"shusa-15-15",name:"Shusa 15 #15",oilCol:100,waterCol:101,gasCol:null},{id:"shusa-15-16",name:"Shusa 15 #16",oilCol:104,waterCol:105,gasCol:null}],parse(e){const t={id:this.id,name:this.name,lastUpdated:new Date().toISOString(),wells:[],runTickets:[],rawRowCount:0};if(e.Sheets["Well Test 20 RB Link"]){const a=this.parseWellTestSheet(e.Sheets["Well Test 20 RB Link"],this.wells20RB);t.wells.push(...a.wells),t.rawRowCount=a.rowCount}if(e.Sheets["Well Test 14 15"]){const a=this.parseWellTestSheet(e.Sheets["Well Test 14 15"],this.wells1415);t.wells.push(...a.wells)}return["14-15 Run Tickets","20-RB Run Tickets","Link Run Tickets","Yates Run Tickets"].forEach(a=>{if(e.Sheets[a]){const l=this.parseRunTicketsSheet(e.Sheets[a]);t.runTickets.push(...l)}}),t.runTickets.sort((a,l)=>(l.date||"").localeCompare(a.date||"")),t.runTickets=t.runTickets.slice(0,100),t},parseWellTestSheet(e,t){const a=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),l=t.map(s=>({id:s.id,name:s.name,status:"active",wellTests:[],production:[],chemicalProgram:{continuous:{rate:null,chems:"-",ppm:null},truckTreat:{rate:null,chems:"-",ppm:null}},failureHistory:[],pressureReadings:[],actionItems:[]}));let n=0;for(let s=4;s<a.length;s++){const r=a[s];if(!r||!r[0])continue;const o=this.parseDate(r[0]);o&&(n++,t.forEach((c,i)=>{const d=this.parseNumber(r[c.oilCol]),u=this.parseNumber(r[c.waterCol]),h=c.gasCol!==null?this.parseNumber(r[c.gasCol]):null;(d!==null||u!==null||h!==null)&&(l[i].wellTests.push({date:o,oil:d,water:u,gas:h}),l[i].production.push({date:new Date(o),oil:d,water:u,gas:h}))}))}return l.forEach(s=>{s.wellTests.sort((r,o)=>new Date(o.date)-new Date(r.date)),s.wellTests=s.wellTests.slice(0,60),s.production.sort((r,o)=>r.date-o.date)}),{wells:l,rowCount:n}},parseRunTicketsSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),a=[];for(let l=3;l<t.length;l++){const n=t[l];!n||!n[1]||a.push({date:this.parseDate(n[0]),ticketNum:String(n[1]||""),tank:this.parseNumber(n[2]),ftTop:this.parseNumber(n[3]),inTop:this.parseNumber(n[4]),ftBttm:this.parseNumber(n[5]),inBttm:this.parseNumber(n[6]),vol:this.parseNumber(n[8])})}return a},parseDate(e){if(!e)return null;if(e instanceof Date)return e.toISOString().split("T")[0];if(typeof e=="number"){const t=XLSX.SSF.parse_date_code(e);if(t)return`${t.y}-${String(t.m).padStart(2,"0")}-${String(t.d).padStart(2,"0")}`}return typeof e=="string"?e.split(" ")[0]:null},parseNumber(e){if(e==null||e==="")return null;const t=parseFloat(e);return isNaN(t)?null:t<0?0:t}},Me={id:"mwwemac",name:"MW-Wemac-Sabrina-Berkley",expectedFileName:"Mw-Wemac-Sabrina-Berkley.xlsx",wells:[{id:"berkley-1",name:"Berkley #1",oilCol:1,waterCol:2,gasCol:3,status:"active"},{id:"berkley-4",name:"Berkley #4",oilCol:7,waterCol:8,gasCol:9,status:"inactive"},{id:"berkley-5",name:"Berkley #5",oilCol:13,waterCol:14,gasCol:15,status:"active"},{id:"berkley-6",name:"Berkley #6",oilCol:19,waterCol:20,gasCol:21,status:"active"},{id:"sabrina-5",name:"Sabrina #5",oilCol:25,waterCol:26,gasCol:27,status:"inactive"},{id:"sabrina-7",name:"Sabrina #7",oilCol:31,waterCol:32,gasCol:33,status:"inactive"},{id:"sabrina-3",name:"Sabrina #3",oilCol:37,waterCol:38,gasCol:39,status:"inactive"},{id:"sabrina-12",name:"Sabrina #12",oilCol:43,waterCol:44,gasCol:45,status:"inactive"}],parse(e){const t={id:this.id,name:this.name,lastUpdated:new Date().toISOString(),wells:[],runTickets:[],rawRowCount:0};if(e.Sheets.Well_Test){const a=this.parseWellTestSheet(e.Sheets.Well_Test);t.wells=a.wells,t.rawRowCount=a.rowCount}return t},parseWellTestSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),a=this.wells.map(n=>({id:n.id,name:n.name,status:n.status||"active",wellTests:[],production:[],chemicalProgram:{continuous:{rate:null,chems:"-",ppm:null},truckTreat:{rate:null,chems:"-",ppm:null}},failureHistory:[],pressureReadings:[],actionItems:[]}));let l=0;for(let n=4;n<t.length;n++){const s=t[n];if(!s||!s[0])continue;const r=this.parseDate(s[0]);r&&(l++,this.wells.forEach((o,c)=>{const i=this.parseNumber(s[o.oilCol]),d=this.parseNumber(s[o.waterCol]),u=this.parseNumber(s[o.gasCol]);(i!==null||d!==null||u!==null)&&(a[c].wellTests.push({date:r,oil:i,water:d,gas:u}),a[c].production.push({date:new Date(r),oil:i,water:d,gas:u}))}))}return a.forEach(n=>{n.wellTests.sort((s,r)=>new Date(r.date)-new Date(s.date)),n.wellTests=n.wellTests.slice(0,60),n.production.sort((s,r)=>s.date-r.date)}),{wells:a,rowCount:l}},parseDate(e){if(!e)return null;if(e instanceof Date)return e.toISOString().split("T")[0];if(typeof e=="number"){const t=XLSX.SSF.parse_date_code(e);if(t)return`${t.y}-${String(t.m).padStart(2,"0")}-${String(t.d).padStart(2,"0")}`}return typeof e=="string"?e.split(" ")[0]:null},parseNumber(e){if(e==null||e==="")return null;const t=parseFloat(e);return isNaN(t)?null:t<0?0:t}},$e={id:"unit130",name:"1-30 Unit 1H",expectedFileName:"1-30 Unit 1H Gauge Sheet.xlsx",wells:[{id:"uls-1-30-1h",name:"ULS 1-30-1H",oilCol:1,waterCol:2,gasCol:3}],parse(e){const t={id:this.id,name:this.name,lastUpdated:new Date().toISOString(),wells:[],runTickets:[],rawRowCount:0};if(e.Sheets["Well Test"]){const a=this.parseWellTestSheet(e.Sheets["Well Test"]);t.wells=a.wells,t.rawRowCount=a.rowCount}return t},parseWellTestSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),a=this.wells.map(n=>({id:n.id,name:n.name,status:"active",wellTests:[],production:[],chemicalProgram:{continuous:{rate:null,chems:"-",ppm:null},truckTreat:{rate:null,chems:"-",ppm:null}},failureHistory:[],pressureReadings:[],actionItems:[]}));let l=0;for(let n=4;n<t.length;n++){const s=t[n];if(!s||!s[0])continue;const r=this.parseDate(s[0]);r&&(l++,this.wells.forEach((o,c)=>{const i=this.parseNumber(s[o.oilCol]),d=this.parseNumber(s[o.waterCol]),u=this.parseNumber(s[o.gasCol]);(i!==null||d!==null||u!==null)&&(a[c].wellTests.push({date:r,oil:i,water:d,gas:u}),a[c].production.push({date:new Date(r),oil:i,water:d,gas:u}))}))}return a.forEach(n=>{n.wellTests.sort((s,r)=>new Date(r.date)-new Date(s.date)),n.wellTests=n.wellTests.slice(0,60),n.production.sort((s,r)=>s.date-r.date)}),{wells:a,rowCount:l}},parseDate(e){if(!e)return null;if(e instanceof Date)return e.toISOString().split("T")[0];if(typeof e=="number"){const t=XLSX.SSF.parse_date_code(e);if(t)return`${t.y}-${String(t.m).padStart(2,"0")}-${String(t.d).padStart(2,"0")}`}return typeof e=="string"?e.split(" ")[0]:null},parseNumber(e){if(e==null||e==="")return null;const t=parseFloat(e);return isNaN(t)?null:t<0?0:t}},Re={id:"uls35h",name:"ULS 3-5H",expectedFileName:"ULS 3-5H Gauge Sheet.xlsx",wells:[{id:"uls-1-3-1h",name:"ULS 1-3-1H",oilCol:1,waterCol:2,gasCol:3},{id:"uls-1-3-3h",name:"ULS 1-3-3H",oilCol:7,waterCol:8,gasCol:9},{id:"uls-1-3-5h",name:"ULS 1-3-5H",oilCol:13,waterCol:14,gasCol:15},{id:"uls-1-3-7h",name:"ULS 1-3-7H",oilCol:19,waterCol:20,gasCol:21}],parse(e){const t={id:this.id,name:this.name,lastUpdated:new Date().toISOString(),wells:[],runTickets:[],rawRowCount:0};if(e.Sheets["Well Test"]){const a=this.parseWellTestSheet(e.Sheets["Well Test"]);t.wells=a.wells,t.rawRowCount=a.rowCount}return e.Sheets["3-5H Run Tickets"]&&(t.runTickets=this.parseRunTicketsSheet(e.Sheets["3-5H Run Tickets"])),t},parseWellTestSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),a=this.wells.map(n=>({id:n.id,name:n.name,status:"active",wellTests:[],production:[],chemicalProgram:{continuous:{rate:null,chems:"-",ppm:null},truckTreat:{rate:null,chems:"-",ppm:null}},failureHistory:[],pressureReadings:[],actionItems:[]}));let l=0;for(let n=4;n<t.length;n++){const s=t[n];if(!s||!s[0])continue;const r=this.parseDate(s[0]);r&&(l++,this.wells.forEach((o,c)=>{const i=this.parseNumber(s[o.oilCol]),d=this.parseNumber(s[o.waterCol]),u=this.parseNumber(s[o.gasCol]);(i!==null||d!==null||u!==null)&&(a[c].wellTests.push({date:r,oil:i,water:d,gas:u}),a[c].production.push({date:new Date(r),oil:i,water:d,gas:u}))}))}return a.forEach(n=>{n.wellTests.sort((s,r)=>new Date(r.date)-new Date(s.date)),n.wellTests=n.wellTests.slice(0,60),n.production.sort((s,r)=>s.date-r.date)}),{wells:a,rowCount:l}},parseRunTicketsSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),a=[];for(let l=3;l<t.length;l++){const n=t[l];!n||!n[1]||a.push({date:this.parseDate(n[0]),ticketNum:String(n[1]||""),tank:this.parseNumber(n[2]),ftTop:this.parseNumber(n[3]),inTop:this.parseNumber(n[4]),ftBttm:this.parseNumber(n[5]),inBttm:this.parseNumber(n[6]),vol:this.parseNumber(n[8])})}return a.sort((l,n)=>(n.date||"").localeCompare(l.date||"")),a.slice(0,100)},parseDate(e){if(!e)return null;if(e instanceof Date)return e.toISOString().split("T")[0];if(typeof e=="number"){const t=XLSX.SSF.parse_date_code(e);if(t)return`${t.y}-${String(t.m).padStart(2,"0")}-${String(t.d).padStart(2,"0")}`}return typeof e=="string"?e.split(" ")[0]:null},parseNumber(e){if(e==null||e==="")return null;const t=parseFloat(e);return isNaN(t)?null:t<0?0:t}},A={CowdenParser:ke,BigMaxParser:De,BigMax1HParser:Ne,SouthAndrewsParser:Ie,PolarisParser:Be,ShusaParser:Le,MWWemacParser:Me,Unit130Parser:$e,ULS35HParser:Re};function He(){const e=document.getElementById("uploadArea"),t=document.getElementById("fileInput"),a=document.getElementById("btnReupload");e.addEventListener("click",l=>{l.target.id!=="btnReupload"&&t.click()}),a.addEventListener("click",l=>{l.stopPropagation(),t.click()}),t.addEventListener("change",l=>{const n=l.target.files[0];n&&V(n),t.value=""}),e.addEventListener("dragover",l=>{l.preventDefault(),e.classList.add("drag-over")}),e.addEventListener("dragleave",()=>{e.classList.remove("drag-over")}),e.addEventListener("drop",l=>{l.preventDefault(),e.classList.remove("drag-over");const n=l.dataTransfer.files[0];n&&V(n)})}async function V(e){if(!m.currentSheet){alert("Please select a gauge sheet first");return}const t=y.find(r=>r.id===m.currentSheet);if(!t)return;const a=A[t.parser];if(!a){alert(`Parser not yet implemented for ${t.name}. Coming soon!`);return}const l=document.getElementById("uploadProgress"),n=document.getElementById("progressFill"),s=document.getElementById("progressText");l.style.display="block",n.style.width="10%",s.textContent="Reading file...";try{const r=await e.arrayBuffer();n.style.width="30%",s.textContent="Parsing Excel...";const o=XLSX.read(r,{type:"array",cellDates:!0});n.style.width="60%",s.textContent="Extracting data...";const c=a.parse(o);n.style.width="90%",s.textContent="Saving...",m.appData[m.currentSheet]=c,N(),n.style.width="100%",s.textContent="Complete!",setTimeout(()=>{l.style.display="none",n.style.width="0%",B(),J(m.currentSheet)},500)}catch(r){console.error("Error processing file:",r),alert("Error processing file: "+r.message),l.style.display="none"}}function Pe(){const e=document.getElementById("bulkUploadArea"),t=document.getElementById("bulkFileInput");!e||!t||(e.addEventListener("click",()=>{t.click()}),t.addEventListener("change",a=>{const l=Array.from(a.target.files);l.length>0&&z(l),t.value=""}),e.addEventListener("dragover",a=>{a.preventDefault(),e.classList.add("drag-over")}),e.addEventListener("dragleave",()=>{e.classList.remove("drag-over")}),e.addEventListener("drop",a=>{a.preventDefault(),e.classList.remove("drag-over");const l=Array.from(a.dataTransfer.files);l.length>0&&z(l)}))}async function z(e){const t=document.getElementById("bulkUploadProgress"),a=document.getElementById("bulkProgressFill"),l=document.getElementById("bulkProgressText"),n=document.getElementById("bulkUploadResults");t.style.display="block",n.style.display="none",n.innerHTML="";const s=[];let r=0;for(const o of e){a.style.width=`${r/e.length*100}%`,l.textContent=`Processing ${o.name}...`;const c=y.find(d=>o.name.toLowerCase().includes(d.fileName.toLowerCase().replace(".xlsx","").replace(".xlsm",""))||d.fileName.toLowerCase()===o.name.toLowerCase());if(!c){s.push({name:o.name,status:"skipped",detail:"Unknown file"}),r++;continue}const i=A[c.parser];if(!i){s.push({name:o.name,status:"skipped",detail:"No parser available"}),r++;continue}try{const d=await o.arrayBuffer(),u=XLSX.read(d,{type:"array",cellDates:!0}),h=i.parse(u);m.appData[c.id]=h,s.push({name:c.name,status:"success",detail:`${h.wells.length} wells loaded`})}catch(d){console.error(`Error processing ${o.name}:`,d),s.push({name:o.name,status:"error",detail:d.message})}r++}N(),a.style.width="100%",l.textContent="Complete!",setTimeout(()=>{t.style.display="none",n.style.display="block",n.innerHTML=s.map(o=>`
            <div class="bulk-result-item ${o.status}">
                <span class="result-icon">${o.status==="success"?"OK":o.status==="error"?"X":"?"}</span>
                <span class="result-name">${o.name}</span>
                <span class="result-detail">${o.detail}</span>
            </div>
        `).join(""),B()},500)}async function We(e){const t=document.getElementById("dashboardLoadingOverlay"),a=document.getElementById("dashboardLoadingText"),l=document.getElementById("dashboardLoadingSubtext");t.classList.add("visible"),a.textContent="Processing sheets...",l.textContent=`0 of ${e.length} files`;let n=0,s=0;await new Promise(r=>setTimeout(r,50));for(const r of e){l.textContent=`${n+1} of ${e.length}: ${r.name}`;const o=y.find(i=>r.name.toLowerCase().includes(i.fileName.toLowerCase().replace(".xlsx","").replace(".xlsm",""))||i.fileName.toLowerCase()===r.name.toLowerCase());if(!o){n++;continue}const c=A[o.parser];if(!c){n++;continue}try{const i=await r.arrayBuffer(),d=XLSX.read(i,{type:"array",cellDates:!0}),u=c.parse(d);m.appData[o.id]=u,s++}catch(i){console.error(`Error processing ${r.name}:`,i)}n++,await new Promise(i=>setTimeout(i,10))}a.textContent="Complete!",l.textContent=`${s} of ${e.length} sheets updated`,s>0&&(N(),B()),setTimeout(()=>{t.classList.remove("visible")},600)}let R=null;function Ae(e){R=e}function Fe(){Oe(),Ue(),Xe(),_e()}function Oe(){const e=Se();document.getElementById("statDailyOil").textContent=e.totalOil.toLocaleString(),document.getElementById("statDailyWater").textContent=e.totalWater.toLocaleString(),document.getElementById("statDailyGas").textContent=e.totalGas.toLocaleString()}function Ue(){const e=document.getElementById("topProducersBody"),t=Te(10);if(t.length===0){e.innerHTML='<tr><td colspan="5" class="dashboard-empty">No production data available</td></tr>';return}e.innerHTML=t.map((a,l)=>`
        <tr data-well-id="${a.wellId}" data-sheet-id="${a.sheetId}">
            <td>${l+1}</td>
            <td class="well-name-cell">${a.wellName}</td>
            <td class="battery-name-cell">${a.batteryName}</td>
            <td>${a.oil>0?a.oil:"-"}</td>
            <td>${a.water>0?a.water:"-"}</td>
        </tr>
    `).join(""),e.querySelectorAll("tr[data-well-id]").forEach(a=>{a.addEventListener("click",()=>{const l=a.dataset.wellId,n=a.dataset.sheetId;T(n,l)})})}function Xe(){const e=document.getElementById("recentTestsBody"),t=Ee(10);if(t.length===0){e.innerHTML='<tr><td colspan="6" class="dashboard-empty">No test data available</td></tr>';return}e.innerHTML=t.map(a=>`
        <tr data-well-id="${a.wellId}" data-sheet-id="${a.sheetId}">
            <td>${v(a.date)}</td>
            <td class="well-name-cell">${a.wellName}</td>
            <td class="battery-name-cell">${a.batteryName}</td>
            <td>${a.oil!==null?a.oil:"-"}</td>
            <td>${a.water!==null?a.water:"-"}</td>
            <td>${a.gas!==null?a.gas:"-"}</td>
        </tr>
    `).join(""),e.querySelectorAll("tr[data-well-id]").forEach(a=>{a.addEventListener("click",()=>{const l=a.dataset.wellId,n=a.dataset.sheetId;T(n,l)})})}function _e(){const e=document.getElementById("dashboardActionList"),t=xe(15);if(t.length===0){e.innerHTML='<li class="dashboard-empty" style="border-left-color: #6b7280; opacity: 0.7;">No action items</li>';return}e.innerHTML=t.map(a=>`
        <li data-well-id="${a.wellId}" data-sheet-id="${a.sheetId}">
            <div class="action-item-content">${a.content}</div>
            <div class="action-item-source">
                <span class="source-well">${a.wellName}</span> - ${a.batteryName}
            </div>
        </li>
    `).join(""),e.querySelectorAll("li[data-well-id]").forEach(a=>{a.style.cursor="pointer",a.addEventListener("click",()=>{const l=a.dataset.wellId,n=a.dataset.sheetId;T(n,l)})})}function qe(){const e=document.getElementById("btnReuploadAll"),t=document.getElementById("bulkFileInputDashboard"),a=document.getElementById("btnClearCache");e&&t&&(e.addEventListener("click",()=>{t.click()}),t.addEventListener("change",l=>{const n=Array.from(l.target.files);n.length>0&&We(n),t.value=""})),a&&a.addEventListener("click",()=>{confirm("Clear all cached data? You will need to re-upload your gauge sheets.")&&Ge()})}function Ge(){localStorage.removeItem(H),m.appData={},R&&R()}function S(e){document.querySelectorAll(".view").forEach(l=>l.classList.remove("active"));const a={welcome:"welcomeView",gaugeSheet:"gaugeSheetView",well:"wellView",battery:"batteryView",oilChart:"oilChartView",waterChart:"waterChartView",gasChart:"gasChartView"}[e];a&&document.getElementById(a).classList.add("active")}function E(){const e=document.getElementById("welcomeUploadPrompt"),t=document.getElementById("operationsDashboard");Y()?(e.style.display="none",t.style.display="block",Fe()):(e.style.display="block",t.style.display="none")}function J(e){const t=y.find(s=>s.id===e);if(!t)return;m.currentSheet=e,S("gaugeSheet"),document.getElementById("sheetName").textContent=t.name,document.getElementById("sheetBreadcrumb").textContent=`Gauge Sheet: ${t.fileName}`,document.getElementById("expectedFileName").textContent=t.fileName;const a=m.appData[e],l=document.getElementById("uploadPrompt"),n=document.getElementById("uploadStatus");a&&a.wells?(l.style.display="none",n.style.display="flex",document.getElementById("lastUploadDate").textContent=v(a.lastUpdated),document.getElementById("rowCount").textContent=a.rawRowCount||"-"):(l.style.display="block",n.style.display="none"),je(e)}function T(e,t){const a=m.appData[e];if(!a||!a.wells)return;const l=a.wells.find(s=>s.id===t);if(!l)return;m.currentSheet=e,m.currentWell=t,S("well");const n=y.find(s=>s.id===e);document.getElementById("wellName").textContent=l.name,document.getElementById("wellBreadcrumb").textContent=`${n.name} > ${l.name}`,W(l),Ve(l.wellTests||[]),ze(l.chemicalProgram||{}),Ke(l.failureHistory||[]),Ye("wellActionList",l.actionItems||[]),Je(l.pressureReadings||[]),oe()}function je(e){const t=document.getElementById("wellsGrid"),a=m.appData[e];if(!a||!a.wells||a.wells.length===0){t.innerHTML='<p class="empty-message">Upload gauge sheet to see wells</p>';return}const l=a.wells.filter(n=>n.status!=="inactive");if(l.length===0){t.innerHTML='<p class="empty-message">No active wells</p>';return}t.innerHTML=l.map(n=>{const s=n.wellTests&&n.wellTests[0],r=s?Math.round(s.oil*100)/100:null,o=s&&s.gas!==null?Math.round(Math.max(0,s.gas)*100)/100:null;return`
            <div class="well-card" data-well-id="${n.id}" data-sheet-id="${e}">
                <h4>${n.name}</h4>
                <div class="well-stats">
                    <div class="well-stat">
                        <span class="well-stat-label">Latest Oil</span>
                        <span class="well-stat-value">${r!==null?r+" bbl":"-"}</span>
                    </div>
                    <div class="well-stat">
                        <span class="well-stat-label">Latest Gas</span>
                        <span class="well-stat-value">${o!==null?o+" mcf":"-"}</span>
                    </div>
                </div>
            </div>
        `}).join(""),t.querySelectorAll(".well-card").forEach(n=>{n.addEventListener("click",()=>{const s=n.dataset.wellId,r=n.dataset.sheetId;T(r,s)})})}function Ve(e){const t=document.querySelector("#wellTestTable tbody"),a=new Date;if(a.setHours(23,59,59,999),!e||e.length===0){t.innerHTML='<tr><td colspan="4" style="text-align: center; color: #6b7280;">No test data</td></tr>';return}const l=e.filter(n=>new Date(n.date)<=a);if(l.length===0){t.innerHTML='<tr><td colspan="4" style="text-align: center; color: #6b7280;">No test data</td></tr>';return}t.innerHTML=l.map(n=>{const s=n.gas!==null?Math.round(Math.max(0,n.gas)*100)/100:null;return`
            <tr>
                <td>${v(n.date)}</td>
                <td>${n.oil!==null?Math.round(n.oil*100)/100:"-"}</td>
                <td>${n.water!==null?Math.round(n.water*100)/100:"-"}</td>
                <td>${s!==null?s:"-"}</td>
            </tr>
        `}).join("")}function ze(e){const t=e.continuous||{},a=e.truckTreat||{};document.getElementById("chemContRate").textContent=t.rate||"-",document.getElementById("chemContChems").textContent=t.chems||"-",document.getElementById("chemContPPM").textContent=t.ppm||"-",document.getElementById("chemTruckRate").textContent=a.rate||"-",document.getElementById("chemTruckChems").textContent=a.chems||"-",document.getElementById("chemTruckPPM").textContent=a.ppm||"-"}function Ke(e){const t=document.querySelector("#failureTable tbody");if(!e||e.length===0){t.innerHTML='<tr><td colspan="6" style="text-align: center; color: #6b7280;">No failure history</td></tr>';return}t.innerHTML=e.map(a=>`
        <tr>
            <td>${v(a.dateDown)}</td>
            <td>${v(a.dateUp)}</td>
            <td>${a.downtime||"-"}</td>
            <td>${a.oil||"-"}</td>
            <td>${a.reason||"-"}</td>
            <td>${a.comments||"-"}</td>
        </tr>
    `).join("")}function Ye(e,t){const a=document.getElementById(e);if(!t||t.length===0){a.innerHTML='<li style="border-left-color: #6b7280; opacity: 0.7;">No action items</li>';return}a.innerHTML=t.map(l=>`<li>${l}</li>`).join("")}function Je(e){const t=document.querySelector("#pressureTable tbody");if(!e||e.length===0){t.innerHTML='<tr><td colspan="4" style="text-align: center; color: #6b7280;">No pressure data</td></tr>';return}t.innerHTML=e.map(a=>`
        <tr>
            <td>${v(a.date)}</td>
            <td>${a.casingPsi||"-"}</td>
            <td>${a.tubingPsi||"-"}</td>
            <td>${a.flowlinePsi||"-"}</td>
        </tr>
    `).join("")}function F(e=null,t=null){S("oilChart"),X("oil",e,t)}function O(e=null,t=null){S("waterChart"),X("water",e,t)}function U(e=null,t=null){S("gasChart"),X("gas",e,t)}function X(e,t=null,a=null){var p;const n={oil:{canvasId:"aggregateOilChart",label:"Oil Production (BBL)",unit:"BBL",color:"#78716c",dateRangeVar:"oilChartDateRange",startDateId:"oilChartStartDate",endDateId:"oilChartEndDate",resetBtnId:"btnResetOilDates",showFn:F},water:{canvasId:"aggregateWaterChart",label:"Water Consumption (BBL)",unit:"BBL",color:"#3b82f6",dateRangeVar:"waterChartDateRange",startDateId:"waterChartStartDate",endDateId:"waterChartEndDate",resetBtnId:"btnResetWaterDates",showFn:O},gas:{canvasId:"aggregateGasChart",label:"Gas Production (MCF)",unit:"MCF",color:"#22c55e",dateRangeVar:"gasChartDateRange",startDateId:"gasChartStartDate",endDateId:"gasChartEndDate",resetBtnId:"btnResetGasDates",showFn:U}}[e];if(!n)return;e==="oil"&&m.aggregateOilChart?(m.aggregateOilChart.destroy(),m.aggregateOilChart=null):e==="water"&&m.aggregateWaterChart?(m.aggregateWaterChart.destroy(),m.aggregateWaterChart=null):e==="gas"&&m.aggregateGasChart&&(m.aggregateGasChart.destroy(),m.aggregateGasChart=null);const s=Qe(e),r=((p=m.chartState[e])==null?void 0:p.aggregation)||"month";m.chartState[e].selectedWells=s;const{data:o,dateRange:c}=ve(e,t,a,r,s);e==="oil"?m.oilChartDateRange=c:e==="water"?m.waterChartDateRange=c:e==="gas"&&(m.gasChartDateRange=c),Ze(e,n,t,a,c);const i={oil:"oilChartBatteries",water:"waterChartBatteries",gas:"gasChartBatteries"},d=document.getElementById(i[e]);d&&!d.querySelector(".explorer-battery")&&tt(e),et(e);const u=document.getElementById(n.canvasId);if(!u)return;if(o.length===0){const g=u.getContext("2d");g.clearRect(0,0,u.width,u.height),g.font="14px Archivo, sans-serif",g.fillStyle="#6b7280",g.textAlign="center",g.fillText("No production data available",u.width/2,u.height/2);return}const h=u.getContext("2d"),f=new Chart(h,{type:"line",data:{datasets:[{label:n.label,data:o,backgroundColor:n.color+"33",borderColor:n.color,borderWidth:2,fill:!0,tension:.1,pointRadius:2,pointHoverRadius:5}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:"#282c33",titleColor:"#e8e9eb",bodyColor:"#e8e9eb",callbacks:{title:g=>new Date(g[0].parsed.x).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),label:g=>`${n.label}: ${g.parsed.y.toLocaleString()}`}}},scales:{x:{type:"time",time:{displayFormats:{day:"MMM-yy",week:"MMM-yy",month:"MMM-yy",quarter:"MMM-yy",year:"yyyy"}},grid:{color:"#3a3f47"},ticks:{color:"#9ea3ab",maxTicksLimit:12}},y:{beginAtZero:!0,title:{display:!0,text:n.unit,color:"#9ea3ab"},grid:{color:"#3a3f47"},ticks:{color:"#9ea3ab"}}}}});e==="oil"?m.aggregateOilChart=f:e==="water"?m.aggregateWaterChart=f:e==="gas"&&(m.aggregateGasChart=f)}function Ze(e,t,a,l,n){const s=document.getElementById(t.startDateId),r=document.getElementById(t.endDateId),o=document.getElementById(t.resetBtnId);if(!s||!r||!n.min||!n.max)return;const c=g=>g?new Date(g).toISOString().split("T")[0]:"",i=c(n.min),d=c(n.max);s.min=i,s.max=d,r.min=i,r.max=d,s.value=a?c(a):i,r.value=l?c(l):d;const u=s.cloneNode(!0),h=r.cloneNode(!0),f=o.cloneNode(!0);s.parentNode.replaceChild(u,s),r.parentNode.replaceChild(h,r),o.parentNode.replaceChild(f,o);const p=()=>{const g=u.value?new Date(u.value):null,w=h.value?new Date(h.value+"T23:59:59"):null;t.showFn(g,w)};u.addEventListener("change",p),h.addEventListener("change",p),f.addEventListener("click",()=>t.showFn(null,null))}function Qe(e){const t={oil:"oilChartBatteries",water:"waterChartBatteries",gas:"gasChartBatteries"},a=document.getElementById(t[e]);if(!a)return null;const l=new Set;return a.querySelectorAll(".well-checkbox:checked").forEach(n=>{n.dataset.well&&l.add(n.dataset.well)}),l.size>0?l:null}function k(e){const a={oil:{startDateId:"oilChartStartDate",endDateId:"oilChartEndDate",showFn:F},water:{startDateId:"waterChartStartDate",endDateId:"waterChartEndDate",showFn:O},gas:{startDateId:"gasChartStartDate",endDateId:"gasChartEndDate",showFn:U}}[e];if(!a)return;const l=document.getElementById(a.startDateId),n=document.getElementById(a.endDateId),s=l&&l.value?new Date(l.value):null,r=n&&n.value?new Date(n.value+"T23:59:59"):null;a.showFn(s,r)}function et(e){var l;const t=document.querySelectorAll(`input[name="${e}Aggregation"]`);if(!t.length)return;t.forEach(n=>{const s=n.cloneNode(!0);n.parentNode.replaceChild(s,n)});const a=((l=m.chartState[e])==null?void 0:l.aggregation)||"month";document.querySelectorAll(`input[name="${e}Aggregation"]`).forEach(n=>{n.checked=n.value===a,n.addEventListener("change",s=>{m.chartState[e].aggregation=s.target.value,k(e)})})}function tt(e){var c;const t={oil:"oilChartBatteries",water:"waterChartBatteries",gas:"gasChartBatteries"},a=document.getElementById(t[e]);if(!a)return;if(a.innerHTML="",!Y()){a.innerHTML='<div class="explorer-empty">No data uploaded</div>';return}const l=()=>{const i={oil:"btnToggleAllOil",water:"btnToggleAllWater",gas:"btnToggleAllGas"},d=document.getElementById(i[e]);if(!d)return;const u=a.querySelectorAll(".well-checkbox");if(!u.length)return;const h=Array.from(u).every(f=>f.checked);d.textContent=h?"Deselect All":"Select All"},n=i=>{const d=i.querySelector(".battery-checkbox"),u=i.querySelectorAll(".well-checkbox"),h=i.querySelectorAll(".well-checkbox:checked").length;!d||!u.length||(d.checked=h===u.length,d.indeterminate=h>0&&h<u.length)},s=((c=m.chartState[e])==null?void 0:c.selectedWells)||null;y.forEach(i=>{const d=m.appData[i.id];if(!d||!d.wells||d.wells.length===0)return;const u=d.wells.filter(w=>w.status!=="inactive");if(u.length===0)return;const h=document.createElement("div");h.className="explorer-battery";const f=document.createElement("div");f.className="explorer-battery-header",f.innerHTML=`
            <label class="explorer-checkbox">
                <input type="checkbox" class="battery-checkbox" data-battery="${i.id}">
                <span class="checkmark"></span>
            </label>
            <span class="battery-name">${i.name}</span>
            <span class="battery-count">${u.length}</span>
        `;const p=document.createElement("div");p.className="explorer-wells",p.id=`wells-${e}-${i.id}`,u.forEach(w=>{const C=!s||s.has(w.id),b=document.createElement("label");b.className="explorer-well explorer-checkbox",b.innerHTML=`
                <input type="checkbox" class="well-checkbox" data-battery="${i.id}" data-well="${w.id}" ${C?"checked":""}>
                <span class="checkmark"></span>
                <span class="well-name">${w.name}</span>
            `,p.appendChild(b)}),h.appendChild(f),h.appendChild(p),a.appendChild(h),f.addEventListener("click",w=>{w.target.closest('input[type="checkbox"]')||w.target.closest(".explorer-checkbox")||p.classList.toggle("expanded")});const g=f.querySelector(".battery-checkbox");n(h),g.addEventListener("change",()=>{const w=g.checked;p.querySelectorAll(".well-checkbox").forEach(C=>{C.checked=w}),g.indeterminate=!1,k(e),l()}),p.querySelectorAll(".well-checkbox").forEach(w=>{w.addEventListener("change",()=>{n(h),k(e),l()})})});const r={oil:"btnToggleAllOil",water:"btnToggleAllWater",gas:"btnToggleAllGas"},o=document.getElementById(r[e]);if(o){const i=o.cloneNode(!0);o.parentNode.replaceChild(i,o),i.addEventListener("click",()=>{const d=a.querySelectorAll(".well-checkbox"),u=Array.from(d).every(h=>h.checked);d.forEach(h=>{h.checked=!u}),a.querySelectorAll(".explorer-battery").forEach(h=>{n(h)}),i.textContent=u?"Select All":"Deselect All",k(e)}),l()}}function at(){const e=document.getElementById("logoLink");e&&e.addEventListener("click",t=>{t.preventDefault(),document.querySelectorAll(".nav-item").forEach(l=>l.classList.remove("active")),m.currentSheet=null,m.currentWell=null,S("welcome"),E();const a=document.getElementById("nav-dashboard");a&&I(a)})}function nt(){const e=document.getElementById("hamburgerBtn"),t=document.getElementById("sidebar");e&&t&&(e.addEventListener("click",()=>{t.classList.toggle("collapsed");const l=t.classList.contains("collapsed");localStorage.setItem("sidebarCollapsed",l?"true":"false")}),localStorage.getItem("sidebarCollapsed")==="true"&&t.classList.add("collapsed"))}function Z(){const e=document.getElementById("navTree");e.innerHTML="";const t=lt("Home","home-section",[{id:"nav-dashboard",label:"Operations Dashboard",icon:"dashboard",action:()=>{S("welcome"),E()}},{id:"nav-oil-chart",label:"Oil Production",icon:"oil",action:()=>F()},{id:"nav-water-chart",label:"Water Consumption",icon:"water",action:()=>O()},{id:"nav-gas-chart",label:"Gas Production",icon:"gas",action:()=>U()}]);e.appendChild(t);const a=rt();e.appendChild(a)}function lt(e,t,a){const l=document.createElement("div");l.className="nav-section",l.id=t;const n=document.createElement("div");n.className="nav-section-header expanded",n.innerHTML=`
        <span class="nav-section-title">${e}</span>
        <span class="nav-section-chevron">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
        </span>
    `;const s=document.createElement("div");return s.className="nav-section-children visible",a.forEach(r=>{const o=st(r);s.appendChild(o)}),n.addEventListener("click",()=>{n.classList.toggle("expanded"),s.classList.toggle("visible")}),l.appendChild(n),l.appendChild(s),l}function st(e){const t=document.createElement("div");t.className="nav-section-item";const a={dashboard:`<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="7" height="7"></rect>
            <rect x="14" y="3" width="7" height="7"></rect>
            <rect x="14" y="14" width="7" height="7"></rect>
            <rect x="3" y="14" width="7" height="7"></rect>
           </svg>`,oil:`<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#78716c" stroke-width="2">
            <path d="M12 2C12 2 4 10 4 15a8 8 0 0 0 16 0c0-5-8-13-8-13z"></path>
           </svg>`,water:`<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#3b82f6" stroke-width="2">
            <path d="M12 2C12 2 4 10 4 15a8 8 0 0 0 16 0c0-5-8-13-8-13z"></path>
           </svg>`,gas:`<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#22c55e" stroke-width="2">
            <path d="M12 2v6m0 4v10M5 12h14M8 6h8M6 18h12"></path>
           </svg>`,chart:`<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
           </svg>`},l=a[e.icon]||a.chart;t.innerHTML=`
        <div class="nav-item" id="${e.id}" data-tooltip="${e.label}">
            <span class="nav-item-icon">${l}</span>
            <span class="nav-item-label">${e.label}</span>
        </div>
    `;const n=t.querySelector(".nav-item");return n.addEventListener("click",s=>{s.stopPropagation(),I(n),e.action()}),t}function rt(){const e=document.createElement("div");e.className="nav-section",e.id="wells-section";const t=document.createElement("div");t.className="nav-section-header expanded",t.innerHTML=`
        <span class="nav-section-title">Wells</span>
        <span class="nav-section-chevron">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
        </span>
    `;const a=document.createElement("div");return a.className="nav-section-children visible",y.forEach(l=>{const n=ot(l);a.appendChild(n)}),t.addEventListener("click",()=>{t.classList.toggle("expanded"),a.classList.toggle("visible")}),e.appendChild(t),e.appendChild(a),e}function ot(e){const t=document.createElement("div");t.className="nav-gauge-sheet";const a=m.appData[e.id]&&m.appData[e.id].wells,l=a?m.appData[e.id].wells.filter(o=>o.status!=="inactive"):[],n=l.length;t.innerHTML=`
        <div class="nav-item" data-sheet-id="${e.id}">
            <span class="icon">&#9632;</span>
            <span class="nav-battery-name">${e.name}</span>
            <span class="upload-indicator ${a?"uploaded":"not-uploaded"}">
                ${a?n+" wells":"No data"}
            </span>
        </div>
        <div class="nav-children" id="sheet-children-${e.id}"></div>
    `;const s=t.querySelector(".nav-item"),r=t.querySelector(".nav-children");return s.addEventListener("click",o=>{o.stopPropagation(),I(s),J(e.id),a&&l.length>0&&(s.classList.toggle("expanded"),r.classList.toggle("visible"))}),a&&l.forEach(o=>{const c=it(o,e);r.appendChild(c)}),t}function it(e,t){const a=document.createElement("div");a.className="nav-well",a.innerHTML=`
        <div class="nav-item" data-well-id="${e.id}" data-sheet-id="${t.id}">
            <span class="status-dot active"></span>
            <span class="nav-well-name">${e.name}</span>
        </div>
    `;const l=a.querySelector(".nav-item");return l.addEventListener("click",n=>{n.stopPropagation(),I(l),T(t.id,e.id)}),a}function I(e){document.querySelectorAll(".nav-item").forEach(t=>t.classList.remove("active")),e.classList.add("active")}function B(){Z(),E()}document.addEventListener("DOMContentLoaded",()=>{ee(),ne(),Z(),He(),Pe(),qe(),at(),nt(),te(),E(),S("welcome")});re((e,t)=>{T(e,t)});Ae(()=>{B(),E()});
