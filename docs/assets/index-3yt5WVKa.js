(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const r of l.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();const S=[{id:"cowden",name:"Cowden",fileName:"Cowden Gauge Sheet1.xlsx",parser:"CowdenParser"},{id:"bigmax",name:"Big Max",fileName:"Big Max Gauge Sheet.xlsx",parser:"BigMaxParser"},{id:"bigmax1h",name:"Big Max 1H",fileName:"Big Max 1H Gauge Sheet.xlsx",parser:"BigMax1HParser"},{id:"southandrews",name:"South Andrews",fileName:"South Andrews Gauge Sheet.xlsm",parser:"SouthAndrewsParser"},{id:"polaris",name:"Polaris",fileName:"Polaris Gauge Sheet.xlsx",parser:"PolarisParser"},{id:"shusa",name:"Shusa",fileName:"Shusa Gauge Sheet.xlsx",parser:"ShusaParser"},{id:"mwwemac",name:"MW-Wemac-Sabrina-Berkley",fileName:"Mw-Wemac-Sabrina-Berkley.xlsx",parser:"MWWemacParser"},{id:"unit130",name:"1-30 Unit 1H",fileName:"1-30 Unit 1H Gauge Sheet.xlsx",parser:"Unit130Parser"},{id:"uls35h",name:"ULS 3-5H",fileName:"ULS 3-5H Gauge Sheet.xlsx",parser:"ULS35HParser"}],$="oilWellData",P="oilWellTheme",h={appData:{},currentSheet:null,currentWell:null,wellProductionCharts:{},batteryProductionChart:null,currentWellData:null,productionDateRange:{min:null,max:null},chartState:{oil:{aggregation:"month",selectedWells:null},water:{aggregation:"month",selectedWells:null},gas:{aggregation:"month",selectedWells:null}},aggregateOilChart:null,aggregateWaterChart:null,aggregateGasChart:null,oilChartDateRange:{min:null,max:null},waterChartDateRange:{min:null,max:null},gasChartDateRange:{min:null,max:null},currentEditSection:null};function ee(){const e=localStorage.getItem(P);e?document.documentElement.setAttribute("data-theme",e):q(),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{localStorage.getItem(P)||q()}),W()}function q(){const e=window.matchMedia("(prefers-color-scheme: dark)").matches;document.documentElement.setAttribute("data-theme",e?"dark":"light"),W()}function te(){const e=document.getElementById("themeToggle");e&&e.addEventListener("click",ne)}function ne(){const t=(document.documentElement.getAttribute("data-theme")||"dark")==="dark"?"light":"dark";document.documentElement.setAttribute("data-theme",t),localStorage.setItem(P,t),W()}function W(){const e=document.querySelector(".theme-toggle-label");if(e){const t=document.documentElement.getAttribute("data-theme")||"dark";e.textContent=t==="dark"?"Light Mode":"Dark Mode"}}function ae(){try{const e=localStorage.getItem($);e&&(h.appData=JSON.parse(e),Object.values(h.appData).forEach(t=>{t.wells&&t.wells.forEach(n=>{n.production&&(n.production=n.production.map(s=>({...s,date:new Date(s.date)}))),n.wellTests&&(n.wellTests=n.wellTests.map(s=>({...s,date:new Date(s.date)})))})}))}catch(e){console.error("Error loading from storage:",e),h.appData={}}}function I(){try{localStorage.setItem($,JSON.stringify(h.appData))}catch(e){console.error("Error saving to storage:",e),alert("Error saving data. Storage may be full.")}}function T(e){if(!e)return"-";try{const t=new Date(e);return isNaN(t.getTime())?e:t.toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit"})}catch{return e}}function M(e){if(!e)return"";try{const t=new Date(e);return isNaN(t.getTime())?"":t.toISOString().split("T")[0]}catch{return""}}function K(e){if(!e)return"";const t=document.createElement("div");return t.textContent=e,t.innerHTML}function A(e,t=null,n=null){const s=document.getElementById("productionChartsWrapper");h.currentWellData=e,Object.values(h.wellProductionCharts).forEach(c=>{c&&c.destroy()}),h.wellProductionCharts={},s.innerHTML="";const a=e.production||[],l=e.wellTests||[],r=a.filter(c=>c.date).map(c=>new Date(c.date)).filter(c=>!isNaN(c.getTime()));r.length>0&&(h.productionDateRange.min=new Date(Math.min(...r)),h.productionDateRange.max=new Date(Math.max(...r)),se(t,n));const i=[{key:"oil",label:"Oil (BBL)",unit:"BBL",color:"#78716c",dataKey:"oil",source:"production"},{key:"water",label:"Water (BBL)",unit:"BBL",color:"#3b82f6",dataKey:"water",source:"production"},{key:"gas",label:"Gas (MCF)",unit:"MCF",color:"#22c55e",dataKey:"gas",source:"production"}].filter(c=>(c.source==="production"?a:l).some(u=>u[c.dataKey]!==null&&u[c.dataKey]!==void 0&&!isNaN(u[c.dataKey])));if(i.length===0){s.innerHTML='<div class="chart-placeholder">No production data available</div>';return}i.forEach(c=>{const d=document.createElement("div");d.className="chart-section",d.innerHTML=`
            <div class="chart-label">${c.label}</div>
            <div class="canvas-wrapper">
                <canvas id="chart-${c.key}"></canvas>
            </div>
        `,s.appendChild(d);let m=(c.source==="production"?a:l).filter(p=>p.date&&p[c.dataKey]!==null&&p[c.dataKey]!==void 0).map(p=>({x:new Date(p.date),y:Number(p[c.dataKey])})).filter(p=>!isNaN(p.y)).sort((p,f)=>p.x-f.x);(t||n)&&(m=m.filter(p=>{const f=p.x.getTime();return!(t&&f<t.getTime()||n&&f>n.getTime())}));const g=document.getElementById(`chart-${c.key}`).getContext("2d");h.wellProductionCharts[c.key]=new Chart(g,{type:"scatter",data:{datasets:[{label:c.label,data:m,backgroundColor:c.color,borderColor:c.color,pointRadius:3,pointHoverRadius:5}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:"#282c33",titleColor:"#e8e9eb",bodyColor:"#e8e9eb",callbacks:{title:p=>new Date(p[0].parsed.x).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),label:p=>`${c.label}: ${p.parsed.y}`}}},scales:{x:{type:"time",time:{displayFormats:{day:"MMM-yy",week:"MMM-yy",month:"MMM-yy",quarter:"MMM-yy",year:"yyyy"}},grid:{color:"#3a3f47"},ticks:{color:"#9ea3ab",maxTicksLimit:8}},y:{beginAtZero:!0,title:{display:!0,text:c.unit,color:"#9ea3ab"},grid:{color:"#3a3f47"},ticks:{color:"#9ea3ab"}}}}})})}function se(e=null,t=null){const n=document.getElementById("productionStartDate"),s=document.getElementById("productionEndDate"),a=document.getElementById("btnResetDates");if(!n||!s||!h.productionDateRange.min||!h.productionDateRange.max)return;const l=u=>u?new Date(u).toISOString().split("T")[0]:"",r=l(h.productionDateRange.min),o=l(h.productionDateRange.max);n.min=r,n.max=o,s.min=r,s.max=o,n.value=e?l(e):r,s.value=t?l(t):o;const i=n.cloneNode(!0),c=s.cloneNode(!0),d=a.cloneNode(!0);n.parentNode.replaceChild(i,n),s.parentNode.replaceChild(c,s),a.parentNode.replaceChild(d,a),i.addEventListener("change",j),c.addEventListener("change",j),d.addEventListener("click",le)}function j(){if(!h.currentWellData)return;const e=document.getElementById("productionStartDate"),t=document.getElementById("productionEndDate"),n=e.value?new Date(e.value):null,s=t.value?new Date(t.value+"T23:59:59"):null;A(h.currentWellData,n,s)}function le(){h.currentWellData&&A(h.currentWellData,null,null)}let H=null;function re(e){H=e}function oe(){document.querySelectorAll(".btn-edit[data-edit]").forEach(l=>{const r=l.cloneNode(!0);l.parentNode.replaceChild(r,l),r.addEventListener("click",o=>{o.stopPropagation();const i=r.dataset.edit;ie(i)})});const t=document.getElementById("btnCloseModal"),n=document.getElementById("btnCancelEdit"),s=document.getElementById("editModalOverlay"),a=document.getElementById("btnSaveEdit");if(t){const l=t.cloneNode(!0);t.parentNode.replaceChild(l,t),l.addEventListener("click",D)}if(n){const l=n.cloneNode(!0);n.parentNode.replaceChild(l,n),l.addEventListener("click",D)}if(s){const l=s.cloneNode(!0);s.parentNode.replaceChild(l,s),l.addEventListener("click",D)}if(a){const l=a.cloneNode(!0);a.parentNode.replaceChild(l,a),l.addEventListener("click",fe)}}function ie(e){if(!h.currentSheet||!h.currentWell)return;const t=h.appData[h.currentSheet];if(!t||!t.wells)return;const n=t.wells.find(o=>o.id===h.currentWell);if(!n)return;h.currentEditSection=e;const s=document.getElementById("editModal"),a=document.getElementById("editModalTitle"),l=document.getElementById("editModalBody"),r={chemicalProgram:"Edit Chemical Program",failureHistory:"Edit Failure History",actionItems:"Edit Action Items",pressureReadings:"Edit Pressure Readings"};switch(a.textContent=r[e]||"Edit",e){case"chemicalProgram":l.innerHTML=ce(n.chemicalProgram||{});break;case"failureHistory":l.innerHTML=de(n.failureHistory||[]),ue();break;case"actionItems":l.innerHTML=me(n.actionItems||[]),he();break;case"pressureReadings":l.innerHTML=pe(n.pressureReadings||[]),ge();break}s.classList.add("visible")}function D(){document.getElementById("editModal").classList.remove("visible"),h.currentEditSection=null}function ce(e){const t=e.continuous||{},n=e.truckTreat||{};return`
        <div class="chemical-form-grid">
            <div class="form-column-header"></div>
            <div class="form-column-header">Continuous</div>
            <div class="form-column-header">Truck Treat</div>

            <div class="form-row-label">Rate (gal/month)</div>
            <input type="text" class="edit-form-input" id="editChemContRate" value="${t.rate||""}" placeholder="-">
            <input type="text" class="edit-form-input" id="editChemTruckRate" value="${n.rate||""}" placeholder="-">

            <div class="form-row-label">Chems Used</div>
            <input type="text" class="edit-form-input" id="editChemContChems" value="${t.chems||""}" placeholder="-">
            <input type="text" class="edit-form-input" id="editChemTruckChems" value="${n.chems||""}" placeholder="-">

            <div class="form-row-label">PPM</div>
            <input type="text" class="edit-form-input" id="editChemContPPM" value="${t.ppm||""}" placeholder="-">
            <input type="text" class="edit-form-input" id="editChemTruckPPM" value="${n.ppm||""}" placeholder="-">
        </div>
    `}function de(e){let t="";return e.length>0&&(t=e.map((n,s)=>`
            <tr data-row-index="${s}">
                <td><input type="date" class="edit-table-input" name="dateDown" value="${M(n.dateDown)}"></td>
                <td><input type="date" class="edit-table-input" name="dateUp" value="${M(n.dateUp)}"></td>
                <td><input type="number" class="edit-table-input" name="downtime" value="${n.downtime||""}" placeholder="-"></td>
                <td><input type="number" class="edit-table-input" name="oil" value="${n.oil||""}" placeholder="-"></td>
                <td><input type="text" class="edit-table-input" name="reason" value="${n.reason||""}" placeholder="-"></td>
                <td><input type="text" class="edit-table-input" name="comments" value="${n.comments||""}" placeholder="-"></td>
                <td>
                    <button type="button" class="btn-delete-row" title="Delete row">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </td>
            </tr>
        `).join("")),`
        <div class="edit-table-container">
            <table class="edit-table" id="failureEditTable">
                <thead>
                    <tr>
                        <th>Date Down</th>
                        <th>Date Up</th>
                        <th>Downtime (days)</th>
                        <th>Oil Lost</th>
                        <th>Reason</th>
                        <th>Comments</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody id="failureEditBody">
                    ${t}
                </tbody>
            </table>
        </div>
        <button type="button" class="btn-add-row" id="btnAddFailureRow">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
            Add Entry
        </button>
    `}function ue(){const e=document.getElementById("btnAddFailureRow"),t=document.getElementById("failureEditBody");e&&e.addEventListener("click",()=>{const n=document.createElement("tr");n.innerHTML=`
                <td><input type="date" class="edit-table-input" name="dateDown"></td>
                <td><input type="date" class="edit-table-input" name="dateUp"></td>
                <td><input type="number" class="edit-table-input" name="downtime" placeholder="-"></td>
                <td><input type="number" class="edit-table-input" name="oil" placeholder="-"></td>
                <td><input type="text" class="edit-table-input" name="reason" placeholder="-"></td>
                <td><input type="text" class="edit-table-input" name="comments" placeholder="-"></td>
                <td>
                    <button type="button" class="btn-delete-row" title="Delete row">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </td>
            `,t.appendChild(n),k(n.querySelector(".btn-delete-row"))}),t.querySelectorAll(".btn-delete-row").forEach(n=>{k(n)})}function me(e){let t="";return e.length>0?t=e.map((n,s)=>`
            <div class="action-item-row" data-item-index="${s}">
                <input type="text" class="edit-form-input" name="actionItem" value="${K(n)}">
                <button type="button" class="btn-delete-item" title="Delete item">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
        `).join(""):t='<div class="action-items-empty">No action items. Add one below.</div>',`
        <div class="action-items-editor" id="actionItemsEditor">
            ${t}
        </div>
        <div class="action-items-add-row">
            <input type="text" class="edit-form-input" id="newActionItem" placeholder="Enter new action item...">
            <button type="button" class="btn-add-item" id="btnAddActionItem">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="12" y1="5" x2="12" y2="19"></line>
                    <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
                Add
            </button>
        </div>
    `}function he(){const e=document.getElementById("btnAddActionItem"),t=document.getElementById("newActionItem"),n=document.getElementById("actionItemsEditor"),s=()=>{const a=t.value.trim();if(!a)return;const l=n.querySelector(".action-items-empty");l&&l.remove();const r=document.createElement("div");r.className="action-item-row",r.innerHTML=`
            <input type="text" class="edit-form-input" name="actionItem" value="${K(a)}">
            <button type="button" class="btn-delete-item" title="Delete item">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        `,n.appendChild(r),z(r.querySelector(".btn-delete-item")),t.value="",t.focus()};e&&e.addEventListener("click",s),t&&t.addEventListener("keypress",a=>{a.key==="Enter"&&(a.preventDefault(),s())}),n.querySelectorAll(".btn-delete-item").forEach(a=>{z(a)})}function z(e){e.addEventListener("click",()=>{e.closest(".action-item-row").remove();const n=document.getElementById("actionItemsEditor");n.querySelectorAll(".action-item-row").length===0&&(n.innerHTML='<div class="action-items-empty">No action items. Add one below.</div>')})}function pe(e){let t="";return e.length>0&&(t=e.map((n,s)=>`
            <tr data-row-index="${s}">
                <td><input type="date" class="edit-table-input" name="date" value="${M(n.date)}"></td>
                <td><input type="number" class="edit-table-input" name="casingPsi" value="${n.casingPsi||""}" placeholder="-"></td>
                <td><input type="number" class="edit-table-input" name="tubingPsi" value="${n.tubingPsi||""}" placeholder="-"></td>
                <td><input type="number" class="edit-table-input" name="flowlinePsi" value="${n.flowlinePsi||""}" placeholder="-"></td>
                <td>
                    <button type="button" class="btn-delete-row" title="Delete row">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </td>
            </tr>
        `).join("")),`
        <div class="edit-table-container">
            <table class="edit-table" id="pressureEditTable">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Casing PSI</th>
                        <th>Tubing PSI</th>
                        <th>Flowline PSI</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody id="pressureEditBody">
                    ${t}
                </tbody>
            </table>
        </div>
        <button type="button" class="btn-add-row" id="btnAddPressureRow">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
            Add Entry
        </button>
    `}function ge(){const e=document.getElementById("btnAddPressureRow"),t=document.getElementById("pressureEditBody");e&&e.addEventListener("click",()=>{const n=document.createElement("tr");n.innerHTML=`
                <td><input type="date" class="edit-table-input" name="date"></td>
                <td><input type="number" class="edit-table-input" name="casingPsi" placeholder="-"></td>
                <td><input type="number" class="edit-table-input" name="tubingPsi" placeholder="-"></td>
                <td><input type="number" class="edit-table-input" name="flowlinePsi" placeholder="-"></td>
                <td>
                    <button type="button" class="btn-delete-row" title="Delete row">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </td>
            `,t.appendChild(n),k(n.querySelector(".btn-delete-row"))}),t.querySelectorAll(".btn-delete-row").forEach(n=>{k(n)})}function k(e){e.addEventListener("click",()=>{e.closest("tr").remove()})}function fe(){if(!h.currentSheet||!h.currentWell||!h.currentEditSection)return;const e=h.appData[h.currentSheet];if(!e||!e.wells)return;const t=e.wells.findIndex(s=>s.id===h.currentWell);if(t===-1)return;const n=e.wells[t];switch(h.currentEditSection){case"chemicalProgram":n.chemicalProgram=we();break;case"failureHistory":n.failureHistory=Ce();break;case"actionItems":n.actionItems=ye();break;case"pressureReadings":n.pressureReadings=be();break}I(),D(),H&&H(h.currentSheet,h.currentWell)}function we(){var e,t,n,s,a,l;return{continuous:{rate:((e=document.getElementById("editChemContRate"))==null?void 0:e.value)||"",chems:((t=document.getElementById("editChemContChems"))==null?void 0:t.value)||"",ppm:((n=document.getElementById("editChemContPPM"))==null?void 0:n.value)||""},truckTreat:{rate:((s=document.getElementById("editChemTruckRate"))==null?void 0:s.value)||"",chems:((a=document.getElementById("editChemTruckChems"))==null?void 0:a.value)||"",ppm:((l=document.getElementById("editChemTruckPPM"))==null?void 0:l.value)||""}}}function Ce(){const t=document.getElementById("failureEditBody").querySelectorAll("tr"),n=[];return t.forEach(s=>{var d,u,m,g,p,f;const a=(d=s.querySelector('input[name="dateDown"]'))==null?void 0:d.value,l=(u=s.querySelector('input[name="dateUp"]'))==null?void 0:u.value,r=(m=s.querySelector('input[name="downtime"]'))==null?void 0:m.value,o=(g=s.querySelector('input[name="oil"]'))==null?void 0:g.value,i=(p=s.querySelector('input[name="reason"]'))==null?void 0:p.value,c=(f=s.querySelector('input[name="comments"]'))==null?void 0:f.value;(a||l||r||o||i||c)&&n.push({dateDown:a||null,dateUp:l||null,downtime:r?Number(r):null,oil:o?Number(o):null,reason:i||"",comments:c||""})}),n}function ye(){const t=document.getElementById("actionItemsEditor").querySelectorAll('input[name="actionItem"]'),n=[];return t.forEach(s=>{const a=s.value.trim();a&&n.push(a)}),n}function be(){const t=document.getElementById("pressureEditBody").querySelectorAll("tr"),n=[];return t.forEach(s=>{var i,c,d,u;const a=(i=s.querySelector('input[name="date"]'))==null?void 0:i.value,l=(c=s.querySelector('input[name="casingPsi"]'))==null?void 0:c.value,r=(d=s.querySelector('input[name="tubingPsi"]'))==null?void 0:d.value,o=(u=s.querySelector('input[name="flowlinePsi"]'))==null?void 0:u.value;(a||l||r||o)&&n.push({date:a||null,casingPsi:l?Number(l):null,tubingPsi:r?Number(r):null,flowlinePsi:o?Number(o):null})}),n.sort((s,a)=>!s.date&&!a.date?0:s.date?a.date?new Date(a.date)-new Date(s.date):-1:1),n}function Se(){let e=0,t=0,n=0;const s=new Date;return s.setHours(23,59,59,999),Object.keys(h.appData).forEach(a=>{const l=h.appData[a];l&&l.wells&&l.wells.length>0&&l.wells.forEach(r=>{if(r.status!=="inactive"&&r.wellTests&&r.wellTests.length>0){const o=r.wellTests.filter(i=>new Date(i.date)<=s);if(o.length>0){const i=o[0];i.oil!==null&&!isNaN(i.oil)&&(e+=Number(i.oil)),i.water!==null&&!isNaN(i.water)&&(t+=Number(i.water)),i.gas!==null&&!isNaN(i.gas)&&(n+=Math.max(0,Number(i.gas)))}}})}),{totalOil:Math.round(e*100)/100,totalWater:Math.round(t*100)/100,totalGas:Math.round(n*100)/100}}function ve(e="oil",t=null,n=null,s="month",a=null){const l=new Map;let r=null,o=null;const i=new Date;i.setHours(23,59,59,999);const c=u=>{const m=new Date(u);if(s==="week"){const g=m.getUTCDay(),p=g===0?-6:1-g;m.setUTCDate(m.getUTCDate()+p)}else s==="month"&&m.setUTCDate(1);return m.setUTCHours(0,0,0,0),m};Object.keys(h.appData).forEach(u=>{const m=h.appData[u];m&&m.wells&&m.wells.length>0&&m.wells.forEach(g=>{if(g.status==="inactive"||a&&!a.has(g.id))return;(g.production||[]).forEach(f=>{if(!f.date)return;const w=new Date(f.date);if(isNaN(w.getTime())||w>i)return;let C=f[e];if(C==null||isNaN(C))return;e==="gas"&&C<0&&(C=0);const y=c(w);(!r||y<r)&&(r=y),(!o||y>o)&&(o=y);const b=y.toISOString().split("T")[0],Q=l.get(b)||0;l.set(b,Q+Number(C))})})});let d=Array.from(l.entries()).map(([u,m])=>({x:new Date(u),y:m})).sort((u,m)=>u.x-m.x);return(t||n)&&(d=d.filter(u=>{const m=u.x.getTime();return!(t&&m<t.getTime()||n&&m>n.getTime())})),{data:d,dateRange:{min:r,max:o}}}function Te(e=10){const t=[],n=new Date;return n.setHours(23,59,59,999),Object.keys(h.appData).forEach(s=>{const a=h.appData[s],l=S.find(r=>r.id===s);a&&a.wells&&l&&a.wells.forEach(r=>{if(r.status==="inactive")return;let o=null,i=null;if(r.wellTests&&r.wellTests.length>0){const c=r.wellTests.filter(d=>new Date(d.date)<=n);if(c.length>0){const d=c[0];o=d.oil,i=d.water}}t.push({wellId:r.id,wellName:r.name,sheetId:s,batteryName:l.name,oil:o!==null?Math.round(Number(o)*100)/100:0,water:i!==null?Math.round(Number(i)*100)/100:0})})}),t.sort((s,a)=>a.oil-s.oil),t.slice(0,e)}function Ee(e=10){const t=[],n=new Date;return n.setHours(23,59,59,999),Object.keys(h.appData).forEach(s=>{const a=h.appData[s],l=S.find(r=>r.id===s);a&&a.wells&&l&&a.wells.forEach(r=>{r.status!=="inactive"&&r.wellTests&&r.wellTests.length>0&&r.wellTests.forEach(o=>{if(o.date){const i=new Date(o.date);if(i>n)return;t.push({date:i,wellId:r.id,wellName:r.name,sheetId:s,batteryName:l.name,oil:o.oil!==null?Math.round(o.oil*100)/100:null,water:o.water!==null?Math.round(o.water*100)/100:null,gas:o.gas!==null?Math.round(Math.max(0,o.gas)*100)/100:null})}})})}),t.sort((s,a)=>a.date-s.date),t.slice(0,e)}function xe(e=15){const t=[];return Object.keys(h.appData).forEach(n=>{const s=h.appData[n],a=S.find(l=>l.id===n);s&&s.wells&&a&&s.wells.forEach(l=>{l.status!=="inactive"&&l.actionItems&&l.actionItems.length>0&&l.actionItems.forEach(r=>{r&&r.trim()&&t.push({content:r,wellId:l.id,wellName:l.name,sheetId:n,batteryName:a.name})})})}),t.slice(0,e)}function Y(){return Object.keys(h.appData).some(e=>h.appData[e]&&h.appData[e].wells&&h.appData[e].wells.length>0)}const De={id:"cowden",name:"Cowden",expectedFileName:"Cowden Gauge Sheet1.xlsx",wells:[{id:"601h",name:"Cowden 601H",oilCol:1,waterCol:2,gasCol:3},{id:"602h",name:"Cowden 602H",oilCol:7,waterCol:8,gasCol:9},{id:"angus",name:"Angus 7-18-1H",oilCol:13,waterCol:14,gasCol:15}],parse(e){const t={id:this.id,name:this.name,lastUpdated:new Date().toISOString(),wells:[],runTickets:[],rawRowCount:0};if(e.Sheets["Well Test"]){const n=this.parseWellTestSheet(e.Sheets["Well Test"]);t.wells=n.wells,t.rawRowCount=n.rowCount}return e.Sheets["Run Tickets"]&&(t.runTickets=this.parseRunTicketsSheet(e.Sheets["Run Tickets"])),t},parseWellTestSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),n=this.wells.map(a=>({id:a.id,name:a.name,status:"active",wellTests:[],production:[],chemicalProgram:{continuous:{rate:null,chems:"-",ppm:null},truckTreat:{rate:null,chems:"-",ppm:null}},failureHistory:[],pressureReadings:[],actionItems:[]}));let s=0;for(let a=4;a<t.length;a++){const l=t[a];if(!l||!l[0])continue;const r=l[0];let o=null;if(r instanceof Date)o=r.toISOString().split("T")[0];else if(typeof r=="number"){const i=XLSX.SSF.parse_date_code(r);i&&(o=`${i.y}-${String(i.m).padStart(2,"0")}-${String(i.d).padStart(2,"0")}`)}else typeof r=="string"&&(o=r.split(" ")[0]);o&&(s++,this.wells.forEach((i,c)=>{const d=this.parseNumber(l[i.oilCol]),u=this.parseNumber(l[i.waterCol]),m=this.parseNumber(l[i.gasCol]);(d!==null||u!==null||m!==null)&&(n[c].wellTests.push({date:o,oil:d,water:u,gas:m}),n[c].production.push({date:new Date(o),oil:d,water:u,gas:m}))}))}return n.forEach(a=>{a.wellTests.sort((l,r)=>new Date(r.date)-new Date(l.date)),a.wellTests=a.wellTests.slice(0,60),a.production.sort((l,r)=>l.date-r.date)}),{wells:n,rowCount:s}},parseRunTicketsSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),n=[];for(let s=3;s<t.length;s++){const a=t[s];if(!a)continue;const l=a[1];if(!l)continue;let r=null;const o=a[0];if(o)if(o instanceof Date)r=o.toISOString().split("T")[0];else if(typeof o=="number"){const i=XLSX.SSF.parse_date_code(o);i&&(r=`${i.y}-${String(i.m).padStart(2,"0")}-${String(i.d).padStart(2,"0")}`)}else typeof o=="string"&&o.trim()&&(r=o.split(" ")[0]);n.push({date:r,ticketNum:String(l),tank:this.parseNumber(a[2]),ftTop:this.parseNumber(a[3]),inTop:this.parseNumber(a[4]),ftBttm:this.parseNumber(a[5]),inBttm:this.parseNumber(a[6]),calcVol:this.parseNumber(a[7]),vol:this.parseNumber(a[8]),gravity:this.parseNumber(a[9]),bsw:this.parseNumber(a[10])})}return n.sort((s,a)=>!s.date&&!a.date?0:s.date?a.date?new Date(a.date)-new Date(s.date):-1:1),n.slice(0,100)},parseNumber(e){if(e==null||e==="")return null;const t=parseFloat(e);return isNaN(t)?null:t<0?0:t}},Ne={id:"bigmax",name:"Big Max",expectedFileName:"Big Max Gauge Sheet.xlsx",wells:[{id:"bigmax-1-1",name:"Big Max 1 #1",oilCol:1,waterCol:2,gasCol:3,status:"active"},{id:"bigmax-4-1",name:"Big Max 4 #1",oilCol:7,waterCol:8,gasCol:9,status:"active"},{id:"bigmax-5-2",name:"Big Max 5 #2",oilCol:13,waterCol:14,gasCol:15,status:"active"},{id:"bigmax-11-1",name:"Big Max 11 #1",oilCol:19,waterCol:20,gasCol:21,status:"active"},{id:"bigmax-11-2",name:"Big Max 11 #2",oilCol:25,waterCol:26,gasCol:27,status:"active"},{id:"bigmax-12-1",name:"Big Max 12 #1",oilCol:31,waterCol:32,gasCol:33,status:"active"},{id:"bigmax-12-2",name:"Big Max 12 #2",oilCol:37,waterCol:38,gasCol:39,status:"active"},{id:"bigmax-13-3",name:"Big Max 13 #3",oilCol:43,waterCol:44,gasCol:45,status:"active"},{id:"bigmax-13-5",name:"Big Max 13 #5",oilCol:49,waterCol:50,gasCol:51,status:"active"},{id:"bigmax-14-4",name:"Big Max 14 #4",oilCol:55,waterCol:56,gasCol:57,status:"active"},{id:"bigmax-swd",name:"Big Max 12-101 SWD",oilCol:61,waterCol:62,gasCol:63,status:"active",wellType:"swd"}],parse(e){const t={id:this.id,name:this.name,lastUpdated:new Date().toISOString(),wells:[],runTickets:[],rawRowCount:0};if(e.Sheets["Well Test"]){const n=this.parseWellTestSheet(e.Sheets["Well Test"]);t.wells=n.wells,t.rawRowCount=n.rowCount}return e.Sheets["Run Tickets"]&&(t.runTickets=this.parseRunTicketsSheet(e.Sheets["Run Tickets"])),t},parseWellTestSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),n=this.wells.map(a=>({id:a.id,name:a.name,status:a.status||"active",wellType:a.wellType||"production",wellTests:[],production:[],chemicalProgram:{continuous:{rate:null,chems:"-",ppm:null},truckTreat:{rate:null,chems:"-",ppm:null}},failureHistory:[],pressureReadings:[],actionItems:[]}));let s=0;for(let a=4;a<t.length;a++){const l=t[a];if(!l||!l[0])continue;const r=this.parseDate(l[0]);r&&(s++,this.wells.forEach((o,i)=>{const c=this.parseNumber(l[o.oilCol]),d=this.parseNumber(l[o.waterCol]),u=this.parseNumber(l[o.gasCol]);(c!==null||d!==null||u!==null)&&(n[i].wellTests.push({date:r,oil:c,water:d,gas:u}),n[i].production.push({date:new Date(r),oil:c,water:d,gas:u}))}))}return n.forEach(a=>{a.wellTests.sort((l,r)=>new Date(r.date)-new Date(l.date)),a.wellTests=a.wellTests.slice(0,60),a.production.sort((l,r)=>l.date-r.date)}),{wells:n,rowCount:s}},parseRunTicketsSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),n=[];for(let s=3;s<t.length;s++){const a=t[s];!a||!a[1]||n.push({date:this.parseDate(a[0]),ticketNum:String(a[1]||""),tank:this.parseNumber(a[2]),ftTop:this.parseNumber(a[3]),inTop:this.parseNumber(a[4]),ftBttm:this.parseNumber(a[5]),inBttm:this.parseNumber(a[6]),vol:this.parseNumber(a[8])})}return n.sort((s,a)=>(a.date||"").localeCompare(s.date||"")),n.slice(0,100)},parseDate(e){if(!e)return null;if(e instanceof Date)return e.toISOString().split("T")[0];if(typeof e=="number"){const t=XLSX.SSF.parse_date_code(e);if(t)return`${t.y}-${String(t.m).padStart(2,"0")}-${String(t.d).padStart(2,"0")}`}return typeof e=="string"?e.split(" ")[0]:null},parseNumber(e){if(e==null||e==="")return null;const t=parseFloat(e);return isNaN(t)?null:t<0?0:t}},ke={id:"bigmax1h",name:"Big Max 1H",expectedFileName:"Big Max 1H Gauge Sheet.xlsx",wells:[{id:"bigmax-1-1h",name:"Big Max 1-1H",oilCol:1,waterCol:2,gasCol:3}],parse(e){const t={id:this.id,name:this.name,lastUpdated:new Date().toISOString(),wells:[],runTickets:[],rawRowCount:0};if(e.Sheets["Well Test"]){const n=this.parseWellTestSheet(e.Sheets["Well Test"]);t.wells=n.wells,t.rawRowCount=n.rowCount}return t.wells.length>0&&this.applyPressureReadings(e,t.wells),e.Sheets["Run Tickets"]&&(t.runTickets=this.parseRunTicketsSheet(e.Sheets["Run Tickets"])),t},parseWellTestSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),n=this.wells.map(a=>({id:a.id,name:a.name,status:"active",wellTests:[],production:[],chemicalProgram:{continuous:{rate:null,chems:"-",ppm:null},truckTreat:{rate:null,chems:"-",ppm:null}},failureHistory:[],pressureReadings:[],actionItems:[]}));let s=0;for(let a=4;a<t.length;a++){const l=t[a];if(!l||!l[0])continue;const r=this.parseDate(l[0]);r&&(s++,this.wells.forEach((o,i)=>{const c=this.parseNumber(l[o.oilCol]),d=this.parseNumber(l[o.waterCol]),u=this.parseNumber(l[o.gasCol]);(c!==null||d!==null||u!==null)&&(n[i].wellTests.push({date:r,oil:c,water:d,gas:u}),n[i].production.push({date:new Date(r),oil:c,water:d,gas:u}))}))}return n.forEach(a=>{a.wellTests.sort((l,r)=>new Date(r.date)-new Date(l.date)),a.wellTests=a.wellTests.slice(0,60),a.production.sort((l,r)=>l.date-r.date)}),{wells:n,rowCount:s}},parseRunTicketsSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),n=[];for(let s=3;s<t.length;s++){const a=t[s];!a||!a[1]||n.push({date:this.parseDate(a[0]),ticketNum:String(a[1]||""),tank:this.parseNumber(a[2]),ftTop:this.parseNumber(a[3]),inTop:this.parseNumber(a[4]),ftBttm:this.parseNumber(a[5]),inBttm:this.parseNumber(a[6]),vol:this.parseNumber(a[8])})}return n.sort((s,a)=>(a.date||"").localeCompare(s.date||"")),n.slice(0,100)},applyPressureReadings(e,t){const n={};t.forEach(a=>{n[a.id]=[]}),Object.keys(e.Sheets||{}).forEach(a=>{const l=e.Sheets[a];if(!l)return;const r=XLSX.utils.sheet_to_json(l,{header:1,defval:null});if(!r||r.length===0)return;const o=this.findPressureHeaderRow(r);if(o===null)return;const i=this.buildCompositeHeaders(r,o),c=this.findDateColumn(i);if(c===null)return;const d=this.buildPressureColumnMap(i,t);if(Object.values(d).some(m=>m.casing!==null||m.tubing!==null||m.flowline!==null))for(let m=o+1;m<r.length;m++){const g=r[m];if(!g)continue;const p=this.parseDate(g[c]);p&&t.forEach(f=>{const w=d[f.id];if(!w)return;const C=this.parseNumber(g[w.casing]),y=this.parseNumber(g[w.tubing]),b=this.parseNumber(g[w.flowline]);(C!==null||y!==null||b!==null)&&n[f.id].push({date:p,casingPsi:C,tubingPsi:y,flowlinePsi:b})})}}),t.forEach(a=>{const l=n[a.id]||[];l.sort((r,o)=>new Date(o.date)-new Date(r.date)),a.pressureReadings=l.slice(0,60)})},findPressureHeaderRow(e){const t=Math.min(e.length,20);let n=null;for(let s=0;s<t;s++){const l=(e[s]||[]).map(i=>this.normalizeHeader(i)),r=l.some(i=>i.includes("csg")||i.includes("casing")||i.includes("tbg")||i.includes("tubing")||i.includes("flowline")),o=l.some(i=>i.includes("date")||i.includes("day"));if(r&&n===null&&(n=s),r&&o)return s}return n},findDateColumn(e){for(let t=0;t<e.length;t++){const n=e[t];if(n.includes("date")||n.includes("day"))return t}return null},buildCompositeHeaders(e,t,n=3){const s=[],a=Math.max(0,t-n),l=e.reduce((r,o)=>Math.max(r,o?o.length:0),0);for(let r=0;r<l;r++){const o=[];for(let i=a;i<=t;i++){const c=e[i]?e[i][r]:null,d=this.normalizeHeader(c);d&&o.push(d)}s[r]=o.join(" ")}return s},buildPressureColumnMap(e,t){const n={};return t.forEach(s=>{n[s.id]={casing:null,tubing:null,flowline:null}}),e.forEach((s,a)=>{var o,i;if(!s)return;const l=this.detectPressureType(s);if(!l)return;const r=this.matchWellForHeader(s,t);r?(o=n[r.id])[l]??(o[l]=a):t.length===1&&((i=n[t[0].id])[l]??(i[l]=a))}),n},detectPressureType(e){return e.includes("csg")||e.includes("casing")?"casing":e.includes("tbg")||e.includes("tubing")?"tubing":e.includes("flowline")||e.includes("fl")&&e.includes("psi")&&!e.includes("flare")?"flowline":null},matchWellForHeader(e,t){for(const n of t)if(this.buildWellKeys(n).some(a=>a&&e.includes(a)))return n;return null},buildWellKeys(e){const t=new Set;return[e.name,e.id].forEach(n=>{const s=this.normalizeHeader(n);s&&t.add(s);const a=s.replace(/^[a-z]+/,"");a&&t.add(a)}),Array.from(t)},normalizeHeader(e){return e==null?"":String(e).toLowerCase().replace(/[^a-z0-9]/g,"")},parseDate(e){if(!e)return null;if(e instanceof Date)return e.toISOString().split("T")[0];if(typeof e=="number"){const t=XLSX.SSF.parse_date_code(e);if(t)return`${t.y}-${String(t.m).padStart(2,"0")}-${String(t.d).padStart(2,"0")}`}return typeof e=="string"?e.split(" ")[0]:null},parseNumber(e){if(e==null||e==="")return null;const t=parseFloat(e);return isNaN(t)?null:t<0?0:t}},Ie={id:"southandrews",name:"South Andrews",expectedFileName:"South Andrews Gauge Sheet.xlsm",wellsPg1:[{id:"uls-1-30-6h",name:"1-30-6H",oilCol:1,waterCol:2,gasCol:3},{id:"uls-1-30-8h",name:"1-30-8H",oilCol:7,waterCol:8,gasCol:9},{id:"uls-1-31-2h",name:"1-31-2H",oilCol:13,waterCol:14,gasCol:15},{id:"uls-1-36-1h",name:"1-36-1H",oilCol:19,waterCol:20,gasCol:21},{id:"uls-1-36-2h",name:"1-36-2H",oilCol:25,waterCol:26,gasCol:27},{id:"uls-1-36-3h",name:"1-36-3H",oilCol:31,waterCol:32,gasCol:33},{id:"uls-1-36-4h",name:"1-36-4H",oilCol:37,waterCol:38,gasCol:39},{id:"uls-1-36-5h",name:"1-36-5H",oilCol:43,waterCol:44,gasCol:45},{id:"uls-1-36-6h",name:"1-36-6H",oilCol:49,waterCol:50,gasCol:51},{id:"uls-1-37-1h",name:"1-37-1H",oilCol:55,waterCol:56,gasCol:57},{id:"uls-1-37-3h",name:"1-37-3H",oilCol:61,waterCol:62,gasCol:63},{id:"uls-1-37-4h",name:"1-37-4H",oilCol:67,waterCol:68,gasCol:69},{id:"uls-1-37-6h",name:"1-37-6H",oilCol:73,waterCol:74,gasCol:75}],wellsPg2:[{id:"cobra-5h",name:"Cobra 5H",oilCol:1,waterCol:2,gasCol:3,status:"active"},{id:"cobra-3012",name:"Cobra 3012",oilCol:7,waterCol:8,gasCol:9,status:"active"},{id:"cobra-3033",name:"Cobra 3033",oilCol:13,waterCol:14,gasCol:15,status:"active"},{id:"fn-3731",name:"FN 3731",oilCol:19,waterCol:20,gasCol:21,status:"active"},{id:"pinnacle-1",name:"Pinnacle #1",oilCol:25,waterCol:26,gasCol:27,status:"active"},{id:"pinnacle-2h",name:"Pinnacle 2H",oilCol:31,waterCol:32,gasCol:33,status:"active"},{id:"sawgrass-2h",name:"Sawgrass 2H",oilCol:37,waterCol:38,gasCol:39,status:"inactive"},{id:"sawgrass-5h",name:"Sawgrass 5H",oilCol:43,waterCol:44,gasCol:45,status:"active"}],parse(e){const t={id:this.id,name:this.name,lastUpdated:new Date().toISOString(),wells:[],runTickets:[],rawRowCount:0};if(e.Sheets["Well Test pg1"]){const n=this.parseWellTestSheet(e.Sheets["Well Test pg1"],this.wellsPg1);t.wells.push(...n.wells),t.rawRowCount=n.rowCount}if(e.Sheets["Well Test pg2"]){const n=this.parseWellTestSheet(e.Sheets["Well Test pg2"],this.wellsPg2);t.wells.push(...n.wells)}return t.wells.length>0&&this.applyPressureReadings(e,t.wells),["36-4H Tickets","37-6H Tickets","36 6H Tickets"].forEach(n=>{if(e.Sheets[n]){const s=this.parseRunTicketsSheet(e.Sheets[n]);t.runTickets.push(...s)}}),t.runTickets.sort((n,s)=>(s.date||"").localeCompare(n.date||"")),t.runTickets=t.runTickets.slice(0,100),t},parseWellTestSheet(e,t){const n=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),s=t.map(l=>({id:l.id,name:l.name,status:l.status||"active",wellTests:[],production:[],chemicalProgram:{continuous:{rate:null,chems:"-",ppm:null},truckTreat:{rate:null,chems:"-",ppm:null}},failureHistory:[],pressureReadings:[],actionItems:[]}));let a=0;for(let l=4;l<n.length;l++){const r=n[l];if(!r||!r[0])continue;const o=this.parseDate(r[0]);o&&(a++,t.forEach((i,c)=>{const d=this.parseNumber(r[i.oilCol]),u=this.parseNumber(r[i.waterCol]),m=this.parseNumber(r[i.gasCol]);(d!==null||u!==null||m!==null)&&(s[c].wellTests.push({date:o,oil:d,water:u,gas:m}),s[c].production.push({date:new Date(o),oil:d,water:u,gas:m}))}))}return s.forEach(l=>{l.wellTests.sort((r,o)=>new Date(o.date)-new Date(r.date)),l.wellTests=l.wellTests.slice(0,60),l.production.sort((r,o)=>r.date-o.date)}),{wells:s,rowCount:a}},parseRunTicketsSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),n=[];for(let s=3;s<t.length;s++){const a=t[s];!a||!a[1]||n.push({date:this.parseDate(a[0]),ticketNum:String(a[1]||""),tank:this.parseNumber(a[2]),ftTop:this.parseNumber(a[3]),inTop:this.parseNumber(a[4]),ftBttm:this.parseNumber(a[5]),inBttm:this.parseNumber(a[6]),vol:this.parseNumber(a[8])})}return n},applyPressureReadings(e,t){const n={};t.forEach(a=>{n[a.id]=[]}),Object.keys(e.Sheets||{}).forEach(a=>{const l=e.Sheets[a];if(!l)return;const r=XLSX.utils.sheet_to_json(l,{header:1,defval:null});if(!r||r.length===0)return;const o=this.findPressureHeaderRow(r);if(o===null)return;const i=this.buildCompositeHeaders(r,o,6),c=this.findDateColumn(i);if(c===null)return;const d=this.buildPressureColumnMap(i,t);if(Object.values(d).some(m=>m.casing!==null||m.tubing!==null||m.flowline!==null))for(let m=o+1;m<r.length;m++){const g=r[m];if(!g)continue;const p=this.parseDate(g[c]);p&&t.forEach(f=>{const w=d[f.id];if(!w)return;const C=this.parseNumber(g[w.casing]),y=this.parseNumber(g[w.tubing]),b=this.parseNumber(g[w.flowline]);(C!==null||y!==null||b!==null)&&n[f.id].push({date:p,casingPsi:C,tubingPsi:y,flowlinePsi:b})})}}),t.forEach(a=>{const l=n[a.id]||[];l.sort((r,o)=>new Date(o.date)-new Date(r.date)),a.pressureReadings=l.slice(0,60)})},findPressureHeaderRow(e){const t=Math.min(e.length,25);let n=null;for(let s=0;s<t;s++){const l=(e[s]||[]).map(i=>this.normalizeHeader(i)),r=l.some(i=>i.includes("csg")||i.includes("casing")||i.includes("tbg")||i.includes("tubing")||i.includes("flowline")),o=l.some(i=>i.includes("date")||i.includes("day"));if(r&&n===null&&(n=s),r&&o)return s}return n},findDateColumn(e){for(let t=0;t<e.length;t++){const n=e[t];if(n.includes("date")||n.includes("day"))return t}return null},buildCompositeHeaders(e,t,n=3){const s=[],a=Math.max(0,t-n),l=e.reduce((r,o)=>Math.max(r,o?o.length:0),0);for(let r=0;r<l;r++){const o=[];for(let i=a;i<=t;i++){const c=e[i]?e[i][r]:null,d=this.normalizeHeader(c);d&&o.push(d)}s[r]=o.join(" ")}return s},buildPressureColumnMap(e,t){const n={};return t.forEach(s=>{n[s.id]={casing:null,tubing:null,flowline:null}}),e.forEach((s,a)=>{var o;if(!s)return;const l=this.detectPressureType(s);if(!l)return;const r=this.matchWellForHeader(s,t);r&&((o=n[r.id])[l]??(o[l]=a))}),n},detectPressureType(e){return e.includes("csg")||e.includes("casing")?"casing":e.includes("tbg")||e.includes("tubing")?"tubing":e.includes("flowline")||e.includes("fl")&&e.includes("psi")&&!e.includes("flare")?"flowline":null},matchWellForHeader(e,t){for(const n of t)if(this.buildWellKeys(n).some(a=>a&&e.includes(a)))return n;return null},buildWellKeys(e){const t=new Set;[e.name,e.id].forEach(s=>{const a=this.normalizeHeader(s);a&&t.add(a);const l=a.replace(/^[a-z]+/,"");l&&t.add(l)});const n=String(e.name||"");if(/1-36-/i.test(n)){const s=n.match(/(\d+)\s*H$/i);s&&t.add(s[1].toLowerCase()+"h")}return Array.from(t)},normalizeHeader(e){return e==null?"":String(e).toLowerCase().replace(/[^a-z0-9]/g,"")},parseDate(e){if(!e)return null;if(e instanceof Date)return e.toISOString().split("T")[0];if(typeof e=="number"){const t=XLSX.SSF.parse_date_code(e);if(t)return`${t.y}-${String(t.m).padStart(2,"0")}-${String(t.d).padStart(2,"0")}`}return typeof e=="string"?e.split(" ")[0]:null},parseNumber(e){if(e==null||e==="")return null;const t=parseFloat(e);return isNaN(t)?null:t<0?0:t}},Be={id:"polaris",name:"Polaris",expectedFileName:"Polaris Gauge Sheet.xlsx",wells:[{id:"polaris-1",name:"Polaris #1",oilCol:1,waterCol:2,gasCol:3,status:"active"},{id:"polaris-2",name:"Polaris #2",oilCol:5,waterCol:6,gasCol:7,status:"inactive"}],parse(e){const t={id:this.id,name:this.name,lastUpdated:new Date().toISOString(),wells:[],runTickets:[],rawRowCount:0};if(e.Sheets["Well Test"]){const n=this.parseWellTestSheet(e.Sheets["Well Test"]);t.wells=n.wells,t.rawRowCount=n.rowCount}return e.Sheets["Run Tickets"]&&(t.runTickets=this.parseRunTicketsSheet(e.Sheets["Run Tickets"])),t},parseWellTestSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),n=this.wells.map(a=>({id:a.id,name:a.name,status:a.status||"active",wellTests:[],production:[],chemicalProgram:{continuous:{rate:null,chems:"-",ppm:null},truckTreat:{rate:null,chems:"-",ppm:null}},failureHistory:[],pressureReadings:[],actionItems:[]}));let s=0;for(let a=4;a<t.length;a++){const l=t[a];if(!l||!l[0])continue;const r=this.parseDate(l[0]);r&&(s++,this.wells.forEach((o,i)=>{const c=this.parseNumber(l[o.oilCol]),d=this.parseNumber(l[o.waterCol]),u=this.parseNumber(l[o.gasCol]);(c!==null||d!==null||u!==null)&&(n[i].wellTests.push({date:r,oil:c,water:d,gas:u}),n[i].production.push({date:new Date(r),oil:c,water:d,gas:u}))}))}return n.forEach(a=>{a.wellTests.sort((l,r)=>new Date(r.date)-new Date(l.date)),a.wellTests=a.wellTests.slice(0,60),a.production.sort((l,r)=>l.date-r.date)}),{wells:n,rowCount:s}},parseRunTicketsSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),n=[];for(let s=3;s<t.length;s++){const a=t[s];!a||!a[1]||n.push({date:this.parseDate(a[0]),ticketNum:String(a[1]||""),tank:this.parseNumber(a[2]),ftTop:this.parseNumber(a[3]),inTop:this.parseNumber(a[4]),ftBttm:this.parseNumber(a[5]),inBttm:this.parseNumber(a[6]),vol:this.parseNumber(a[8])})}return n.sort((s,a)=>(a.date||"").localeCompare(s.date||"")),n.slice(0,100)},parseDate(e){if(!e)return null;if(e instanceof Date)return e.toISOString().split("T")[0];if(typeof e=="number"){const t=XLSX.SSF.parse_date_code(e);if(t)return`${t.y}-${String(t.m).padStart(2,"0")}-${String(t.d).padStart(2,"0")}`}return typeof e=="string"?e.split(" ")[0]:null},parseNumber(e){if(e==null||e==="")return null;const t=parseFloat(e);return isNaN(t)?null:t<0?0:t}},Le={id:"shusa",name:"Shusa",expectedFileName:"Shusa Gauge Sheet.xlsx",wells20RB:[{id:"shusa-20-1",name:"Shusa 20 #1",oilCol:1,waterCol:2,gasCol:null},{id:"shusa-20-2",name:"Shusa 20 #2",oilCol:5,waterCol:6,gasCol:null},{id:"shusa-20-3",name:"Shusa 20 #3",oilCol:9,waterCol:10,gasCol:null},{id:"shusa-20-4",name:"Shusa 20 #4",oilCol:13,waterCol:14,gasCol:null},{id:"shusa-20-5",name:"Shusa 20 #5",oilCol:17,waterCol:18,gasCol:null},{id:"rosebud-20-1",name:"Rosebud 20 #1",oilCol:21,waterCol:22,gasCol:null},{id:"rosebud-20-3",name:"Rosebud 20 #3",oilCol:25,waterCol:26,gasCol:null},{id:"rosebud-20-4",name:"Rosebud 20 #4",oilCol:29,waterCol:30,gasCol:null},{id:"rosebud-yates-1",name:"Rosebud-Yates #1",oilCol:33,waterCol:34,gasCol:35},{id:"link-2",name:"Link #2",oilCol:39,waterCol:40,gasCol:null},{id:"link-3",name:"Link #3",oilCol:43,waterCol:44,gasCol:null},{id:"link-4",name:"Link #4",oilCol:47,waterCol:48,gasCol:null},{id:"link-5",name:"Link #5",oilCol:51,waterCol:52,gasCol:null},{id:"link-6",name:"Link #6",oilCol:55,waterCol:56,gasCol:null}],wells1415:[{id:"shusa-14-1",name:"Shusa 14 #1",oilCol:4,waterCol:5,gasCol:null},{id:"shusa-14-2",name:"Shusa 14 #2",oilCol:8,waterCol:9,gasCol:null},{id:"shusa-14-3",name:"Shusa 14 #3",oilCol:12,waterCol:13,gasCol:null},{id:"shusa-14-4",name:"Shusa 14 #4",oilCol:16,waterCol:17,gasCol:null},{id:"shusa-14-5",name:"Shusa 14 #5",oilCol:20,waterCol:21,gasCol:null},{id:"shusa-14-6",name:"Shusa 14 #6",oilCol:24,waterCol:25,gasCol:null},{id:"shusa-14-7",name:"Shusa 14 #7",oilCol:28,waterCol:29,gasCol:null},{id:"shusa-14-8",name:"Shusa 14 #8",oilCol:32,waterCol:33,gasCol:null},{id:"shusa-14-9",name:"Shusa 14 #9",oilCol:36,waterCol:37,gasCol:null},{id:"shusa-14-10",name:"Shusa 14 #10",oilCol:40,waterCol:41,gasCol:null},{id:"shusa-14-12",name:"Shusa 14 #12",oilCol:44,waterCol:45,gasCol:null},{id:"shusa-15-1",name:"Shusa 15 #1",oilCol:48,waterCol:49,gasCol:null},{id:"shusa-15-2",name:"Shusa 15 #2",oilCol:52,waterCol:53,gasCol:null},{id:"shusa-15-3",name:"Shusa 15 #3",oilCol:56,waterCol:57,gasCol:null},{id:"shusa-15-4",name:"Shusa 15 #4",oilCol:60,waterCol:61,gasCol:null},{id:"shusa-15-6",name:"Shusa 15 #6",oilCol:64,waterCol:65,gasCol:null},{id:"shusa-15-7",name:"Shusa 15 #7",oilCol:68,waterCol:69,gasCol:null},{id:"shusa-15-8",name:"Shusa 15 #8",oilCol:72,waterCol:73,gasCol:null},{id:"shusa-15-9",name:"Shusa 15 #9",oilCol:76,waterCol:77,gasCol:null},{id:"shusa-15-10",name:"Shusa 15 #10",oilCol:80,waterCol:81,gasCol:null},{id:"shusa-15-11",name:"Shusa 15 #11",oilCol:84,waterCol:85,gasCol:null},{id:"shusa-15-12",name:"Shusa 15 #12",oilCol:88,waterCol:89,gasCol:null},{id:"shusa-15-13",name:"Shusa 15 #13",oilCol:92,waterCol:93,gasCol:null},{id:"shusa-15-14",name:"Shusa 15 #14",oilCol:96,waterCol:97,gasCol:null},{id:"shusa-15-15",name:"Shusa 15 #15",oilCol:100,waterCol:101,gasCol:null},{id:"shusa-15-16",name:"Shusa 15 #16",oilCol:104,waterCol:105,gasCol:null}],parse(e){const t={id:this.id,name:this.name,lastUpdated:new Date().toISOString(),wells:[],runTickets:[],rawRowCount:0};if(e.Sheets["Well Test 20 RB Link"]){const n=this.parseWellTestSheet(e.Sheets["Well Test 20 RB Link"],this.wells20RB);t.wells.push(...n.wells),t.rawRowCount=n.rowCount}if(e.Sheets["Well Test 14 15"]){const n=this.parseWellTestSheet(e.Sheets["Well Test 14 15"],this.wells1415);t.wells.push(...n.wells)}return["14-15 Run Tickets","20-RB Run Tickets","Link Run Tickets","Yates Run Tickets"].forEach(n=>{if(e.Sheets[n]){const s=this.parseRunTicketsSheet(e.Sheets[n]);t.runTickets.push(...s)}}),t.runTickets.sort((n,s)=>(s.date||"").localeCompare(n.date||"")),t.runTickets=t.runTickets.slice(0,100),t},parseWellTestSheet(e,t){const n=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),s=t.map(l=>({id:l.id,name:l.name,status:"active",wellTests:[],production:[],chemicalProgram:{continuous:{rate:null,chems:"-",ppm:null},truckTreat:{rate:null,chems:"-",ppm:null}},failureHistory:[],pressureReadings:[],actionItems:[]}));let a=0;for(let l=4;l<n.length;l++){const r=n[l];if(!r||!r[0])continue;const o=this.parseDate(r[0]);o&&(a++,t.forEach((i,c)=>{const d=this.parseNumber(r[i.oilCol]),u=this.parseNumber(r[i.waterCol]),m=i.gasCol!==null?this.parseNumber(r[i.gasCol]):null;(d!==null||u!==null||m!==null)&&(s[c].wellTests.push({date:o,oil:d,water:u,gas:m}),s[c].production.push({date:new Date(o),oil:d,water:u,gas:m}))}))}return s.forEach(l=>{l.wellTests.sort((r,o)=>new Date(o.date)-new Date(r.date)),l.wellTests=l.wellTests.slice(0,60),l.production.sort((r,o)=>r.date-o.date)}),{wells:s,rowCount:a}},parseRunTicketsSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),n=[];for(let s=3;s<t.length;s++){const a=t[s];!a||!a[1]||n.push({date:this.parseDate(a[0]),ticketNum:String(a[1]||""),tank:this.parseNumber(a[2]),ftTop:this.parseNumber(a[3]),inTop:this.parseNumber(a[4]),ftBttm:this.parseNumber(a[5]),inBttm:this.parseNumber(a[6]),vol:this.parseNumber(a[8])})}return n},parseDate(e){if(!e)return null;if(e instanceof Date)return e.toISOString().split("T")[0];if(typeof e=="number"){const t=XLSX.SSF.parse_date_code(e);if(t)return`${t.y}-${String(t.m).padStart(2,"0")}-${String(t.d).padStart(2,"0")}`}return typeof e=="string"?e.split(" ")[0]:null},parseNumber(e){if(e==null||e==="")return null;const t=parseFloat(e);return isNaN(t)?null:t<0?0:t}},Pe={id:"mwwemac",name:"MW-Wemac-Sabrina-Berkley",expectedFileName:"Mw-Wemac-Sabrina-Berkley.xlsx",wells:[{id:"berkley-1",name:"Berkley #1",oilCol:1,waterCol:2,gasCol:3,status:"active"},{id:"berkley-4",name:"Berkley #4",oilCol:7,waterCol:8,gasCol:9,status:"inactive"},{id:"berkley-5",name:"Berkley #5",oilCol:13,waterCol:14,gasCol:15,status:"active"},{id:"berkley-6",name:"Berkley #6",oilCol:19,waterCol:20,gasCol:21,status:"active"},{id:"sabrina-5",name:"Sabrina #5",oilCol:25,waterCol:26,gasCol:27,status:"inactive"},{id:"sabrina-7",name:"Sabrina #7",oilCol:31,waterCol:32,gasCol:33,status:"inactive"},{id:"sabrina-3",name:"Sabrina #3",oilCol:37,waterCol:38,gasCol:39,status:"inactive"},{id:"sabrina-12",name:"Sabrina #12",oilCol:43,waterCol:44,gasCol:45,status:"inactive"}],parse(e){const t={id:this.id,name:this.name,lastUpdated:new Date().toISOString(),wells:[],runTickets:[],rawRowCount:0};if(e.Sheets.Well_Test){const n=this.parseWellTestSheet(e.Sheets.Well_Test);t.wells=n.wells,t.rawRowCount=n.rowCount}return t},parseWellTestSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),n=this.wells.map(a=>({id:a.id,name:a.name,status:a.status||"active",wellTests:[],production:[],chemicalProgram:{continuous:{rate:null,chems:"-",ppm:null},truckTreat:{rate:null,chems:"-",ppm:null}},failureHistory:[],pressureReadings:[],actionItems:[]}));let s=0;for(let a=4;a<t.length;a++){const l=t[a];if(!l||!l[0])continue;const r=this.parseDate(l[0]);r&&(s++,this.wells.forEach((o,i)=>{const c=this.parseNumber(l[o.oilCol]),d=this.parseNumber(l[o.waterCol]),u=this.parseNumber(l[o.gasCol]);(c!==null||d!==null||u!==null)&&(n[i].wellTests.push({date:r,oil:c,water:d,gas:u}),n[i].production.push({date:new Date(r),oil:c,water:d,gas:u}))}))}return n.forEach(a=>{a.wellTests.sort((l,r)=>new Date(r.date)-new Date(l.date)),a.wellTests=a.wellTests.slice(0,60),a.production.sort((l,r)=>l.date-r.date)}),{wells:n,rowCount:s}},parseDate(e){if(!e)return null;if(e instanceof Date)return e.toISOString().split("T")[0];if(typeof e=="number"){const t=XLSX.SSF.parse_date_code(e);if(t)return`${t.y}-${String(t.m).padStart(2,"0")}-${String(t.d).padStart(2,"0")}`}return typeof e=="string"?e.split(" ")[0]:null},parseNumber(e){if(e==null||e==="")return null;const t=parseFloat(e);return isNaN(t)?null:t<0?0:t}},Me={id:"unit130",name:"1-30 Unit 1H",expectedFileName:"1-30 Unit 1H Gauge Sheet.xlsx",wells:[{id:"uls-1-30-1h",name:"ULS 1-30-1H",oilCol:1,waterCol:2,gasCol:3}],parse(e){const t={id:this.id,name:this.name,lastUpdated:new Date().toISOString(),wells:[],runTickets:[],rawRowCount:0};if(e.Sheets["Well Test"]){const n=this.parseWellTestSheet(e.Sheets["Well Test"]);t.wells=n.wells,t.rawRowCount=n.rowCount}return t},parseWellTestSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),n=this.wells.map(a=>({id:a.id,name:a.name,status:"active",wellTests:[],production:[],chemicalProgram:{continuous:{rate:null,chems:"-",ppm:null},truckTreat:{rate:null,chems:"-",ppm:null}},failureHistory:[],pressureReadings:[],actionItems:[]}));let s=0;for(let a=4;a<t.length;a++){const l=t[a];if(!l||!l[0])continue;const r=this.parseDate(l[0]);r&&(s++,this.wells.forEach((o,i)=>{const c=this.parseNumber(l[o.oilCol]),d=this.parseNumber(l[o.waterCol]),u=this.parseNumber(l[o.gasCol]);(c!==null||d!==null||u!==null)&&(n[i].wellTests.push({date:r,oil:c,water:d,gas:u}),n[i].production.push({date:new Date(r),oil:c,water:d,gas:u}))}))}return n.forEach(a=>{a.wellTests.sort((l,r)=>new Date(r.date)-new Date(l.date)),a.wellTests=a.wellTests.slice(0,60),a.production.sort((l,r)=>l.date-r.date)}),{wells:n,rowCount:s}},parseDate(e){if(!e)return null;if(e instanceof Date)return e.toISOString().split("T")[0];if(typeof e=="number"){const t=XLSX.SSF.parse_date_code(e);if(t)return`${t.y}-${String(t.m).padStart(2,"0")}-${String(t.d).padStart(2,"0")}`}return typeof e=="string"?e.split(" ")[0]:null},parseNumber(e){if(e==null||e==="")return null;const t=parseFloat(e);return isNaN(t)?null:t<0?0:t}},He={id:"uls35h",name:"ULS 3-5H",expectedFileName:"ULS 3-5H Gauge Sheet.xlsx",wells:[{id:"uls-1-3-1h",name:"ULS 1-3-1H",oilCol:1,waterCol:2,gasCol:3},{id:"uls-1-3-3h",name:"ULS 1-3-3H",oilCol:7,waterCol:8,gasCol:9},{id:"uls-1-3-5h",name:"ULS 1-3-5H",oilCol:13,waterCol:14,gasCol:15},{id:"uls-1-3-7h",name:"ULS 1-3-7H",oilCol:19,waterCol:20,gasCol:21}],parse(e){const t={id:this.id,name:this.name,lastUpdated:new Date().toISOString(),wells:[],runTickets:[],rawRowCount:0};if(e.Sheets["Well Test"]){const n=this.parseWellTestSheet(e.Sheets["Well Test"]);t.wells=n.wells,t.rawRowCount=n.rowCount}return t.wells.length>0&&this.applyPressureReadings(e,t.wells),e.Sheets["3-5H Run Tickets"]&&(t.runTickets=this.parseRunTicketsSheet(e.Sheets["3-5H Run Tickets"])),t},parseWellTestSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),n=this.wells.map(a=>({id:a.id,name:a.name,status:"active",wellTests:[],production:[],chemicalProgram:{continuous:{rate:null,chems:"-",ppm:null},truckTreat:{rate:null,chems:"-",ppm:null}},failureHistory:[],pressureReadings:[],actionItems:[]}));let s=0;for(let a=4;a<t.length;a++){const l=t[a];if(!l||!l[0])continue;const r=this.parseDate(l[0]);r&&(s++,this.wells.forEach((o,i)=>{const c=this.parseNumber(l[o.oilCol]),d=this.parseNumber(l[o.waterCol]),u=this.parseNumber(l[o.gasCol]);(c!==null||d!==null||u!==null)&&(n[i].wellTests.push({date:r,oil:c,water:d,gas:u}),n[i].production.push({date:new Date(r),oil:c,water:d,gas:u}))}))}return n.forEach(a=>{a.wellTests.sort((l,r)=>new Date(r.date)-new Date(l.date)),a.wellTests=a.wellTests.slice(0,60),a.production.sort((l,r)=>l.date-r.date)}),{wells:n,rowCount:s}},parseRunTicketsSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),n=[];for(let s=3;s<t.length;s++){const a=t[s];!a||!a[1]||n.push({date:this.parseDate(a[0]),ticketNum:String(a[1]||""),tank:this.parseNumber(a[2]),ftTop:this.parseNumber(a[3]),inTop:this.parseNumber(a[4]),ftBttm:this.parseNumber(a[5]),inBttm:this.parseNumber(a[6]),vol:this.parseNumber(a[8])})}return n.sort((s,a)=>(a.date||"").localeCompare(s.date||"")),n.slice(0,100)},applyPressureReadings(e,t){const n={};t.forEach(a=>{n[a.id]=[]}),Object.keys(e.Sheets||{}).forEach(a=>{const l=e.Sheets[a];if(!l)return;const r=XLSX.utils.sheet_to_json(l,{header:1,defval:null});if(!r||r.length===0)return;const o=this.findPressureHeaderRow(r);if(o===null)return;const i=this.buildCompositeHeaders(r,o),c=this.findDateColumn(i);if(c===null)return;const d=this.buildPressureColumnMap(i,t);if(Object.values(d).some(m=>m.casing!==null||m.tubing!==null||m.flowline!==null))for(let m=o+1;m<r.length;m++){const g=r[m];if(!g)continue;const p=this.parseDate(g[c]);p&&t.forEach(f=>{const w=d[f.id];if(!w)return;const C=this.parseNumber(g[w.casing]),y=this.parseNumber(g[w.tubing]),b=this.parseNumber(g[w.flowline]);(C!==null||y!==null||b!==null)&&n[f.id].push({date:p,casingPsi:C,tubingPsi:y,flowlinePsi:b})})}}),t.forEach(a=>{const l=n[a.id]||[];l.sort((r,o)=>new Date(o.date)-new Date(r.date)),a.pressureReadings=l.slice(0,60)})},findPressureHeaderRow(e){const t=Math.min(e.length,20);let n=null;for(let s=0;s<t;s++){const l=(e[s]||[]).map(i=>this.normalizeHeader(i)),r=l.some(i=>i.includes("csg")||i.includes("casing")||i.includes("tbg")||i.includes("tubing")||i.includes("flowline")),o=l.some(i=>i.includes("date")||i.includes("day"));if(r&&n===null&&(n=s),r&&o)return s}return n},findDateColumn(e){for(let t=0;t<e.length;t++){const n=e[t];if(n.includes("date")||n.includes("day"))return t}return null},buildCompositeHeaders(e,t,n=3){const s=[],a=Math.max(0,t-n),l=e.reduce((r,o)=>Math.max(r,o?o.length:0),0);for(let r=0;r<l;r++){const o=[];for(let i=a;i<=t;i++){const c=e[i]?e[i][r]:null,d=this.normalizeHeader(c);d&&o.push(d)}s[r]=o.join(" ")}return s},buildPressureColumnMap(e,t){const n={};return t.forEach(s=>{n[s.id]={casing:null,tubing:null,flowline:null}}),e.forEach((s,a)=>{var o;if(!s)return;const l=this.detectPressureType(s);if(!l)return;const r=this.matchWellForHeader(s,t);r&&((o=n[r.id])[l]??(o[l]=a))}),n},detectPressureType(e){return e.includes("csg")||e.includes("casing")?"casing":e.includes("tbg")||e.includes("tubing")?"tubing":e.includes("flowline")||e.includes("fl")&&e.includes("psi")&&!e.includes("flare")?"flowline":null},matchWellForHeader(e,t){for(const n of t)if(this.buildWellKeys(n).some(a=>a&&e.includes(a)))return n;return null},buildWellKeys(e){const t=new Set;return[e.name,e.id].forEach(n=>{const s=this.normalizeHeader(n);s&&t.add(s);const a=s.replace(/^[a-z]+/,"");a&&t.add(a)}),Array.from(t)},normalizeHeader(e){return e==null?"":String(e).toLowerCase().replace(/[^a-z0-9]/g,"")},parseDate(e){if(!e)return null;if(e instanceof Date)return e.toISOString().split("T")[0];if(typeof e=="number"){const t=XLSX.SSF.parse_date_code(e);if(t)return`${t.y}-${String(t.m).padStart(2,"0")}-${String(t.d).padStart(2,"0")}`}return typeof e=="string"?e.split(" ")[0]:null},parseNumber(e){if(e==null||e==="")return null;const t=parseFloat(e);return isNaN(t)?null:t<0?0:t}},F={CowdenParser:De,BigMaxParser:Ne,BigMax1HParser:ke,SouthAndrewsParser:Ie,PolarisParser:Be,ShusaParser:Le,MWWemacParser:Pe,Unit130Parser:Me,ULS35HParser:He};function Re(){const e=document.getElementById("uploadArea"),t=document.getElementById("fileInput"),n=document.getElementById("btnReupload");e.addEventListener("click",s=>{s.target.id!=="btnReupload"&&t.click()}),n.addEventListener("click",s=>{s.stopPropagation(),t.click()}),t.addEventListener("change",s=>{const a=s.target.files[0];a&&G(a),t.value=""}),e.addEventListener("dragover",s=>{s.preventDefault(),e.classList.add("drag-over")}),e.addEventListener("dragleave",()=>{e.classList.remove("drag-over")}),e.addEventListener("drop",s=>{s.preventDefault(),e.classList.remove("drag-over");const a=s.dataTransfer.files[0];a&&G(a)})}async function G(e){if(!h.currentSheet){alert("Please select a gauge sheet first");return}const t=S.find(r=>r.id===h.currentSheet);if(!t)return;const n=F[t.parser];if(!n){alert(`Parser not yet implemented for ${t.name}. Coming soon!`);return}const s=document.getElementById("uploadProgress"),a=document.getElementById("progressFill"),l=document.getElementById("progressText");s.style.display="block",a.style.width="10%",l.textContent="Reading file...";try{const r=await e.arrayBuffer();a.style.width="30%",l.textContent="Parsing Excel...";const o=XLSX.read(r,{type:"array",cellDates:!0});a.style.width="60%",l.textContent="Extracting data...";const i=n.parse(o);a.style.width="90%",l.textContent="Saving...",h.appData[h.currentSheet]=i,I(),a.style.width="100%",l.textContent="Complete!",setTimeout(()=>{s.style.display="none",a.style.width="0%",L(),J(h.currentSheet)},500)}catch(r){console.error("Error processing file:",r),alert("Error processing file: "+r.message),s.style.display="none"}}function $e(){const e=document.getElementById("bulkUploadArea"),t=document.getElementById("bulkFileInput");!e||!t||(e.addEventListener("click",()=>{t.click()}),t.addEventListener("change",n=>{const s=Array.from(n.target.files);s.length>0&&V(s),t.value=""}),e.addEventListener("dragover",n=>{n.preventDefault(),e.classList.add("drag-over")}),e.addEventListener("dragleave",()=>{e.classList.remove("drag-over")}),e.addEventListener("drop",n=>{n.preventDefault(),e.classList.remove("drag-over");const s=Array.from(n.dataTransfer.files);s.length>0&&V(s)}))}async function V(e){const t=document.getElementById("bulkUploadProgress"),n=document.getElementById("bulkProgressFill"),s=document.getElementById("bulkProgressText"),a=document.getElementById("bulkUploadResults");t.style.display="block",a.style.display="none",a.innerHTML="";const l=[];let r=0;for(const o of e){n.style.width=`${r/e.length*100}%`,s.textContent=`Processing ${o.name}...`;const i=S.find(d=>o.name.toLowerCase().includes(d.fileName.toLowerCase().replace(".xlsx","").replace(".xlsm",""))||d.fileName.toLowerCase()===o.name.toLowerCase());if(!i){l.push({name:o.name,status:"skipped",detail:"Unknown file"}),r++;continue}const c=F[i.parser];if(!c){l.push({name:o.name,status:"skipped",detail:"No parser available"}),r++;continue}try{const d=await o.arrayBuffer(),u=XLSX.read(d,{type:"array",cellDates:!0}),m=c.parse(u);h.appData[i.id]=m,l.push({name:i.name,status:"success",detail:`${m.wells.length} wells loaded`})}catch(d){console.error(`Error processing ${o.name}:`,d),l.push({name:o.name,status:"error",detail:d.message})}r++}I(),n.style.width="100%",s.textContent="Complete!",setTimeout(()=>{t.style.display="none",a.style.display="block",a.innerHTML=l.map(o=>`
            <div class="bulk-result-item ${o.status}">
                <span class="result-icon">${o.status==="success"?"OK":o.status==="error"?"X":"?"}</span>
                <span class="result-name">${o.name}</span>
                <span class="result-detail">${o.detail}</span>
            </div>
        `).join(""),L()},500)}async function We(e){const t=document.getElementById("dashboardLoadingOverlay"),n=document.getElementById("dashboardLoadingText"),s=document.getElementById("dashboardLoadingSubtext");t.classList.add("visible"),n.textContent="Processing sheets...",s.textContent=`0 of ${e.length} files`;let a=0,l=0;await new Promise(r=>setTimeout(r,50));for(const r of e){s.textContent=`${a+1} of ${e.length}: ${r.name}`;const o=S.find(c=>r.name.toLowerCase().includes(c.fileName.toLowerCase().replace(".xlsx","").replace(".xlsm",""))||c.fileName.toLowerCase()===r.name.toLowerCase());if(!o){a++;continue}const i=F[o.parser];if(!i){a++;continue}try{const c=await r.arrayBuffer(),d=XLSX.read(c,{type:"array",cellDates:!0}),u=i.parse(d);h.appData[o.id]=u,l++}catch(c){console.error(`Error processing ${r.name}:`,c)}a++,await new Promise(c=>setTimeout(c,10))}n.textContent="Complete!",s.textContent=`${l} of ${e.length} sheets updated`,l>0&&(I(),L()),setTimeout(()=>{t.classList.remove("visible")},600)}let R=null;function Ae(e){R=e}function Fe(){Oe(),Xe(),_e(),Ue()}function Oe(){const e=Se();document.getElementById("statDailyOil").textContent=e.totalOil.toLocaleString(),document.getElementById("statDailyWater").textContent=e.totalWater.toLocaleString(),document.getElementById("statDailyGas").textContent=e.totalGas.toLocaleString()}function Xe(){const e=document.getElementById("topProducersBody"),t=Te(10);if(t.length===0){e.innerHTML='<tr><td colspan="5" class="dashboard-empty">No production data available</td></tr>';return}e.innerHTML=t.map((n,s)=>`
        <tr data-well-id="${n.wellId}" data-sheet-id="${n.sheetId}">
            <td>${s+1}</td>
            <td class="well-name-cell">${n.wellName}</td>
            <td class="battery-name-cell">${n.batteryName}</td>
            <td>${n.oil>0?n.oil:"-"}</td>
            <td>${n.water>0?n.water:"-"}</td>
        </tr>
    `).join(""),e.querySelectorAll("tr[data-well-id]").forEach(n=>{n.addEventListener("click",()=>{const s=n.dataset.wellId,a=n.dataset.sheetId;E(a,s)})})}function _e(){const e=document.getElementById("recentTestsBody"),t=Ee(10);if(t.length===0){e.innerHTML='<tr><td colspan="6" class="dashboard-empty">No test data available</td></tr>';return}e.innerHTML=t.map(n=>`
        <tr data-well-id="${n.wellId}" data-sheet-id="${n.sheetId}">
            <td>${T(n.date)}</td>
            <td class="well-name-cell">${n.wellName}</td>
            <td class="battery-name-cell">${n.batteryName}</td>
            <td>${n.oil!==null?n.oil:"-"}</td>
            <td>${n.water!==null?n.water:"-"}</td>
            <td>${n.gas!==null?n.gas:"-"}</td>
        </tr>
    `).join(""),e.querySelectorAll("tr[data-well-id]").forEach(n=>{n.addEventListener("click",()=>{const s=n.dataset.wellId,a=n.dataset.sheetId;E(a,s)})})}function Ue(){const e=document.getElementById("dashboardActionList"),t=xe(15);if(t.length===0){e.innerHTML='<li class="dashboard-empty" style="border-left-color: #6b7280; opacity: 0.7;">No action items</li>';return}e.innerHTML=t.map(n=>`
        <li data-well-id="${n.wellId}" data-sheet-id="${n.sheetId}">
            <div class="action-item-content">${n.content}</div>
            <div class="action-item-source">
                <span class="source-well">${n.wellName}</span> - ${n.batteryName}
            </div>
        </li>
    `).join(""),e.querySelectorAll("li[data-well-id]").forEach(n=>{n.style.cursor="pointer",n.addEventListener("click",()=>{const s=n.dataset.wellId,a=n.dataset.sheetId;E(a,s)})})}function qe(){const e=document.getElementById("btnReuploadAll"),t=document.getElementById("bulkFileInputDashboard"),n=document.getElementById("btnClearCache");e&&t&&(e.addEventListener("click",()=>{t.click()}),t.addEventListener("change",s=>{const a=Array.from(s.target.files);a.length>0&&We(a),t.value=""})),n&&n.addEventListener("click",()=>{confirm("Clear all cached data? You will need to re-upload your gauge sheets.")&&je()})}function je(){localStorage.removeItem($),h.appData={},R&&R()}function v(e){document.querySelectorAll(".view").forEach(s=>s.classList.remove("active"));const n={welcome:"welcomeView",gaugeSheet:"gaugeSheetView",well:"wellView",battery:"batteryView",oilChart:"oilChartView",waterChart:"waterChartView",gasChart:"gasChartView"}[e];n&&document.getElementById(n).classList.add("active")}function x(){const e=document.getElementById("welcomeUploadPrompt"),t=document.getElementById("operationsDashboard");Y()?(e.style.display="none",t.style.display="block",Fe()):(e.style.display="block",t.style.display="none")}function J(e){const t=S.find(l=>l.id===e);if(!t)return;h.currentSheet=e,v("gaugeSheet"),document.getElementById("sheetName").textContent=t.name,document.getElementById("sheetBreadcrumb").textContent=`Gauge Sheet: ${t.fileName}`,document.getElementById("expectedFileName").textContent=t.fileName;const n=h.appData[e],s=document.getElementById("uploadPrompt"),a=document.getElementById("uploadStatus");n&&n.wells?(s.style.display="none",a.style.display="flex",document.getElementById("lastUploadDate").textContent=T(n.lastUpdated),document.getElementById("rowCount").textContent=n.rawRowCount||"-"):(s.style.display="block",a.style.display="none"),ze(e)}function E(e,t){const n=h.appData[e];if(!n||!n.wells)return;const s=n.wells.find(l=>l.id===t);if(!s)return;h.currentSheet=e,h.currentWell=t,v("well");const a=S.find(l=>l.id===e);document.getElementById("wellName").textContent=s.name,document.getElementById("wellBreadcrumb").textContent=`${a.name} > ${s.name}`,A(s),Ge(s.wellTests||[]),Ve(s.chemicalProgram||{}),Ke(s.failureHistory||[]),Ye("wellActionList",s.actionItems||[]),Je(s.pressureReadings||[]),oe()}function ze(e){const t=document.getElementById("wellsGrid"),n=h.appData[e];if(!n||!n.wells||n.wells.length===0){t.innerHTML='<p class="empty-message">Upload gauge sheet to see wells</p>';return}const s=n.wells.filter(a=>a.status!=="inactive");if(s.length===0){t.innerHTML='<p class="empty-message">No active wells</p>';return}t.innerHTML=s.map(a=>{const l=a.wellTests&&a.wellTests[0],r=l?Math.round(l.oil*100)/100:null,o=l&&l.gas!==null?Math.round(Math.max(0,l.gas)*100)/100:null;return`
            <div class="well-card" data-well-id="${a.id}" data-sheet-id="${e}">
                <h4>${a.name}</h4>
                <div class="well-stats">
                    <div class="well-stat">
                        <span class="well-stat-label">Latest Oil</span>
                        <span class="well-stat-value">${r!==null?r+" bbl":"-"}</span>
                    </div>
                    <div class="well-stat">
                        <span class="well-stat-label">Latest Gas</span>
                        <span class="well-stat-value">${o!==null?o+" mcf":"-"}</span>
                    </div>
                </div>
            </div>
        `}).join(""),t.querySelectorAll(".well-card").forEach(a=>{a.addEventListener("click",()=>{const l=a.dataset.wellId,r=a.dataset.sheetId;E(r,l)})})}function Ge(e){const t=document.querySelector("#wellTestTable tbody"),n=new Date;if(n.setHours(23,59,59,999),!e||e.length===0){t.innerHTML='<tr><td colspan="4" style="text-align: center; color: #6b7280;">No test data</td></tr>';return}const s=e.filter(a=>new Date(a.date)<=n);if(s.length===0){t.innerHTML='<tr><td colspan="4" style="text-align: center; color: #6b7280;">No test data</td></tr>';return}t.innerHTML=s.map(a=>{const l=a.gas!==null?Math.round(Math.max(0,a.gas)*100)/100:null;return`
            <tr>
                <td>${T(a.date)}</td>
                <td>${a.oil!==null?Math.round(a.oil*100)/100:"-"}</td>
                <td>${a.water!==null?Math.round(a.water*100)/100:"-"}</td>
                <td>${l!==null?l:"-"}</td>
            </tr>
        `}).join("")}function Ve(e){const t=e.continuous||{},n=e.truckTreat||{};document.getElementById("chemContRate").textContent=t.rate||"-",document.getElementById("chemContChems").textContent=t.chems||"-",document.getElementById("chemContPPM").textContent=t.ppm||"-",document.getElementById("chemTruckRate").textContent=n.rate||"-",document.getElementById("chemTruckChems").textContent=n.chems||"-",document.getElementById("chemTruckPPM").textContent=n.ppm||"-"}function Ke(e){const t=document.querySelector("#failureTable tbody");if(!e||e.length===0){t.innerHTML='<tr><td colspan="6" style="text-align: center; color: #6b7280;">No failure history</td></tr>';return}t.innerHTML=e.map(n=>`
        <tr>
            <td>${T(n.dateDown)}</td>
            <td>${T(n.dateUp)}</td>
            <td>${n.downtime||"-"}</td>
            <td>${n.oil||"-"}</td>
            <td>${n.reason||"-"}</td>
            <td>${n.comments||"-"}</td>
        </tr>
    `).join("")}function Ye(e,t){const n=document.getElementById(e);if(!t||t.length===0){n.innerHTML='<li style="border-left-color: #6b7280; opacity: 0.7;">No action items</li>';return}n.innerHTML=t.map(s=>`<li>${s}</li>`).join("")}function Je(e){const t=document.querySelector("#pressureTable tbody");if(!e||e.length===0){t.innerHTML='<tr><td colspan="4" style="text-align: center; color: #6b7280;">No pressure data</td></tr>';return}t.innerHTML=e.map(n=>`
        <tr>
            <td>${T(n.date)}</td>
            <td>${n.casingPsi||"-"}</td>
            <td>${n.tubingPsi||"-"}</td>
            <td>${n.flowlinePsi||"-"}</td>
        </tr>
    `).join("")}function O(e=null,t=null){v("oilChart"),U("oil",e,t)}function X(e=null,t=null){v("waterChart"),U("water",e,t)}function _(e=null,t=null){v("gasChart"),U("gas",e,t)}function U(e,t=null,n=null){var p;const a={oil:{canvasId:"aggregateOilChart",label:"Oil Production (BBL)",unit:"BBL",color:"#78716c",dateRangeVar:"oilChartDateRange",startDateId:"oilChartStartDate",endDateId:"oilChartEndDate",resetBtnId:"btnResetOilDates",showFn:O},water:{canvasId:"aggregateWaterChart",label:"Water Consumption (BBL)",unit:"BBL",color:"#3b82f6",dateRangeVar:"waterChartDateRange",startDateId:"waterChartStartDate",endDateId:"waterChartEndDate",resetBtnId:"btnResetWaterDates",showFn:X},gas:{canvasId:"aggregateGasChart",label:"Gas Production (MCF)",unit:"MCF",color:"#22c55e",dateRangeVar:"gasChartDateRange",startDateId:"gasChartStartDate",endDateId:"gasChartEndDate",resetBtnId:"btnResetGasDates",showFn:_}}[e];if(!a)return;e==="oil"&&h.aggregateOilChart?(h.aggregateOilChart.destroy(),h.aggregateOilChart=null):e==="water"&&h.aggregateWaterChart?(h.aggregateWaterChart.destroy(),h.aggregateWaterChart=null):e==="gas"&&h.aggregateGasChart&&(h.aggregateGasChart.destroy(),h.aggregateGasChart=null);const l=Qe(e),r=((p=h.chartState[e])==null?void 0:p.aggregation)||"month";h.chartState[e].selectedWells=l;const{data:o,dateRange:i}=ve(e,t,n,r,l);e==="oil"?h.oilChartDateRange=i:e==="water"?h.waterChartDateRange=i:e==="gas"&&(h.gasChartDateRange=i),Ze(e,a,t,n,i);const c={oil:"oilChartBatteries",water:"waterChartBatteries",gas:"gasChartBatteries"},d=document.getElementById(c[e]);d&&!d.querySelector(".explorer-battery")&&tt(e),et(e);const u=document.getElementById(a.canvasId);if(!u)return;if(o.length===0){const f=u.getContext("2d");f.clearRect(0,0,u.width,u.height),f.font="14px Archivo, sans-serif",f.fillStyle="#6b7280",f.textAlign="center",f.fillText("No production data available",u.width/2,u.height/2);return}const m=u.getContext("2d"),g=new Chart(m,{type:"line",data:{datasets:[{label:a.label,data:o,backgroundColor:a.color+"33",borderColor:a.color,borderWidth:2,fill:!0,tension:.1,pointRadius:2,pointHoverRadius:5}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:"#282c33",titleColor:"#e8e9eb",bodyColor:"#e8e9eb",callbacks:{title:f=>new Date(f[0].parsed.x).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),label:f=>`${a.label}: ${f.parsed.y.toLocaleString()}`}}},scales:{x:{type:"time",time:{displayFormats:{day:"MMM-yy",week:"MMM-yy",month:"MMM-yy",quarter:"MMM-yy",year:"yyyy"}},grid:{color:"#3a3f47"},ticks:{color:"#9ea3ab",maxTicksLimit:12}},y:{beginAtZero:!0,title:{display:!0,text:a.unit,color:"#9ea3ab"},grid:{color:"#3a3f47"},ticks:{color:"#9ea3ab"}}}}});e==="oil"?h.aggregateOilChart=g:e==="water"?h.aggregateWaterChart=g:e==="gas"&&(h.aggregateGasChart=g)}function Ze(e,t,n,s,a){const l=document.getElementById(t.startDateId),r=document.getElementById(t.endDateId),o=document.getElementById(t.resetBtnId);if(!l||!r||!a.min||!a.max)return;const i=f=>f?new Date(f).toISOString().split("T")[0]:"",c=i(a.min),d=i(a.max);l.min=c,l.max=d,r.min=c,r.max=d,l.value=n?i(n):c,r.value=s?i(s):d;const u=l.cloneNode(!0),m=r.cloneNode(!0),g=o.cloneNode(!0);l.parentNode.replaceChild(u,l),r.parentNode.replaceChild(m,r),o.parentNode.replaceChild(g,o);const p=()=>{const f=u.value?new Date(u.value):null,w=m.value?new Date(m.value+"T23:59:59"):null;t.showFn(f,w)};u.addEventListener("change",p),m.addEventListener("change",p),g.addEventListener("click",()=>t.showFn(null,null))}function Qe(e){const t={oil:"oilChartBatteries",water:"waterChartBatteries",gas:"gasChartBatteries"},n=document.getElementById(t[e]);if(!n)return null;const s=new Set;return n.querySelectorAll(".well-checkbox:checked").forEach(a=>{a.dataset.well&&s.add(a.dataset.well)}),s.size>0?s:null}function N(e){const n={oil:{startDateId:"oilChartStartDate",endDateId:"oilChartEndDate",showFn:O},water:{startDateId:"waterChartStartDate",endDateId:"waterChartEndDate",showFn:X},gas:{startDateId:"gasChartStartDate",endDateId:"gasChartEndDate",showFn:_}}[e];if(!n)return;const s=document.getElementById(n.startDateId),a=document.getElementById(n.endDateId),l=s&&s.value?new Date(s.value):null,r=a&&a.value?new Date(a.value+"T23:59:59"):null;n.showFn(l,r)}function et(e){var s;const t=document.querySelectorAll(`input[name="${e}Aggregation"]`);if(!t.length)return;t.forEach(a=>{const l=a.cloneNode(!0);a.parentNode.replaceChild(l,a)});const n=((s=h.chartState[e])==null?void 0:s.aggregation)||"month";document.querySelectorAll(`input[name="${e}Aggregation"]`).forEach(a=>{a.checked=a.value===n,a.addEventListener("change",l=>{h.chartState[e].aggregation=l.target.value,N(e)})})}function tt(e){var i;const t={oil:"oilChartBatteries",water:"waterChartBatteries",gas:"gasChartBatteries"},n=document.getElementById(t[e]);if(!n)return;if(n.innerHTML="",!Y()){n.innerHTML='<div class="explorer-empty">No data uploaded</div>';return}const s=()=>{const c={oil:"btnToggleAllOil",water:"btnToggleAllWater",gas:"btnToggleAllGas"},d=document.getElementById(c[e]);if(!d)return;const u=n.querySelectorAll(".well-checkbox");if(!u.length)return;const m=Array.from(u).every(g=>g.checked);d.textContent=m?"Deselect All":"Select All"},a=c=>{const d=c.querySelector(".battery-checkbox"),u=c.querySelectorAll(".well-checkbox"),m=c.querySelectorAll(".well-checkbox:checked").length;!d||!u.length||(d.checked=m===u.length,d.indeterminate=m>0&&m<u.length)},l=((i=h.chartState[e])==null?void 0:i.selectedWells)||null;S.forEach(c=>{const d=h.appData[c.id];if(!d||!d.wells||d.wells.length===0)return;const u=d.wells.filter(w=>w.status!=="inactive");if(u.length===0)return;const m=document.createElement("div");m.className="explorer-battery";const g=document.createElement("div");g.className="explorer-battery-header",g.innerHTML=`
            <label class="explorer-checkbox">
                <input type="checkbox" class="battery-checkbox" data-battery="${c.id}">
                <span class="checkmark"></span>
            </label>
            <span class="battery-name">${c.name}</span>
            <span class="battery-count">${u.length}</span>
        `;const p=document.createElement("div");p.className="explorer-wells",p.id=`wells-${e}-${c.id}`,u.forEach(w=>{const C=!l||l.has(w.id),y=document.createElement("label");y.className="explorer-well explorer-checkbox",y.innerHTML=`
                <input type="checkbox" class="well-checkbox" data-battery="${c.id}" data-well="${w.id}" ${C?"checked":""}>
                <span class="checkmark"></span>
                <span class="well-name">${w.name}</span>
            `,p.appendChild(y)}),m.appendChild(g),m.appendChild(p),n.appendChild(m),g.addEventListener("click",w=>{w.target.closest('input[type="checkbox"]')||w.target.closest(".explorer-checkbox")||p.classList.toggle("expanded")});const f=g.querySelector(".battery-checkbox");a(m),f.addEventListener("change",()=>{const w=f.checked;p.querySelectorAll(".well-checkbox").forEach(C=>{C.checked=w}),f.indeterminate=!1,N(e),s()}),p.querySelectorAll(".well-checkbox").forEach(w=>{w.addEventListener("change",()=>{a(m),N(e),s()})})});const r={oil:"btnToggleAllOil",water:"btnToggleAllWater",gas:"btnToggleAllGas"},o=document.getElementById(r[e]);if(o){const c=o.cloneNode(!0);o.parentNode.replaceChild(c,o),c.addEventListener("click",()=>{const d=n.querySelectorAll(".well-checkbox"),u=Array.from(d).every(m=>m.checked);d.forEach(m=>{m.checked=!u}),n.querySelectorAll(".explorer-battery").forEach(m=>{a(m)}),c.textContent=u?"Select All":"Deselect All",N(e)}),s()}}function nt(){const e=document.getElementById("logoLink");e&&e.addEventListener("click",t=>{t.preventDefault(),document.querySelectorAll(".nav-item").forEach(s=>s.classList.remove("active")),h.currentSheet=null,h.currentWell=null,v("welcome"),x();const n=document.getElementById("nav-dashboard");n&&B(n)})}function at(){const e=document.getElementById("hamburgerBtn"),t=document.getElementById("sidebar");e&&t&&(e.addEventListener("click",()=>{t.classList.toggle("collapsed");const s=t.classList.contains("collapsed");localStorage.setItem("sidebarCollapsed",s?"true":"false")}),localStorage.getItem("sidebarCollapsed")==="true"&&t.classList.add("collapsed"))}function Z(){const e=document.getElementById("navTree");e.innerHTML="";const t=st("Home","home-section",[{id:"nav-dashboard",label:"Operations Dashboard",icon:"dashboard",action:()=>{v("welcome"),x()}},{id:"nav-oil-chart",label:"Oil Production",icon:"oil",action:()=>O()},{id:"nav-water-chart",label:"Water Consumption",icon:"water",action:()=>X()},{id:"nav-gas-chart",label:"Gas Production",icon:"gas",action:()=>_()}]);e.appendChild(t);const n=rt();e.appendChild(n)}function st(e,t,n){const s=document.createElement("div");s.className="nav-section",s.id=t;const a=document.createElement("div");a.className="nav-section-header expanded",a.innerHTML=`
        <span class="nav-section-title">${e}</span>
        <span class="nav-section-chevron">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
        </span>
    `;const l=document.createElement("div");return l.className="nav-section-children visible",n.forEach(r=>{const o=lt(r);l.appendChild(o)}),a.addEventListener("click",()=>{a.classList.toggle("expanded"),l.classList.toggle("visible")}),s.appendChild(a),s.appendChild(l),s}function lt(e){const t=document.createElement("div");t.className="nav-section-item";const n={dashboard:`<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="7" height="7"></rect>
            <rect x="14" y="3" width="7" height="7"></rect>
            <rect x="14" y="14" width="7" height="7"></rect>
            <rect x="3" y="14" width="7" height="7"></rect>
           </svg>`,oil:`<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#78716c" stroke-width="2">
            <path d="M12 2C12 2 4 10 4 15a8 8 0 0 0 16 0c0-5-8-13-8-13z"></path>
           </svg>`,water:`<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#3b82f6" stroke-width="2">
            <path d="M12 2C12 2 4 10 4 15a8 8 0 0 0 16 0c0-5-8-13-8-13z"></path>
           </svg>`,gas:`<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#22c55e" stroke-width="2">
            <path d="M12 2v6m0 4v10M5 12h14M8 6h8M6 18h12"></path>
           </svg>`,chart:`<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
           </svg>`},s=n[e.icon]||n.chart;t.innerHTML=`
        <div class="nav-item" id="${e.id}" data-tooltip="${e.label}">
            <span class="nav-item-icon">${s}</span>
            <span class="nav-item-label">${e.label}</span>
        </div>
    `;const a=t.querySelector(".nav-item");return a.addEventListener("click",l=>{l.stopPropagation(),B(a),e.action()}),t}function rt(){const e=document.createElement("div");e.className="nav-section",e.id="wells-section";const t=document.createElement("div");t.className="nav-section-header expanded",t.innerHTML=`
        <span class="nav-section-title">Wells</span>
        <span class="nav-section-chevron">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
        </span>
    `;const n=document.createElement("div");return n.className="nav-section-children visible",S.forEach(s=>{const a=ot(s);n.appendChild(a)}),t.addEventListener("click",()=>{t.classList.toggle("expanded"),n.classList.toggle("visible")}),e.appendChild(t),e.appendChild(n),e}function ot(e){const t=document.createElement("div");t.className="nav-gauge-sheet";const n=h.appData[e.id]&&h.appData[e.id].wells,s=n?h.appData[e.id].wells.filter(o=>o.status!=="inactive"):[],a=s.length;t.innerHTML=`
        <div class="nav-item" data-sheet-id="${e.id}">
            <span class="icon">&#9632;</span>
            <span class="nav-battery-name">${e.name}</span>
            <span class="upload-indicator ${n?"uploaded":"not-uploaded"}">
                ${n?a+" wells":"No data"}
            </span>
        </div>
        <div class="nav-children" id="sheet-children-${e.id}"></div>
    `;const l=t.querySelector(".nav-item"),r=t.querySelector(".nav-children");return l.addEventListener("click",o=>{o.stopPropagation(),B(l),J(e.id),n&&s.length>0&&(l.classList.toggle("expanded"),r.classList.toggle("visible"))}),n&&s.forEach(o=>{const i=it(o,e);r.appendChild(i)}),t}function it(e,t){const n=document.createElement("div");n.className="nav-well",n.innerHTML=`
        <div class="nav-item" data-well-id="${e.id}" data-sheet-id="${t.id}">
            <span class="status-dot active"></span>
            <span class="nav-well-name">${e.name}</span>
        </div>
    `;const s=n.querySelector(".nav-item");return s.addEventListener("click",a=>{a.stopPropagation(),B(s),E(t.id,e.id)}),n}function B(e){document.querySelectorAll(".nav-item").forEach(t=>t.classList.remove("active")),e.classList.add("active")}function L(){Z(),x()}document.addEventListener("DOMContentLoaded",()=>{ee(),ae(),Z(),Re(),$e(),qe(),nt(),at(),te(),x(),v("welcome")});re((e,t)=>{E(e,t)});Ae(()=>{L(),x()});
