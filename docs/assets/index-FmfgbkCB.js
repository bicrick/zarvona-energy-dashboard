(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))l(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&l(r)}).observe(document,{childList:!0,subtree:!0});function a(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(n){if(n.ep)return;n.ep=!0;const s=a(n);fetch(n.href,s)}})();const C=[{id:"cowden",name:"Cowden",fileName:"Cowden Gauge Sheet1.xlsx",parser:"CowdenParser"},{id:"bigmax",name:"Big Max",fileName:"Big Max Gauge Sheet.xlsx",parser:"BigMaxParser"},{id:"bigmax1h",name:"Big Max 1H",fileName:"Big Max 1H Gauge Sheet.xlsx",parser:"BigMax1HParser"},{id:"southandrews",name:"South Andrews",fileName:"South Andrews Gauge Sheet.xlsm",parser:"SouthAndrewsParser"},{id:"polaris",name:"Polaris",fileName:"Polaris Gauge Sheet.xlsx",parser:"PolarisParser"},{id:"shusa",name:"Shusa",fileName:"Shusa Gauge Sheet.xlsx",parser:"ShusaParser"},{id:"mwwemac",name:"MW-Wemac-Sabrina-Berkley",fileName:"Mw-Wemac-Sabrina-Berkley.xlsx",parser:"MWWemacParser"},{id:"unit130",name:"1-30 Unit 1H",fileName:"1-30 Unit 1H Gauge Sheet.xlsx",parser:"Unit130Parser"},{id:"uls35h",name:"ULS 3-5H",fileName:"ULS 3-5H Gauge Sheet.xlsx",parser:"ULS35HParser"}],W="oilWellData",R="oilWellTheme",h={appData:{},currentSheet:null,currentWell:null,wellProductionCharts:{},batteryProductionChart:null,currentWellData:null,productionDateRange:{min:null,max:null},chartState:{oil:{aggregation:"month",selectedWells:null},water:{aggregation:"month",selectedWells:null},gas:{aggregation:"month",selectedWells:null}},aggregateOilChart:null,aggregateWaterChart:null,aggregateGasChart:null,oilChartDateRange:{min:null,max:null},waterChartDateRange:{min:null,max:null},gasChartDateRange:{min:null,max:null},pressureCharts:{psi:null,injVol:null},currentEditSection:null};function ae(){const e=localStorage.getItem(R);e?document.documentElement.setAttribute("data-theme",e):G(),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{localStorage.getItem(R)||G()}),A()}function G(){const e=window.matchMedia("(prefers-color-scheme: dark)").matches;document.documentElement.setAttribute("data-theme",e?"dark":"light"),A()}function se(){const e=document.getElementById("themeToggle");e&&e.addEventListener("click",le)}function le(){const t=(document.documentElement.getAttribute("data-theme")||"dark")==="dark"?"light":"dark";document.documentElement.setAttribute("data-theme",t),localStorage.setItem(R,t),A()}function A(){const e=document.querySelector(".theme-toggle-label");if(e){const t=document.documentElement.getAttribute("data-theme")||"dark";e.textContent=t==="dark"?"Light Mode":"Dark Mode"}}function re(){try{const e=localStorage.getItem(W);e&&(h.appData=JSON.parse(e),Object.values(h.appData).forEach(t=>{t.wells&&t.wells.forEach(a=>{a.production&&(a.production=a.production.map(l=>({...l,date:new Date(l.date)}))),a.wellTests&&(a.wellTests=a.wellTests.map(l=>({...l,date:new Date(l.date)})))})}))}catch(e){console.error("Error loading from storage:",e),h.appData={}}}function P(){try{localStorage.setItem(W,JSON.stringify(h.appData))}catch(e){console.error("Error saving to storage:",e),alert("Error saving data. Storage may be full.")}}function v(e){if(!e)return"-";try{const t=new Date(e);return isNaN(t.getTime())?e:t.toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit"})}catch{return e}}function M(e){if(!e)return"";try{const t=new Date(e);return isNaN(t.getTime())?"":t.toISOString().split("T")[0]}catch{return""}}function Q(e){if(!e)return"";const t=document.createElement("div");return t.textContent=e,t.innerHTML}function _(e,t=null,a=null){const l=document.getElementById("productionChartsWrapper");h.currentWellData=e,Object.values(h.wellProductionCharts).forEach(d=>{d&&d.destroy()}),h.wellProductionCharts={},l.innerHTML="";const n=e.production||[],s=e.wellTests||[],r=n.filter(d=>d.date).map(d=>new Date(d.date)).filter(d=>!isNaN(d.getTime()));r.length>0&&(h.productionDateRange.min=new Date(Math.min(...r)),h.productionDateRange.max=new Date(Math.max(...r)),oe(t,a));const i=[{key:"oil",label:"Oil (BBL)",unit:"BBL",color:"#78716c",dataKey:"oil",source:"production"},{key:"water",label:"Water (BBL)",unit:"BBL",color:"#3b82f6",dataKey:"water",source:"production"},{key:"gas",label:"Gas (MCF)",unit:"MCF",color:"#22c55e",dataKey:"gas",source:"production"}].filter(d=>(d.source==="production"?n:s).some(u=>u[d.dataKey]!==null&&u[d.dataKey]!==void 0&&!isNaN(u[d.dataKey])));if(i.length===0){l.innerHTML='<div class="chart-placeholder">No production data available</div>';return}i.forEach(d=>{const c=document.createElement("div");c.className="chart-section",c.innerHTML=`
            <div class="chart-label">${d.label}</div>
            <div class="canvas-wrapper">
                <canvas id="chart-${d.key}"></canvas>
            </div>
        `,l.appendChild(c);let p=(d.source==="production"?n:s).filter(g=>g.date&&g[d.dataKey]!==null&&g[d.dataKey]!==void 0).map(g=>({x:new Date(g.date),y:Number(g[d.dataKey])})).filter(g=>!isNaN(g.y)).sort((g,m)=>g.x-m.x);(t||a)&&(p=p.filter(g=>{const m=g.x.getTime();return!(t&&m<t.getTime()||a&&m>a.getTime())}));const f=document.getElementById(`chart-${d.key}`).getContext("2d");h.wellProductionCharts[d.key]=new Chart(f,{type:"scatter",data:{datasets:[{label:d.label,data:p,backgroundColor:d.color,borderColor:d.color,pointRadius:3,pointHoverRadius:5}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:"#282c33",titleColor:"#e8e9eb",bodyColor:"#e8e9eb",callbacks:{title:g=>new Date(g[0].parsed.x).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),label:g=>`${d.label}: ${g.parsed.y}`}}},scales:{x:{type:"time",time:{displayFormats:{day:"MMM-yy",week:"MMM-yy",month:"MMM-yy",quarter:"MMM-yy",year:"yyyy"}},grid:{color:"#3a3f47"},ticks:{color:"#9ea3ab",maxTicksLimit:8}},y:{beginAtZero:!0,title:{display:!0,text:d.unit,color:"#9ea3ab"},grid:{color:"#3a3f47"},ticks:{color:"#9ea3ab"}}}}})})}function oe(e=null,t=null){const a=document.getElementById("productionStartDate"),l=document.getElementById("productionEndDate"),n=document.getElementById("btnResetDates");if(!a||!l||!h.productionDateRange.min||!h.productionDateRange.max)return;const s=u=>u?new Date(u).toISOString().split("T")[0]:"",r=s(h.productionDateRange.min),o=s(h.productionDateRange.max);a.min=r,a.max=o,l.min=r,l.max=o,a.value=e?s(e):r,l.value=t?s(t):o;const i=a.cloneNode(!0),d=l.cloneNode(!0),c=n.cloneNode(!0);a.parentNode.replaceChild(i,a),l.parentNode.replaceChild(d,l),n.parentNode.replaceChild(c,n),i.addEventListener("change",z),d.addEventListener("change",z),c.addEventListener("click",ie)}function z(){if(!h.currentWellData)return;const e=document.getElementById("productionStartDate"),t=document.getElementById("productionEndDate"),a=e.value?new Date(e.value):null,l=t.value?new Date(t.value+"T23:59:59"):null;_(h.currentWellData,a,l)}function ie(){h.currentWellData&&_(h.currentWellData,null,null)}let H=null;function de(e){H=e}function ce(){document.querySelectorAll(".btn-edit[data-edit]").forEach(s=>{const r=s.cloneNode(!0);s.parentNode.replaceChild(r,s),r.addEventListener("click",o=>{o.stopPropagation();const i=r.dataset.edit;ue(i)})});const t=document.getElementById("btnCloseModal"),a=document.getElementById("btnCancelEdit"),l=document.getElementById("editModalOverlay"),n=document.getElementById("btnSaveEdit");if(t){const s=t.cloneNode(!0);t.parentNode.replaceChild(s,t),s.addEventListener("click",N)}if(a){const s=a.cloneNode(!0);a.parentNode.replaceChild(s,a),s.addEventListener("click",N)}if(l){const s=l.cloneNode(!0);l.parentNode.replaceChild(s,l),s.addEventListener("click",N)}if(n){const s=n.cloneNode(!0);n.parentNode.replaceChild(s,n),s.addEventListener("click",ye)}}function ue(e){if(!h.currentSheet||!h.currentWell)return;const t=h.appData[h.currentSheet];if(!t||!t.wells)return;const a=t.wells.find(o=>o.id===h.currentWell);if(!a)return;h.currentEditSection=e;const l=document.getElementById("editModal"),n=document.getElementById("editModalTitle"),s=document.getElementById("editModalBody"),r={chemicalProgram:"Edit Chemical Program",failureHistory:"Edit Failure History",actionItems:"Edit Action Items",pressureReadings:"Edit Pressure Readings"};switch(n.textContent=r[e]||"Edit",e){case"chemicalProgram":s.innerHTML=he(a.chemicalProgram||{});break;case"failureHistory":s.innerHTML=pe(a.failureHistory||[]),me();break;case"actionItems":s.innerHTML=ge(a.actionItems||[]),fe();break;case"pressureReadings":s.innerHTML=we(a.pressureReadings||[]),Ce();break}l.classList.add("visible")}function N(){document.getElementById("editModal").classList.remove("visible"),h.currentEditSection=null}function he(e){const t=e.continuous||{},a=e.truckTreat||{};return`
        <div class="chemical-form-grid">
            <div class="form-column-header"></div>
            <div class="form-column-header">Continuous</div>
            <div class="form-column-header">Truck Treat</div>

            <div class="form-row-label">Rate (gal/month)</div>
            <input type="text" class="edit-form-input" id="editChemContRate" value="${t.rate||""}" placeholder="-">
            <input type="text" class="edit-form-input" id="editChemTruckRate" value="${a.rate||""}" placeholder="-">

            <div class="form-row-label">Chems Used</div>
            <input type="text" class="edit-form-input" id="editChemContChems" value="${t.chems||""}" placeholder="-">
            <input type="text" class="edit-form-input" id="editChemTruckChems" value="${a.chems||""}" placeholder="-">

            <div class="form-row-label">PPM</div>
            <input type="text" class="edit-form-input" id="editChemContPPM" value="${t.ppm||""}" placeholder="-">
            <input type="text" class="edit-form-input" id="editChemTruckPPM" value="${a.ppm||""}" placeholder="-">
        </div>
    `}function pe(e){let t="";return e.length>0&&(t=e.map((a,l)=>`
            <tr data-row-index="${l}">
                <td><input type="date" class="edit-table-input" name="dateDown" value="${M(a.dateDown)}"></td>
                <td><input type="date" class="edit-table-input" name="dateUp" value="${M(a.dateUp)}"></td>
                <td><input type="number" class="edit-table-input" name="downtime" value="${a.downtime||""}" placeholder="-"></td>
                <td><input type="number" class="edit-table-input" name="oil" value="${a.oil||""}" placeholder="-"></td>
                <td><input type="text" class="edit-table-input" name="reason" value="${a.reason||""}" placeholder="-"></td>
                <td><input type="text" class="edit-table-input" name="comments" value="${a.comments||""}" placeholder="-"></td>
                <td>
                    <button type="button" class="btn-delete-row" title="Delete row">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </td>
            </tr>
        `).join("")),`
        <div class="edit-table-container">
            <table class="edit-table" id="failureEditTable">
                <thead>
                    <tr>
                        <th>Date Down</th>
                        <th>Date Up</th>
                        <th>Downtime (days)</th>
                        <th>Oil Lost</th>
                        <th>Reason</th>
                        <th>Comments</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody id="failureEditBody">
                    ${t}
                </tbody>
            </table>
        </div>
        <button type="button" class="btn-add-row" id="btnAddFailureRow">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
            Add Entry
        </button>
    `}function me(){const e=document.getElementById("btnAddFailureRow"),t=document.getElementById("failureEditBody");e&&e.addEventListener("click",()=>{const a=document.createElement("tr");a.innerHTML=`
                <td><input type="date" class="edit-table-input" name="dateDown"></td>
                <td><input type="date" class="edit-table-input" name="dateUp"></td>
                <td><input type="number" class="edit-table-input" name="downtime" placeholder="-"></td>
                <td><input type="number" class="edit-table-input" name="oil" placeholder="-"></td>
                <td><input type="text" class="edit-table-input" name="reason" placeholder="-"></td>
                <td><input type="text" class="edit-table-input" name="comments" placeholder="-"></td>
                <td>
                    <button type="button" class="btn-delete-row" title="Delete row">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </td>
            `,t.appendChild(a),E(a.querySelector(".btn-delete-row"))}),t.querySelectorAll(".btn-delete-row").forEach(a=>{E(a)})}function ge(e){let t="";return e.length>0?t=e.map((a,l)=>`
            <div class="action-item-row" data-item-index="${l}">
                <input type="text" class="edit-form-input" name="actionItem" value="${Q(a)}">
                <button type="button" class="btn-delete-item" title="Delete item">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
        `).join(""):t='<div class="action-items-empty">No action items. Add one below.</div>',`
        <div class="action-items-editor" id="actionItemsEditor">
            ${t}
        </div>
        <div class="action-items-add-row">
            <input type="text" class="edit-form-input" id="newActionItem" placeholder="Enter new action item...">
            <button type="button" class="btn-add-item" id="btnAddActionItem">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="12" y1="5" x2="12" y2="19"></line>
                    <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
                Add
            </button>
        </div>
    `}function fe(){const e=document.getElementById("btnAddActionItem"),t=document.getElementById("newActionItem"),a=document.getElementById("actionItemsEditor"),l=()=>{const n=t.value.trim();if(!n)return;const s=a.querySelector(".action-items-empty");s&&s.remove();const r=document.createElement("div");r.className="action-item-row",r.innerHTML=`
            <input type="text" class="edit-form-input" name="actionItem" value="${Q(n)}">
            <button type="button" class="btn-delete-item" title="Delete item">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        `,a.appendChild(r),K(r.querySelector(".btn-delete-item")),t.value="",t.focus()};e&&e.addEventListener("click",l),t&&t.addEventListener("keypress",n=>{n.key==="Enter"&&(n.preventDefault(),l())}),a.querySelectorAll(".btn-delete-item").forEach(n=>{K(n)})}function K(e){e.addEventListener("click",()=>{e.closest(".action-item-row").remove();const a=document.getElementById("actionItemsEditor");a.querySelectorAll(".action-item-row").length===0&&(a.innerHTML='<div class="action-items-empty">No action items. Add one below.</div>')})}function we(e){let t="";return e.length>0&&(t=e.map((a,l)=>`
            <tr data-row-index="${l}">
                <td><input type="date" class="edit-table-input" name="date" value="${M(a.date)}"></td>
                <td><input type="number" class="edit-table-input" name="casingPsi" value="${a.casingPsi||""}" placeholder="-"></td>
                <td><input type="number" class="edit-table-input" name="tubingPsi" value="${a.tubingPsi||""}" placeholder="-"></td>
                <td><input type="number" class="edit-table-input" name="flowlinePsi" value="${a.flowlinePsi||""}" placeholder="-"></td>
                <td><input type="number" class="edit-table-input" name="injVol" value="${a.injVol||""}" placeholder="-"></td>
                <td>
                    <button type="button" class="btn-delete-row" title="Delete row">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </td>
            </tr>
        `).join("")),`
        <div class="edit-table-container">
            <table class="edit-table" id="pressureEditTable">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Casing PSI</th>
                        <th>Tubing PSI</th>
                        <th>Flowline PSI</th>
                        <th>Inj Vol</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody id="pressureEditBody">
                    ${t}
                </tbody>
            </table>
        </div>
        <button type="button" class="btn-add-row" id="btnAddPressureRow">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
            Add Entry
        </button>
    `}function Ce(){const e=document.getElementById("btnAddPressureRow"),t=document.getElementById("pressureEditBody");e&&e.addEventListener("click",()=>{const a=document.createElement("tr");a.innerHTML=`
                <td><input type="date" class="edit-table-input" name="date"></td>
                <td><input type="number" class="edit-table-input" name="casingPsi" placeholder="-"></td>
                <td><input type="number" class="edit-table-input" name="tubingPsi" placeholder="-"></td>
                <td><input type="number" class="edit-table-input" name="flowlinePsi" placeholder="-"></td>
                <td><input type="number" class="edit-table-input" name="injVol" placeholder="-"></td>
                <td>
                    <button type="button" class="btn-delete-row" title="Delete row">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </td>
            `,t.appendChild(a),E(a.querySelector(".btn-delete-row"))}),t.querySelectorAll(".btn-delete-row").forEach(a=>{E(a)})}function E(e){e.addEventListener("click",()=>{e.closest("tr").remove()})}function ye(){if(!h.currentSheet||!h.currentWell||!h.currentEditSection)return;const e=h.appData[h.currentSheet];if(!e||!e.wells)return;const t=e.wells.findIndex(l=>l.id===h.currentWell);if(t===-1)return;const a=e.wells[t];switch(h.currentEditSection){case"chemicalProgram":a.chemicalProgram=be();break;case"failureHistory":a.failureHistory=Se();break;case"actionItems":a.actionItems=ve();break;case"pressureReadings":a.pressureReadings=De();break}P(),N(),H&&H(h.currentSheet,h.currentWell)}function be(){var e,t,a,l,n,s;return{continuous:{rate:((e=document.getElementById("editChemContRate"))==null?void 0:e.value)||"",chems:((t=document.getElementById("editChemContChems"))==null?void 0:t.value)||"",ppm:((a=document.getElementById("editChemContPPM"))==null?void 0:a.value)||""},truckTreat:{rate:((l=document.getElementById("editChemTruckRate"))==null?void 0:l.value)||"",chems:((n=document.getElementById("editChemTruckChems"))==null?void 0:n.value)||"",ppm:((s=document.getElementById("editChemTruckPPM"))==null?void 0:s.value)||""}}}function Se(){const t=document.getElementById("failureEditBody").querySelectorAll("tr"),a=[];return t.forEach(l=>{var c,u,p,f,g,m;const n=(c=l.querySelector('input[name="dateDown"]'))==null?void 0:c.value,s=(u=l.querySelector('input[name="dateUp"]'))==null?void 0:u.value,r=(p=l.querySelector('input[name="downtime"]'))==null?void 0:p.value,o=(f=l.querySelector('input[name="oil"]'))==null?void 0:f.value,i=(g=l.querySelector('input[name="reason"]'))==null?void 0:g.value,d=(m=l.querySelector('input[name="comments"]'))==null?void 0:m.value;(n||s||r||o||i||d)&&a.push({dateDown:n||null,dateUp:s||null,downtime:r?Number(r):null,oil:o?Number(o):null,reason:i||"",comments:d||""})}),a}function ve(){const t=document.getElementById("actionItemsEditor").querySelectorAll('input[name="actionItem"]'),a=[];return t.forEach(l=>{const n=l.value.trim();n&&a.push(n)}),a}function De(){const t=document.getElementById("pressureEditBody").querySelectorAll("tr"),a=[];return t.forEach(l=>{var d,c,u,p,f;const n=(d=l.querySelector('input[name="date"]'))==null?void 0:d.value,s=(c=l.querySelector('input[name="casingPsi"]'))==null?void 0:c.value,r=(u=l.querySelector('input[name="tubingPsi"]'))==null?void 0:u.value,o=(p=l.querySelector('input[name="flowlinePsi"]'))==null?void 0:p.value,i=(f=l.querySelector('input[name="injVol"]'))==null?void 0:f.value;(n||s||r||o||i)&&a.push({date:n||null,casingPsi:s?Number(s):null,tubingPsi:r?Number(r):null,flowlinePsi:o?Number(o):null,injVol:i?Number(i):null})}),a}function Te(){let e=0,t=0,a=0;const l=new Date;return l.setHours(23,59,59,999),Object.keys(h.appData).forEach(n=>{const s=h.appData[n];if(s)if(s.batteryProduction&&s.batteryProduction.length>0){const r=s.batteryProduction.filter(o=>new Date(o.date)<=l);if(r.length>0){r.sort((i,d)=>new Date(d.date)-new Date(i.date));const o=r[0];o.oil!==null&&!isNaN(o.oil)&&(e+=Number(o.oil)),o.water!==null&&!isNaN(o.water)&&(t+=Number(o.water)),o.gas!==null&&!isNaN(o.gas)&&(a+=Math.max(0,Number(o.gas)))}}else s.wells&&s.wells.length>0&&s.wells.forEach(r=>{if(r.status!=="inactive"&&r.wellTests&&r.wellTests.length>0){const o=r.wellTests.filter(i=>new Date(i.date)<=l);if(o.length>0){const i=o[0];i.oil!==null&&!isNaN(i.oil)&&(e+=Number(i.oil)),i.water!==null&&!isNaN(i.water)&&(t+=Number(i.water)),i.gas!==null&&!isNaN(i.gas)&&(a+=Math.max(0,Number(i.gas)))}}})}),{totalOil:Math.round(e*100)/100,totalWater:Math.round(t*100)/100,totalGas:Math.round(a*100)/100}}function xe(e="oil",t=null,a=null,l="month",n=null){const s=new Map;let r=null,o=null;const i=new Date;i.setHours(23,59,59,999);const d=u=>{const p=new Date(u);if(l==="week"){const f=p.getUTCDay(),g=f===0?-6:1-f;p.setUTCDate(p.getUTCDate()+g)}else l==="month"&&p.setUTCDate(1);return p.setUTCHours(0,0,0,0),p};Object.keys(h.appData).forEach(u=>{const p=h.appData[u];if(!p||n&&!n.has(u))return;(p.batteryProduction||[]).forEach(g=>{if(!g.date)return;const m=new Date(g.date);if(isNaN(m.getTime())||m>i)return;let w=g[e];if(w==null||isNaN(w))return;e==="gas"&&w<0&&(w=0);const y=d(m);(!r||y<r)&&(r=y),(!o||y>o)&&(o=y);const b=y.toISOString().split("T")[0],T=s.get(b)||0;s.set(b,T+Number(w))})});let c=Array.from(s.entries()).map(([u,p])=>({x:new Date(u),y:p})).sort((u,p)=>u.x-p.x);return(t||a)&&(c=c.filter(u=>{const p=u.x.getTime();return!(t&&p<t.getTime()||a&&p>a.getTime())})),{data:c,dateRange:{min:r,max:o}}}function Ne(e=10){const t=[],a=new Date;return a.setHours(23,59,59,999),Object.keys(h.appData).forEach(l=>{const n=h.appData[l],s=C.find(r=>r.id===l);n&&n.wells&&s&&n.wells.forEach(r=>{if(r.status==="inactive")return;let o=null,i=null;if(r.wellTests&&r.wellTests.length>0){const d=r.wellTests.filter(c=>new Date(c.date)<=a);if(d.length>0){const c=d[0];o=c.oil,i=c.water}}t.push({wellId:r.id,wellName:r.name,sheetId:l,batteryName:s.name,oil:o!==null?Math.round(Number(o)*100)/100:0,water:i!==null?Math.round(Number(i)*100)/100:0})})}),t.sort((l,n)=>n.oil-l.oil),t.slice(0,e)}function Ee(e=10){const t=[],a=new Date;return a.setHours(23,59,59,999),Object.keys(h.appData).forEach(l=>{const n=h.appData[l],s=C.find(r=>r.id===l);n&&n.wells&&s&&n.wells.forEach(r=>{r.status!=="inactive"&&r.wellTests&&r.wellTests.length>0&&r.wellTests.forEach(o=>{if(o.date){const i=new Date(o.date);if(i>a)return;t.push({date:i,wellId:r.id,wellName:r.name,sheetId:l,batteryName:s.name,oil:o.oil!==null?Math.round(o.oil*100)/100:null,water:o.water!==null?Math.round(o.water*100)/100:null,gas:o.gas!==null?Math.round(Math.max(0,o.gas)*100)/100:null})}})})}),t.sort((l,n)=>n.date-l.date),t.slice(0,e)}function Pe(e=15){const t=[];return Object.keys(h.appData).forEach(a=>{const l=h.appData[a],n=C.find(s=>s.id===a);l&&l.wells&&n&&l.wells.forEach(s=>{s.status!=="inactive"&&s.actionItems&&s.actionItems.length>0&&s.actionItems.forEach(r=>{r&&r.trim()&&t.push({content:r,wellId:s.id,wellName:s.name,sheetId:a,batteryName:n.name})})})}),t.slice(0,e)}function ee(){return Object.keys(h.appData).some(e=>h.appData[e]&&h.appData[e].wells&&h.appData[e].wells.length>0)}const Ie={id:"cowden",name:"Cowden",expectedFileName:"Cowden Gauge Sheet1.xlsx",wells:[{id:"601h",name:"Cowden 601H",oilCol:1,waterCol:2,gasCol:3},{id:"602h",name:"Cowden 602H",oilCol:7,waterCol:8,gasCol:9},{id:"angus",name:"Angus 7-18-1H",oilCol:13,waterCol:14,gasCol:15}],pressureConfig:{sheet:"Cowden",headerRowIndex:6,dateCol:0,wells:{"601h":{csg:28,tbg:29,fl:30,inj:31},"602h":{csg:33,tbg:34,fl:35,inj:40},angus:{csg:42,tbg:43,fl:44,inj:47}}},productionConfig:{sheet:"Cowden",headerRowIndex:6,dateCol:0,oilProdCol:24,waterProdCol:25,gasProdCol:26},parse(e){const t={id:this.id,name:this.name,lastUpdated:new Date().toISOString(),wells:[],runTickets:[],rawRowCount:0,batteryProduction:[]};if(e.Sheets["Well Test"]){const a=this.parseWellTestSheet(e.Sheets["Well Test"]);t.wells=a.wells,t.rawRowCount=a.rowCount}return t.wells.length>0&&this.applyPressureReadings(e,t.wells),t.batteryProduction=this.parseBatteryProduction(e),e.Sheets["Run Tickets"]&&(t.runTickets=this.parseRunTicketsSheet(e.Sheets["Run Tickets"])),t},parseWellTestSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),a=this.wells.map(n=>({id:n.id,name:n.name,status:"active",wellTests:[],production:[],chemicalProgram:{continuous:{rate:null,chems:"-",ppm:null},truckTreat:{rate:null,chems:"-",ppm:null}},failureHistory:[],pressureReadings:[],actionItems:[]}));let l=0;for(let n=4;n<t.length;n++){const s=t[n];if(!s||!s[0])continue;const r=s[0];let o=null;if(r instanceof Date)o=r.toISOString().split("T")[0];else if(typeof r=="number"){const i=XLSX.SSF.parse_date_code(r);i&&(o=`${i.y}-${String(i.m).padStart(2,"0")}-${String(i.d).padStart(2,"0")}`)}else typeof r=="string"&&(o=r.split(" ")[0]);o&&(l++,this.wells.forEach((i,d)=>{const c=this.parseNumber(s[i.oilCol]),u=this.parseNumber(s[i.waterCol]),p=this.parseNumber(s[i.gasCol]);(c!==null||u!==null||p!==null)&&(a[d].wellTests.push({date:o,oil:c,water:u,gas:p}),a[d].production.push({date:new Date(o),oil:c,water:u,gas:p}))}))}return a.forEach(n=>{n.wellTests.sort((s,r)=>new Date(r.date)-new Date(s.date)),n.wellTests=n.wellTests.slice(0,60),n.production.sort((s,r)=>s.date-r.date)}),{wells:a,rowCount:l}},parseBatteryProduction(e){const t=this.productionConfig;if(!t)return[];const a=e.Sheets[t.sheet];if(!a)return[];const l=XLSX.utils.sheet_to_json(a,{header:1,defval:null});if(!l||l.length===0)return[];const n=[];for(let s=t.headerRowIndex+2;s<l.length;s++){const r=l[s];if(!r)continue;const o=this.parseDate(r[t.dateCol]);if(!o)continue;const i=this.parseNumber(r[t.oilProdCol]),d=this.parseNumber(r[t.waterProdCol]),c=t.gasProdCol!==null?this.parseNumber(r[t.gasProdCol]):null;(i!==null||d!==null||c!==null)&&n.push({date:new Date(o),oil:i,water:d,gas:c})}return n.sort((s,r)=>s.date-r.date),n},applyPressureReadings(e,t){const a=this.pressureConfig;if(!a)return;const l=e.Sheets[a.sheet];if(!l)return;const n=XLSX.utils.sheet_to_json(l,{header:1,defval:null});if(!n||n.length===0)return;const s={};t.forEach(r=>{s[r.id]=[]});for(let r=a.headerRowIndex+1;r<n.length;r++){const o=n[r];if(!o)continue;const i=this.parseDate(o[a.dateCol]);i&&Object.entries(a.wells).forEach(([d,c])=>{if(!s[d])return;const u=this.parseNumber(o[c.csg]),p=this.parseNumber(o[c.tbg]),f=this.parseNumber(o[c.fl]),g=this.parseNumber(o[c.inj]);(u!==null||p!==null||f!==null||g!==null)&&s[d].push({date:i,casingPsi:u,tubingPsi:p,flowlinePsi:f,injVol:g})})}t.forEach(r=>{const o=s[r.id]||[];o.sort((i,d)=>new Date(d.date)-new Date(i.date)),r.pressureReadings=o.slice(0,60)})},parseRunTicketsSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),a=[];for(let l=3;l<t.length;l++){const n=t[l];if(!n)continue;const s=n[1];if(!s)continue;let r=null;const o=n[0];if(o)if(o instanceof Date)r=o.toISOString().split("T")[0];else if(typeof o=="number"){const i=XLSX.SSF.parse_date_code(o);i&&(r=`${i.y}-${String(i.m).padStart(2,"0")}-${String(i.d).padStart(2,"0")}`)}else typeof o=="string"&&o.trim()&&(r=o.split(" ")[0]);a.push({date:r,ticketNum:String(s),tank:this.parseNumber(n[2]),ftTop:this.parseNumber(n[3]),inTop:this.parseNumber(n[4]),ftBttm:this.parseNumber(n[5]),inBttm:this.parseNumber(n[6]),calcVol:this.parseNumber(n[7]),vol:this.parseNumber(n[8]),gravity:this.parseNumber(n[9]),bsw:this.parseNumber(n[10])})}return a.sort((l,n)=>!l.date&&!n.date?0:l.date?n.date?new Date(n.date)-new Date(l.date):-1:1),a.slice(0,100)},parseDate(e){if(!e)return null;if(e instanceof Date)return e.toISOString().split("T")[0];if(typeof e=="number"){const t=XLSX.SSF.parse_date_code(e);if(t)return`${t.y}-${String(t.m).padStart(2,"0")}-${String(t.d).padStart(2,"0")}`}return typeof e=="string"?e.split(" ")[0]:null},parseNumber(e){if(e==null||e==="")return null;const t=parseFloat(e);return isNaN(t)?null:t<0?0:t}},Be={id:"bigmax",name:"Big Max",expectedFileName:"Big Max Gauge Sheet.xlsx",wells:[{id:"bigmax-1-1",name:"Big Max 1 #1",oilCol:1,waterCol:2,gasCol:3,status:"active"},{id:"bigmax-4-1",name:"Big Max 4 #1",oilCol:7,waterCol:8,gasCol:9,status:"active"},{id:"bigmax-5-2",name:"Big Max 5 #2",oilCol:13,waterCol:14,gasCol:15,status:"active"},{id:"bigmax-11-1",name:"Big Max 11 #1",oilCol:19,waterCol:20,gasCol:21,status:"active"},{id:"bigmax-11-2",name:"Big Max 11 #2",oilCol:25,waterCol:26,gasCol:27,status:"active"},{id:"bigmax-12-1",name:"Big Max 12 #1",oilCol:31,waterCol:32,gasCol:33,status:"active"},{id:"bigmax-12-2",name:"Big Max 12 #2",oilCol:37,waterCol:38,gasCol:39,status:"active"},{id:"bigmax-13-3",name:"Big Max 13 #3",oilCol:43,waterCol:44,gasCol:45,status:"active"},{id:"bigmax-13-5",name:"Big Max 13 #5",oilCol:49,waterCol:50,gasCol:51,status:"active"},{id:"bigmax-14-4",name:"Big Max 14 #4",oilCol:55,waterCol:56,gasCol:57,status:"active"},{id:"bigmax-swd",name:"Big Max 12-101 SWD",oilCol:61,waterCol:62,gasCol:63,status:"active",wellType:"swd"}],parse(e){const t={id:this.id,name:this.name,lastUpdated:new Date().toISOString(),wells:[],runTickets:[],rawRowCount:0,batteryProduction:[]};if(e.Sheets["Well Test"]){const a=this.parseWellTestSheet(e.Sheets["Well Test"]);t.wells=a.wells,t.rawRowCount=a.rowCount}return e.Sheets["Run Tickets"]&&(t.runTickets=this.parseRunTicketsSheet(e.Sheets["Run Tickets"])),t},parseWellTestSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),a=this.wells.map(n=>({id:n.id,name:n.name,status:n.status||"active",wellType:n.wellType||"production",wellTests:[],production:[],chemicalProgram:{continuous:{rate:null,chems:"-",ppm:null},truckTreat:{rate:null,chems:"-",ppm:null}},failureHistory:[],pressureReadings:[],actionItems:[]}));let l=0;for(let n=4;n<t.length;n++){const s=t[n];if(!s||!s[0])continue;const r=this.parseDate(s[0]);r&&(l++,this.wells.forEach((o,i)=>{let d=this.parseNumber(s[o.oilCol]),c=this.parseNumber(s[o.waterCol]),u=this.parseNumber(s[o.gasCol]);o.id==="bigmax-swd"&&(c=d,d=0,u=0),(d!==null||c!==null||u!==null)&&(a[i].wellTests.push({date:r,oil:d,water:c,gas:u}),a[i].production.push({date:new Date(r),oil:d,water:c,gas:u}))}))}return a.forEach(n=>{n.wellTests.sort((s,r)=>new Date(r.date)-new Date(s.date)),n.wellTests=n.wellTests.slice(0,60),n.production.sort((s,r)=>s.date-r.date)}),{wells:a,rowCount:l}},parseRunTicketsSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),a=[];for(let l=3;l<t.length;l++){const n=t[l];!n||!n[1]||a.push({date:this.parseDate(n[0]),ticketNum:String(n[1]||""),tank:this.parseNumber(n[2]),ftTop:this.parseNumber(n[3]),inTop:this.parseNumber(n[4]),ftBttm:this.parseNumber(n[5]),inBttm:this.parseNumber(n[6]),vol:this.parseNumber(n[8])})}return a.sort((l,n)=>(n.date||"").localeCompare(l.date||"")),a.slice(0,100)},parseDate(e){if(!e)return null;if(e instanceof Date)return e.toISOString().split("T")[0];if(typeof e=="number"){const t=XLSX.SSF.parse_date_code(e);if(t)return`${t.y}-${String(t.m).padStart(2,"0")}-${String(t.d).padStart(2,"0")}`}return typeof e=="string"?e.split(" ")[0]:null},parseNumber(e){if(e==null||e==="")return null;const t=parseFloat(e);return isNaN(t)?null:t<0?0:t}},ke={id:"bigmax1h",name:"Big Max 1H",expectedFileName:"Big Max 1H Gauge Sheet.xlsx",wells:[{id:"bigmax-1-1h",name:"Big Max 1-1H",oilCol:1,waterCol:2,gasCol:3}],productionConfig:{sheet:"Big Max 1H",headerRowIndex:6,dateCol:0,oilProdCol:21,waterProdCol:22,gasProdCol:23},parse(e){const t={id:this.id,name:this.name,lastUpdated:new Date().toISOString(),wells:[],runTickets:[],rawRowCount:0,batteryProduction:[]};if(e.Sheets["Well Test"]){const a=this.parseWellTestSheet(e.Sheets["Well Test"]);t.wells=a.wells,t.rawRowCount=a.rowCount}return t.batteryProduction=this.parseBatteryProduction(e),e.Sheets["Run Tickets"]&&(t.runTickets=this.parseRunTicketsSheet(e.Sheets["Run Tickets"])),t},parseWellTestSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),a=this.wells.map(n=>({id:n.id,name:n.name,status:"active",wellTests:[],production:[],chemicalProgram:{continuous:{rate:null,chems:"-",ppm:null},truckTreat:{rate:null,chems:"-",ppm:null}},failureHistory:[],pressureReadings:[],actionItems:[]}));let l=0;for(let n=4;n<t.length;n++){const s=t[n];if(!s||!s[0])continue;const r=this.parseDate(s[0]);r&&(l++,this.wells.forEach((o,i)=>{const d=this.parseNumber(s[o.oilCol]),c=this.parseNumber(s[o.waterCol]),u=this.parseNumber(s[o.gasCol]);(d!==null||c!==null||u!==null)&&(a[i].wellTests.push({date:r,oil:d,water:c,gas:u}),a[i].production.push({date:new Date(r),oil:d,water:c,gas:u}))}))}return a.forEach(n=>{n.wellTests.sort((s,r)=>new Date(r.date)-new Date(s.date)),n.wellTests=n.wellTests.slice(0,60),n.production.sort((s,r)=>s.date-r.date)}),{wells:a,rowCount:l}},parseBatteryProduction(e){const t=this.productionConfig;if(!t)return[];const a=e.Sheets[t.sheet];if(!a)return[];const l=XLSX.utils.sheet_to_json(a,{header:1,defval:null});if(!l||l.length===0)return[];const n=[];for(let s=t.headerRowIndex+2;s<l.length;s++){const r=l[s];if(!r)continue;const o=this.parseDate(r[t.dateCol]);if(!o)continue;const i=this.parseNumber(r[t.oilProdCol]),d=this.parseNumber(r[t.waterProdCol]),c=t.gasProdCol!==null?this.parseNumber(r[t.gasProdCol]):null;(i!==null||d!==null||c!==null)&&n.push({date:new Date(o),oil:i,water:d,gas:c})}return n.sort((s,r)=>s.date-r.date),n},parseRunTicketsSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),a=[];for(let l=3;l<t.length;l++){const n=t[l];!n||!n[1]||a.push({date:this.parseDate(n[0]),ticketNum:String(n[1]||""),tank:this.parseNumber(n[2]),ftTop:this.parseNumber(n[3]),inTop:this.parseNumber(n[4]),ftBttm:this.parseNumber(n[5]),inBttm:this.parseNumber(n[6]),vol:this.parseNumber(n[8])})}return a.sort((l,n)=>(n.date||"").localeCompare(l.date||"")),a.slice(0,100)},parseDate(e){if(!e)return null;if(e instanceof Date)return e.toISOString().split("T")[0];if(typeof e=="number"){const t=XLSX.SSF.parse_date_code(e);if(t)return`${t.y}-${String(t.m).padStart(2,"0")}-${String(t.d).padStart(2,"0")}`}return typeof e=="string"?e.split(" ")[0]:null},parseNumber(e){if(e==null||e==="")return null;const t=parseFloat(e);return isNaN(t)?null:t<0?0:t}},Le={id:"southandrews",name:"South Andrews",expectedFileName:"South Andrews Gauge Sheet.xlsm",wellsPg1:[{id:"uls-1-30-6h",name:"1-30-6H",oilCol:1,waterCol:2,gasCol:3},{id:"uls-1-30-8h",name:"1-30-8H",oilCol:7,waterCol:8,gasCol:9},{id:"uls-1-31-2h",name:"1-31-2H",oilCol:13,waterCol:14,gasCol:15},{id:"uls-1-36-1h",name:"1-36-1H",oilCol:19,waterCol:20,gasCol:21},{id:"uls-1-36-2h",name:"1-36-2H",oilCol:25,waterCol:26,gasCol:27},{id:"uls-1-36-3h",name:"1-36-3H",oilCol:31,waterCol:32,gasCol:33},{id:"uls-1-36-4h",name:"1-36-4H",oilCol:37,waterCol:38,gasCol:39},{id:"uls-1-36-5h",name:"1-36-5H",oilCol:43,waterCol:44,gasCol:45},{id:"uls-1-36-6h",name:"1-36-6H",oilCol:49,waterCol:50,gasCol:51},{id:"uls-1-37-1h",name:"1-37-1H",oilCol:55,waterCol:56,gasCol:57},{id:"uls-1-37-3h",name:"1-37-3H",oilCol:61,waterCol:62,gasCol:63},{id:"uls-1-37-4h",name:"1-37-4H",oilCol:67,waterCol:68,gasCol:69},{id:"uls-1-37-6h",name:"1-37-6H",oilCol:73,waterCol:74,gasCol:75}],wellsPg2:[{id:"cobra-5h",name:"Cobra 5H",oilCol:1,waterCol:2,gasCol:3,status:"active"},{id:"cobra-3012",name:"Cobra 3012",oilCol:7,waterCol:8,gasCol:9,status:"active"},{id:"cobra-3033",name:"Cobra 3033",oilCol:13,waterCol:14,gasCol:15,status:"active"},{id:"fn-3731",name:"FN 3731",oilCol:19,waterCol:20,gasCol:21,status:"active"},{id:"pinnacle-1",name:"Pinnacle #1",oilCol:25,waterCol:26,gasCol:27,status:"active"},{id:"pinnacle-2h",name:"Pinnacle 2H",oilCol:31,waterCol:32,gasCol:33,status:"active"},{id:"sawgrass-2h",name:"Sawgrass 2H",oilCol:37,waterCol:38,gasCol:39,status:"inactive"},{id:"sawgrass-5h",name:"Sawgrass 5H",oilCol:43,waterCol:44,gasCol:45,status:"active"}],pressureConfig:[{sheet:"36-4H",headerRowIndex:8,dateCol:0,wells:{"uls-1-36-1h":{csg:61,tbg:62,fl:63,inj:64},"uls-1-36-2h":{csg:68,tbg:69,fl:70,inj:71},"uls-1-36-3h":{csg:73,tbg:74,fl:75,inj:76},"uls-1-36-4h":{csg:78,tbg:79,fl:80,inj:81},"uls-1-36-5h":{csg:86,tbg:87,fl:88,inj:89},"uls-1-36-6h":{csg:91,tbg:92,fl:93,inj:94},"uls-1-37-1h":{csg:96,tbg:97,fl:98,inj:99},"uls-1-37-3h":{csg:101,tbg:102,fl:103,inj:104}}},{sheet:"37-6H",headerRowIndex:8,dateCol:0,wells:{"uls-1-31-2h":{csg:34,tbg:35,fl:36,inj:37},"uls-1-37-4h":{csg:39,tbg:40,fl:41,inj:42},"uls-1-37-6h":{csg:44,tbg:45,fl:46,inj:47},"uls-1-30-6h":{csg:49,tbg:50,fl:51,inj:52},"uls-1-30-8h":{csg:54,tbg:55,fl:56,inj:57}}}],productionConfig:[{sheet:"36-4H",headerRowIndex:8,dateCol:0,oilProdCol:56,waterProdCol:57,gasProdCol:58},{sheet:"37-6H",headerRowIndex:8,dateCol:0,oilProdCol:29,waterProdCol:30,gasProdCol:31}],parse(e){const t={id:this.id,name:this.name,lastUpdated:new Date().toISOString(),wells:[],runTickets:[],rawRowCount:0,batteryProduction:[]};if(e.Sheets["Well Test pg1"]){const a=this.parseWellTestSheet(e.Sheets["Well Test pg1"],this.wellsPg1);t.wells.push(...a.wells),t.rawRowCount=a.rowCount}if(e.Sheets["Well Test pg2"]){const a=this.parseWellTestSheet(e.Sheets["Well Test pg2"],this.wellsPg2);t.wells.push(...a.wells)}return t.wells.length>0&&this.applyPressureReadings(e,t.wells),t.batteryProduction=this.parseBatteryProduction(e),["36-4H Tickets","37-6H Tickets","36 6H Tickets"].forEach(a=>{if(e.Sheets[a]){const l=this.parseRunTicketsSheet(e.Sheets[a]);t.runTickets.push(...l)}}),t.runTickets.sort((a,l)=>(l.date||"").localeCompare(a.date||"")),t.runTickets=t.runTickets.slice(0,100),t},parseWellTestSheet(e,t){const a=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),l=t.map(s=>({id:s.id,name:s.name,status:s.status||"active",wellTests:[],production:[],chemicalProgram:{continuous:{rate:null,chems:"-",ppm:null},truckTreat:{rate:null,chems:"-",ppm:null}},failureHistory:[],pressureReadings:[],actionItems:[]}));let n=0;for(let s=4;s<a.length;s++){const r=a[s];if(!r||!r[0])continue;const o=this.parseDate(r[0]);o&&(n++,t.forEach((i,d)=>{const c=this.parseNumber(r[i.oilCol]),u=this.parseNumber(r[i.waterCol]),p=this.parseNumber(r[i.gasCol]);(c!==null||u!==null||p!==null)&&(l[d].wellTests.push({date:o,oil:c,water:u,gas:p}),l[d].production.push({date:new Date(o),oil:c,water:u,gas:p}))}))}return l.forEach(s=>{s.wellTests.sort((r,o)=>new Date(o.date)-new Date(r.date)),s.wellTests=s.wellTests.slice(0,60),s.production.sort((r,o)=>r.date-o.date)}),{wells:l,rowCount:n}},parseRunTicketsSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),a=[];for(let l=3;l<t.length;l++){const n=t[l];!n||!n[1]||a.push({date:this.parseDate(n[0]),ticketNum:String(n[1]||""),tank:this.parseNumber(n[2]),ftTop:this.parseNumber(n[3]),inTop:this.parseNumber(n[4]),ftBttm:this.parseNumber(n[5]),inBttm:this.parseNumber(n[6]),vol:this.parseNumber(n[8])})}return a},parseBatteryProduction(e){const t=new Map;this.productionConfig.forEach(l=>{const n=e.Sheets[l.sheet];if(!n)return;const s=XLSX.utils.sheet_to_json(n,{header:1,defval:null});if(!(!s||s.length===0))for(let r=l.headerRowIndex+2;r<s.length;r++){const o=s[r];if(!o)continue;const i=this.parseDate(o[l.dateCol]);if(!i)continue;const d=this.parseNumber(o[l.oilProdCol]),c=this.parseNumber(o[l.waterProdCol]),u=l.gasProdCol!==null?this.parseNumber(o[l.gasProdCol]):null;if(d!==null||c!==null||u!==null){const p=t.get(i);p?(p.oil=(p.oil||0)+(d||0),p.water=(p.water||0)+(c||0),p.gas=(p.gas||0)+(u||0)):t.set(i,{date:new Date(i),oil:d||0,water:c||0,gas:u||0})}}});const a=Array.from(t.values());return a.sort((l,n)=>l.date-n.date),a},applyPressureReadings(e,t){const a={};t.forEach(n=>{a[n.id]=n,n.pressureReadings=[]});const l={};Object.keys(a).forEach(n=>{l[n]=[]}),this.pressureConfig.forEach(n=>{const s=e.Sheets[n.sheet];if(!s)return;const r=XLSX.utils.sheet_to_json(s,{header:1,defval:null});if(!(!r||r.length===0))for(let o=n.headerRowIndex+1;o<r.length;o++){const i=r[o];if(!i)continue;const d=this.parseDate(i[n.dateCol]);d&&Object.entries(n.wells).forEach(([c,u])=>{if(!l[c])return;const p=this.parseNumber(i[u.csg]),f=this.parseNumber(i[u.tbg]),g=this.parseNumber(i[u.fl]),m=this.parseNumber(i[u.inj]);(p!==null||f!==null||g!==null||m!==null)&&l[c].push({date:d,casingPsi:p,tubingPsi:f,flowlinePsi:g,injVol:m})})}}),t.forEach(n=>{const s=l[n.id]||[];s.sort((r,o)=>new Date(o.date)-new Date(r.date)),n.pressureReadings=s.slice(0,60)})},parseDate(e){if(!e)return null;if(e instanceof Date)return e.toISOString().split("T")[0];if(typeof e=="number"){const t=XLSX.SSF.parse_date_code(e);if(t)return`${t.y}-${String(t.m).padStart(2,"0")}-${String(t.d).padStart(2,"0")}`}return typeof e=="string"?e.split(" ")[0]:null},parseNumber(e){if(e==null||e==="")return null;const t=parseFloat(e);return isNaN(t)?null:t<0?0:t}},Re={id:"polaris",name:"Polaris",expectedFileName:"Polaris Gauge Sheet.xlsx",wells:[{id:"polaris-1",name:"Polaris #1",oilCol:1,waterCol:2,gasCol:3,status:"active"},{id:"polaris-2",name:"Polaris #2",oilCol:5,waterCol:6,gasCol:7,status:"inactive"}],productionConfig:{sheet:"Polaris 1",headerRowIndex:3,dateCol:0,oilProdCol:16,waterProdCol:17,gasProdCol:null},parse(e){const t={id:this.id,name:this.name,lastUpdated:new Date().toISOString(),wells:[],runTickets:[],rawRowCount:0,batteryProduction:[]};if(e.Sheets["Well Test"]){const a=this.parseWellTestSheet(e.Sheets["Well Test"]);t.wells=a.wells,t.rawRowCount=a.rowCount}return t.batteryProduction=this.parseBatteryProduction(e),e.Sheets["Run Tickets"]&&(t.runTickets=this.parseRunTicketsSheet(e.Sheets["Run Tickets"])),t},parseWellTestSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),a=this.wells.map(n=>({id:n.id,name:n.name,status:n.status||"active",wellTests:[],production:[],chemicalProgram:{continuous:{rate:null,chems:"-",ppm:null},truckTreat:{rate:null,chems:"-",ppm:null}},failureHistory:[],pressureReadings:[],actionItems:[]}));let l=0;for(let n=4;n<t.length;n++){const s=t[n];if(!s||!s[0])continue;const r=this.parseDate(s[0]);r&&(l++,this.wells.forEach((o,i)=>{const d=this.parseNumber(s[o.oilCol]),c=this.parseNumber(s[o.waterCol]),u=this.parseNumber(s[o.gasCol]);(d!==null||c!==null||u!==null)&&(a[i].wellTests.push({date:r,oil:d,water:c,gas:u}),a[i].production.push({date:new Date(r),oil:d,water:c,gas:u}))}))}return a.forEach(n=>{n.wellTests.sort((s,r)=>new Date(r.date)-new Date(s.date)),n.wellTests=n.wellTests.slice(0,60),n.production.sort((s,r)=>s.date-r.date)}),{wells:a,rowCount:l}},parseBatteryProduction(e){const t=this.productionConfig;if(!t)return[];const a=e.Sheets[t.sheet];if(!a)return[];const l=XLSX.utils.sheet_to_json(a,{header:1,defval:null});if(!l||l.length===0)return[];const n=[];for(let s=t.headerRowIndex+2;s<l.length;s++){const r=l[s];if(!r)continue;const o=this.parseDate(r[t.dateCol]);if(!o)continue;const i=this.parseNumber(r[t.oilProdCol]),d=this.parseNumber(r[t.waterProdCol]),c=t.gasProdCol!==null?this.parseNumber(r[t.gasProdCol]):null;(i!==null||d!==null||c!==null)&&n.push({date:new Date(o),oil:i,water:d,gas:c})}return n.sort((s,r)=>s.date-r.date),n},parseRunTicketsSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),a=[];for(let l=3;l<t.length;l++){const n=t[l];!n||!n[1]||a.push({date:this.parseDate(n[0]),ticketNum:String(n[1]||""),tank:this.parseNumber(n[2]),ftTop:this.parseNumber(n[3]),inTop:this.parseNumber(n[4]),ftBttm:this.parseNumber(n[5]),inBttm:this.parseNumber(n[6]),vol:this.parseNumber(n[8])})}return a.sort((l,n)=>(n.date||"").localeCompare(l.date||"")),a.slice(0,100)},parseDate(e){if(!e)return null;if(e instanceof Date)return e.toISOString().split("T")[0];if(typeof e=="number"){const t=XLSX.SSF.parse_date_code(e);if(t)return`${t.y}-${String(t.m).padStart(2,"0")}-${String(t.d).padStart(2,"0")}`}return typeof e=="string"?e.split(" ")[0]:null},parseNumber(e){if(e==null||e==="")return null;const t=parseFloat(e);return isNaN(t)?null:t<0?0:t}},Me={id:"shusa",name:"Shusa",expectedFileName:"Shusa Gauge Sheet.xlsx",wells20RB:[{id:"shusa-20-1",name:"Shusa 20 #1",oilCol:1,waterCol:2,gasCol:null},{id:"shusa-20-2",name:"Shusa 20 #2",oilCol:5,waterCol:6,gasCol:null},{id:"shusa-20-3",name:"Shusa 20 #3",oilCol:9,waterCol:10,gasCol:null},{id:"shusa-20-4",name:"Shusa 20 #4",oilCol:13,waterCol:14,gasCol:null},{id:"shusa-20-5",name:"Shusa 20 #5",oilCol:17,waterCol:18,gasCol:null},{id:"rosebud-20-1",name:"Rosebud 20 #1",oilCol:21,waterCol:22,gasCol:null},{id:"rosebud-20-3",name:"Rosebud 20 #3",oilCol:25,waterCol:26,gasCol:null},{id:"rosebud-20-4",name:"Rosebud 20 #4",oilCol:29,waterCol:30,gasCol:null},{id:"rosebud-yates-1",name:"Rosebud-Yates #1",oilCol:33,waterCol:34,gasCol:35},{id:"link-2",name:"Link #2",oilCol:39,waterCol:40,gasCol:null},{id:"link-3",name:"Link #3",oilCol:43,waterCol:44,gasCol:null},{id:"link-4",name:"Link #4",oilCol:47,waterCol:48,gasCol:null},{id:"link-5",name:"Link #5",oilCol:51,waterCol:52,gasCol:null},{id:"link-6",name:"Link #6",oilCol:55,waterCol:56,gasCol:null}],productionConfig:{sheet:"Total",headerRowIndex:2,dateCol:0,oilProdCol:2,waterProdCol:3,gasProdCol:null},wells1415:[{id:"shusa-14-1",name:"Shusa 14 #1",oilCol:4,waterCol:5,gasCol:null},{id:"shusa-14-2",name:"Shusa 14 #2",oilCol:8,waterCol:9,gasCol:null},{id:"shusa-14-3",name:"Shusa 14 #3",oilCol:12,waterCol:13,gasCol:null},{id:"shusa-14-4",name:"Shusa 14 #4",oilCol:16,waterCol:17,gasCol:null},{id:"shusa-14-5",name:"Shusa 14 #5",oilCol:20,waterCol:21,gasCol:null},{id:"shusa-14-6",name:"Shusa 14 #6",oilCol:24,waterCol:25,gasCol:null},{id:"shusa-14-7",name:"Shusa 14 #7",oilCol:28,waterCol:29,gasCol:null},{id:"shusa-14-8",name:"Shusa 14 #8",oilCol:32,waterCol:33,gasCol:null},{id:"shusa-14-9",name:"Shusa 14 #9",oilCol:36,waterCol:37,gasCol:null},{id:"shusa-14-10",name:"Shusa 14 #10",oilCol:40,waterCol:41,gasCol:null},{id:"shusa-14-12",name:"Shusa 14 #12",oilCol:44,waterCol:45,gasCol:null},{id:"shusa-15-1",name:"Shusa 15 #1",oilCol:48,waterCol:49,gasCol:null},{id:"shusa-15-2",name:"Shusa 15 #2",oilCol:52,waterCol:53,gasCol:null},{id:"shusa-15-3",name:"Shusa 15 #3",oilCol:56,waterCol:57,gasCol:null},{id:"shusa-15-4",name:"Shusa 15 #4",oilCol:60,waterCol:61,gasCol:null},{id:"shusa-15-6",name:"Shusa 15 #6",oilCol:64,waterCol:65,gasCol:null},{id:"shusa-15-7",name:"Shusa 15 #7",oilCol:68,waterCol:69,gasCol:null},{id:"shusa-15-8",name:"Shusa 15 #8",oilCol:72,waterCol:73,gasCol:null},{id:"shusa-15-9",name:"Shusa 15 #9",oilCol:76,waterCol:77,gasCol:null},{id:"shusa-15-10",name:"Shusa 15 #10",oilCol:80,waterCol:81,gasCol:null},{id:"shusa-15-11",name:"Shusa 15 #11",oilCol:84,waterCol:85,gasCol:null},{id:"shusa-15-12",name:"Shusa 15 #12",oilCol:88,waterCol:89,gasCol:null},{id:"shusa-15-13",name:"Shusa 15 #13",oilCol:92,waterCol:93,gasCol:null},{id:"shusa-15-14",name:"Shusa 15 #14",oilCol:96,waterCol:97,gasCol:null},{id:"shusa-15-15",name:"Shusa 15 #15",oilCol:100,waterCol:101,gasCol:null},{id:"shusa-15-16",name:"Shusa 15 #16",oilCol:104,waterCol:105,gasCol:null}],parse(e){const t={id:this.id,name:this.name,lastUpdated:new Date().toISOString(),wells:[],runTickets:[],rawRowCount:0,batteryProduction:[]};if(e.Sheets["Well Test 20 RB Link"]){const a=this.parseWellTestSheet(e.Sheets["Well Test 20 RB Link"],this.wells20RB);t.wells.push(...a.wells),t.rawRowCount=a.rowCount}if(e.Sheets["Well Test 14 15"]){const a=this.parseWellTestSheet(e.Sheets["Well Test 14 15"],this.wells1415);t.wells.push(...a.wells)}return t.batteryProduction=this.parseBatteryProduction(e),["14-15 Run Tickets","20-RB Run Tickets","Link Run Tickets","Yates Run Tickets"].forEach(a=>{if(e.Sheets[a]){const l=this.parseRunTicketsSheet(e.Sheets[a]);t.runTickets.push(...l)}}),t.runTickets.sort((a,l)=>(l.date||"").localeCompare(a.date||"")),t.runTickets=t.runTickets.slice(0,100),t},parseWellTestSheet(e,t){const a=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),l=t.map(s=>({id:s.id,name:s.name,status:"active",wellTests:[],production:[],chemicalProgram:{continuous:{rate:null,chems:"-",ppm:null},truckTreat:{rate:null,chems:"-",ppm:null}},failureHistory:[],pressureReadings:[],actionItems:[]}));let n=0;for(let s=4;s<a.length;s++){const r=a[s];if(!r||!r[0])continue;const o=this.parseDate(r[0]);o&&(n++,t.forEach((i,d)=>{const c=this.parseNumber(r[i.oilCol]),u=this.parseNumber(r[i.waterCol]),p=i.gasCol!==null?this.parseNumber(r[i.gasCol]):null;(c!==null||u!==null||p!==null)&&(l[d].wellTests.push({date:o,oil:c,water:u,gas:p}),l[d].production.push({date:new Date(o),oil:c,water:u,gas:p}))}))}return l.forEach(s=>{s.wellTests.sort((r,o)=>new Date(o.date)-new Date(r.date)),s.wellTests=s.wellTests.slice(0,60),s.production.sort((r,o)=>r.date-o.date)}),{wells:l,rowCount:n}},parseBatteryProduction(e){const t=this.productionConfig;if(!t)return[];const a=e.Sheets[t.sheet];if(!a)return[];const l=XLSX.utils.sheet_to_json(a,{header:1,defval:null});if(!l||l.length===0)return[];const n=[];for(let s=t.headerRowIndex+2;s<l.length;s++){const r=l[s];if(!r)continue;const o=this.parseDate(r[t.dateCol]);if(!o)continue;const i=this.parseNumber(r[t.oilProdCol]),d=this.parseNumber(r[t.waterProdCol]),c=t.gasProdCol!==null?this.parseNumber(r[t.gasProdCol]):null;(i!==null||d!==null||c!==null)&&n.push({date:new Date(o),oil:i,water:d,gas:c})}return n.sort((s,r)=>s.date-r.date),n},parseRunTicketsSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),a=[];for(let l=3;l<t.length;l++){const n=t[l];!n||!n[1]||a.push({date:this.parseDate(n[0]),ticketNum:String(n[1]||""),tank:this.parseNumber(n[2]),ftTop:this.parseNumber(n[3]),inTop:this.parseNumber(n[4]),ftBttm:this.parseNumber(n[5]),inBttm:this.parseNumber(n[6]),vol:this.parseNumber(n[8])})}return a},parseDate(e){if(!e)return null;if(e instanceof Date)return e.toISOString().split("T")[0];if(typeof e=="number"){const t=XLSX.SSF.parse_date_code(e);if(t)return`${t.y}-${String(t.m).padStart(2,"0")}-${String(t.d).padStart(2,"0")}`}return typeof e=="string"?e.split(" ")[0]:null},parseNumber(e){if(e==null||e==="")return null;const t=parseFloat(e);return isNaN(t)?null:t<0?0:t}},He={id:"mwwemac",name:"MW-Wemac-Sabrina-Berkley",expectedFileName:"Mw-Wemac-Sabrina-Berkley.xlsx",wells:[{id:"berkley-1",name:"Berkley #1",oilCol:1,waterCol:2,gasCol:3,status:"active"},{id:"berkley-4",name:"Berkley #4",oilCol:7,waterCol:8,gasCol:9,status:"inactive"},{id:"berkley-5",name:"Berkley #5",oilCol:13,waterCol:14,gasCol:15,status:"active"},{id:"berkley-6",name:"Berkley #6",oilCol:19,waterCol:20,gasCol:21,status:"active"},{id:"sabrina-5",name:"Sabrina #5",oilCol:25,waterCol:26,gasCol:27,status:"inactive"},{id:"sabrina-7",name:"Sabrina #7",oilCol:31,waterCol:32,gasCol:33,status:"inactive"},{id:"sabrina-3",name:"Sabrina #3",oilCol:37,waterCol:38,gasCol:39,status:"inactive"},{id:"sabrina-12",name:"Sabrina #12",oilCol:43,waterCol:44,gasCol:45,status:"inactive"}],productionConfig:{sheet:"Berkley",headerRowIndex:3,dateCol:0,oilProdCol:25,waterProdCol:26,gasProdCol:27},parse(e){const t={id:this.id,name:this.name,lastUpdated:new Date().toISOString(),wells:[],runTickets:[],rawRowCount:0,batteryProduction:[]};if(e.Sheets.Well_Test){const a=this.parseWellTestSheet(e.Sheets.Well_Test);t.wells=a.wells,t.rawRowCount=a.rowCount}return t.batteryProduction=this.parseBatteryProduction(e),t},parseWellTestSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),a=this.wells.map(n=>({id:n.id,name:n.name,status:n.status||"active",wellTests:[],production:[],chemicalProgram:{continuous:{rate:null,chems:"-",ppm:null},truckTreat:{rate:null,chems:"-",ppm:null}},failureHistory:[],pressureReadings:[],actionItems:[]}));let l=0;for(let n=4;n<t.length;n++){const s=t[n];if(!s||!s[0])continue;const r=this.parseDate(s[0]);r&&(l++,this.wells.forEach((o,i)=>{const d=this.parseNumber(s[o.oilCol]),c=this.parseNumber(s[o.waterCol]),u=this.parseNumber(s[o.gasCol]);(d!==null||c!==null||u!==null)&&(a[i].wellTests.push({date:r,oil:d,water:c,gas:u}),a[i].production.push({date:new Date(r),oil:d,water:c,gas:u}))}))}return a.forEach(n=>{n.wellTests.sort((s,r)=>new Date(r.date)-new Date(s.date)),n.wellTests=n.wellTests.slice(0,60),n.production.sort((s,r)=>s.date-r.date)}),{wells:a,rowCount:l}},parseBatteryProduction(e){const t=this.productionConfig;if(!t)return[];const a=e.Sheets[t.sheet];if(!a)return[];const l=XLSX.utils.sheet_to_json(a,{header:1,defval:null});if(!l||l.length===0)return[];const n=[];for(let s=t.headerRowIndex+2;s<l.length;s++){const r=l[s];if(!r)continue;const o=this.parseDate(r[t.dateCol]);if(!o)continue;const i=this.parseNumber(r[t.oilProdCol]),d=this.parseNumber(r[t.waterProdCol]),c=t.gasProdCol!==null?this.parseNumber(r[t.gasProdCol]):null;(i!==null||d!==null||c!==null)&&n.push({date:new Date(o),oil:i,water:d,gas:c})}return n.sort((s,r)=>s.date-r.date),n},parseDate(e){if(!e)return null;if(e instanceof Date)return e.toISOString().split("T")[0];if(typeof e=="number"){const t=XLSX.SSF.parse_date_code(e);if(t)return`${t.y}-${String(t.m).padStart(2,"0")}-${String(t.d).padStart(2,"0")}`}return typeof e=="string"?e.split(" ")[0]:null},parseNumber(e){if(e==null||e==="")return null;const t=parseFloat(e);return isNaN(t)?null:t<0?0:t}},$e={id:"unit130",name:"1-30 Unit 1H",expectedFileName:"1-30 Unit 1H Gauge Sheet.xlsx",wells:[{id:"uls-1-30-1h",name:"ULS 1-30-1H",oilCol:1,waterCol:2,gasCol:3}],pressureConfig:{sheet:"1-30-1H Gauge Sheet",headerRowIndex:5,dateCol:0,wells:{"uls-1-30-1h":{csg:37,tbg:38,fl:null,inj:39}}},productionConfig:{sheet:"1-30-1H Gauge Sheet",headerRowIndex:5,dateCol:0,oilProdCol:30,waterProdCol:31,gasProdCol:32},parse(e){const t={id:this.id,name:this.name,lastUpdated:new Date().toISOString(),wells:[],runTickets:[],rawRowCount:0,batteryProduction:[]};if(e.Sheets["Well Test"]){const a=this.parseWellTestSheet(e.Sheets["Well Test"]);t.wells=a.wells,t.rawRowCount=a.rowCount}return t.wells.length>0&&this.applyPressureReadings(e,t.wells),t.batteryProduction=this.parseBatteryProduction(e),t},parseWellTestSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),a=this.wells.map(n=>({id:n.id,name:n.name,status:"active",wellTests:[],production:[],chemicalProgram:{continuous:{rate:null,chems:"-",ppm:null},truckTreat:{rate:null,chems:"-",ppm:null}},failureHistory:[],pressureReadings:[],actionItems:[]}));let l=0;for(let n=4;n<t.length;n++){const s=t[n];if(!s||!s[0])continue;const r=this.parseDate(s[0]);r&&(l++,this.wells.forEach((o,i)=>{const d=this.parseNumber(s[o.oilCol]),c=this.parseNumber(s[o.waterCol]),u=this.parseNumber(s[o.gasCol]);(d!==null||c!==null||u!==null)&&(a[i].wellTests.push({date:r,oil:d,water:c,gas:u}),a[i].production.push({date:new Date(r),oil:d,water:c,gas:u}))}))}return a.forEach(n=>{n.wellTests.sort((s,r)=>new Date(r.date)-new Date(s.date)),n.wellTests=n.wellTests.slice(0,60),n.production.sort((s,r)=>s.date-r.date)}),{wells:a,rowCount:l}},parseBatteryProduction(e){const t=this.productionConfig;if(!t)return[];const a=e.Sheets[t.sheet];if(!a)return[];const l=XLSX.utils.sheet_to_json(a,{header:1,defval:null});if(!l||l.length===0)return[];const n=[];for(let s=t.headerRowIndex+2;s<l.length;s++){const r=l[s];if(!r)continue;const o=this.parseDate(r[t.dateCol]);if(!o)continue;const i=this.parseNumber(r[t.oilProdCol]),d=this.parseNumber(r[t.waterProdCol]),c=t.gasProdCol!==null?this.parseNumber(r[t.gasProdCol]):null;(i!==null||d!==null||c!==null)&&n.push({date:new Date(o),oil:i,water:d,gas:c})}return n.sort((s,r)=>s.date-r.date),n},applyPressureReadings(e,t){const a=this.pressureConfig;if(!a)return;const l=e.Sheets[a.sheet];if(!l)return;const n=XLSX.utils.sheet_to_json(l,{header:1,defval:null});if(!n||n.length===0)return;const s={};t.forEach(r=>{s[r.id]=[]});for(let r=a.headerRowIndex+1;r<n.length;r++){const o=n[r];if(!o)continue;const i=this.parseDate(o[a.dateCol]);i&&Object.entries(a.wells).forEach(([d,c])=>{if(!s[d])return;const u=this.parseNumber(o[c.csg]),p=this.parseNumber(o[c.tbg]),f=c.fl===null?null:this.parseNumber(o[c.fl]),g=this.parseNumber(o[c.inj]);(u!==null||p!==null||f!==null||g!==null)&&s[d].push({date:i,casingPsi:u,tubingPsi:p,flowlinePsi:f,injVol:g})})}t.forEach(r=>{const o=s[r.id]||[];o.sort((i,d)=>new Date(d.date)-new Date(i.date)),r.pressureReadings=o.slice(0,60)})},parseDate(e){if(!e)return null;if(e instanceof Date)return e.toISOString().split("T")[0];if(typeof e=="number"){const t=XLSX.SSF.parse_date_code(e);if(t)return`${t.y}-${String(t.m).padStart(2,"0")}-${String(t.d).padStart(2,"0")}`}return typeof e=="string"?e.split(" ")[0]:null},parseNumber(e){if(e==null||e==="")return null;const t=parseFloat(e);return isNaN(t)?null:t<0?0:t}},je={id:"uls35h",name:"ULS 3-5H",expectedFileName:"ULS 3-5H Gauge Sheet.xlsx",wells:[{id:"uls-1-3-1h",name:"ULS 1-3-1H",oilCol:1,waterCol:2,gasCol:3},{id:"uls-1-3-3h",name:"ULS 1-3-3H",oilCol:7,waterCol:8,gasCol:9},{id:"uls-1-3-5h",name:"ULS 1-3-5H",oilCol:13,waterCol:14,gasCol:15},{id:"uls-1-3-7h",name:"ULS 1-3-7H",oilCol:19,waterCol:20,gasCol:21}],pressureConfig:{sheet:"University 3-5H",headerRowIndex:3,dateCol:0,wells:{"uls-1-3-1h":{csg:34,tbg:35,fl:36,inj:37},"uls-1-3-3h":{csg:39,tbg:40,fl:41,inj:42},"uls-1-3-5h":{csg:46,tbg:47,fl:48,inj:49},"uls-1-3-7h":{csg:51,tbg:52,fl:53,inj:54}}},productionConfig:{sheet:"University 3-5H",headerRowIndex:3,dateCol:0,oilProdCol:30,waterProdCol:31,gasProdCol:32},parse(e){const t={id:this.id,name:this.name,lastUpdated:new Date().toISOString(),wells:[],runTickets:[],rawRowCount:0,batteryProduction:[]};if(e.Sheets["Well Test"]){const a=this.parseWellTestSheet(e.Sheets["Well Test"]);t.wells=a.wells,t.rawRowCount=a.rowCount}return t.wells.length>0&&this.applyPressureReadings(e,t.wells),t.batteryProduction=this.parseBatteryProduction(e),e.Sheets["3-5H Run Tickets"]&&(t.runTickets=this.parseRunTicketsSheet(e.Sheets["3-5H Run Tickets"])),t},parseWellTestSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),a=this.wells.map(n=>({id:n.id,name:n.name,status:"active",wellTests:[],production:[],chemicalProgram:{continuous:{rate:null,chems:"-",ppm:null},truckTreat:{rate:null,chems:"-",ppm:null}},failureHistory:[],pressureReadings:[],actionItems:[]}));let l=0;for(let n=4;n<t.length;n++){const s=t[n];if(!s||!s[0])continue;const r=this.parseDate(s[0]);r&&(l++,this.wells.forEach((o,i)=>{const d=this.parseNumber(s[o.oilCol]),c=this.parseNumber(s[o.waterCol]),u=this.parseNumber(s[o.gasCol]);(d!==null||c!==null||u!==null)&&(a[i].wellTests.push({date:r,oil:d,water:c,gas:u}),a[i].production.push({date:new Date(r),oil:d,water:c,gas:u}))}))}return a.forEach(n=>{n.wellTests.sort((s,r)=>new Date(r.date)-new Date(s.date)),n.wellTests=n.wellTests.slice(0,60),n.production.sort((s,r)=>s.date-r.date)}),{wells:a,rowCount:l}},parseRunTicketsSheet(e){const t=XLSX.utils.sheet_to_json(e,{header:1,defval:null}),a=[];for(let l=3;l<t.length;l++){const n=t[l];!n||!n[1]||a.push({date:this.parseDate(n[0]),ticketNum:String(n[1]||""),tank:this.parseNumber(n[2]),ftTop:this.parseNumber(n[3]),inTop:this.parseNumber(n[4]),ftBttm:this.parseNumber(n[5]),inBttm:this.parseNumber(n[6]),vol:this.parseNumber(n[8])})}return a.sort((l,n)=>(n.date||"").localeCompare(l.date||"")),a.slice(0,100)},parseBatteryProduction(e){const t=this.productionConfig;if(!t)return[];const a=e.Sheets[t.sheet];if(!a)return[];const l=XLSX.utils.sheet_to_json(a,{header:1,defval:null});if(!l||l.length===0)return[];const n=[];for(let s=t.headerRowIndex+2;s<l.length;s++){const r=l[s];if(!r)continue;const o=this.parseDate(r[t.dateCol]);if(!o)continue;const i=this.parseNumber(r[t.oilProdCol]),d=this.parseNumber(r[t.waterProdCol]),c=t.gasProdCol!==null?this.parseNumber(r[t.gasProdCol]):null;(i!==null||d!==null||c!==null)&&n.push({date:new Date(o),oil:i,water:d,gas:c})}return n.sort((s,r)=>s.date-r.date),n},applyPressureReadings(e,t){const a=this.pressureConfig;if(!a)return;const l=e.Sheets[a.sheet];if(!l)return;const n=XLSX.utils.sheet_to_json(l,{header:1,defval:null});if(!n||n.length===0)return;const s={};t.forEach(r=>{s[r.id]=[]});for(let r=a.headerRowIndex+1;r<n.length;r++){const o=n[r];if(!o)continue;const i=this.parseDate(o[a.dateCol]);i&&Object.entries(a.wells).forEach(([d,c])=>{if(!s[d])return;const u=this.parseNumber(o[c.csg]),p=this.parseNumber(o[c.tbg]),f=this.parseNumber(o[c.fl]),g=this.parseNumber(o[c.inj]);(u!==null||p!==null||f!==null||g!==null)&&s[d].push({date:i,casingPsi:u,tubingPsi:p,flowlinePsi:f,injVol:g})})}t.forEach(r=>{const o=s[r.id]||[];o.sort((i,d)=>new Date(d.date)-new Date(i.date)),r.pressureReadings=o.slice(0,60)})},parseDate(e){if(!e)return null;if(e instanceof Date)return e.toISOString().split("T")[0];if(typeof e=="number"){const t=XLSX.SSF.parse_date_code(e);if(t)return`${t.y}-${String(t.m).padStart(2,"0")}-${String(t.d).padStart(2,"0")}`}return typeof e=="string"?e.split(" ")[0]:null},parseNumber(e){if(e==null||e==="")return null;const t=parseFloat(e);return isNaN(t)?null:t<0?0:t}},F={CowdenParser:Ie,BigMaxParser:Be,BigMax1HParser:ke,SouthAndrewsParser:Le,PolarisParser:Re,ShusaParser:Me,MWWemacParser:He,Unit130Parser:$e,ULS35HParser:je};function X(e,t){if(!e||!e.wells)return t;const a={};e.wells.forEach(n=>{a[n.id]=n});const l=t.wells.map(n=>{const s=a[n.id];return s?(delete a[n.id],We(s,n)):n});return Object.values(a).forEach(n=>{l.push(n)}),{...t,wells:l}}function We(e,t){const a=Ae(e.pressureReadings||[],t.pressureReadings||[]);return{...t,actionItems:e.actionItems||[],failureHistory:e.failureHistory||[],chemicalProgram:e.chemicalProgram||{continuous:{rate:null,chems:"-",ppm:null},truckTreat:{rate:null,chems:"-",ppm:null}},pressureReadings:a}}function Ae(e,t){const a={};e.forEach(n=>{if(n&&n.date){const s=Y(n.date);a[s]=n}}),t.forEach(n=>{if(n&&n.date){const s=Y(n.date);a[s]=n}});const l=Object.values(a);return l.sort((n,s)=>new Date(s.date)-new Date(n.date)),l.slice(0,60)}function Y(e){return e?typeof e=="string"?e.split("T")[0]:e instanceof Date?e.toISOString().split("T")[0]:String(e):""}function _e(){const e=document.getElementById("uploadArea"),t=document.getElementById("fileInput"),a=document.getElementById("btnReupload");e.addEventListener("click",l=>{l.target.id!=="btnReupload"&&t.click()}),a.addEventListener("click",l=>{l.stopPropagation(),t.click()}),t.addEventListener("change",l=>{const n=l.target.files[0];n&&Z(n),t.value=""}),e.addEventListener("dragover",l=>{l.preventDefault(),e.classList.add("drag-over")}),e.addEventListener("dragleave",()=>{e.classList.remove("drag-over")}),e.addEventListener("drop",l=>{l.preventDefault(),e.classList.remove("drag-over");const n=l.dataTransfer.files[0];n&&Z(n)})}async function Z(e){if(!h.currentSheet){alert("Please select a gauge sheet first");return}const t=C.find(r=>r.id===h.currentSheet);if(!t)return;const a=F[t.parser];if(!a){alert(`Parser not yet implemented for ${t.name}. Coming soon!`);return}const l=document.getElementById("uploadProgress"),n=document.getElementById("progressFill"),s=document.getElementById("progressText");l.style.display="block",n.style.width="10%",s.textContent="Reading file...";try{const r=await e.arrayBuffer();n.style.width="30%",s.textContent="Parsing Excel...";const o=XLSX.read(r,{type:"array",cellDates:!0});n.style.width="60%",s.textContent="Extracting data...";const i=a.parse(o);n.style.width="90%",s.textContent="Saving...";const d=h.appData[h.currentSheet];h.appData[h.currentSheet]=X(d,i),P(),n.style.width="100%",s.textContent="Complete!",setTimeout(()=>{l.style.display="none",n.style.width="0%",B(),te(h.currentSheet)},500)}catch(r){console.error("Error processing file:",r),alert("Error processing file: "+r.message),l.style.display="none"}}function Fe(){const e=document.getElementById("bulkUploadArea"),t=document.getElementById("bulkFileInput");!e||!t||(e.addEventListener("click",()=>{t.click()}),t.addEventListener("change",a=>{const l=Array.from(a.target.files);l.length>0&&J(l),t.value=""}),e.addEventListener("dragover",a=>{a.preventDefault(),e.classList.add("drag-over")}),e.addEventListener("dragleave",()=>{e.classList.remove("drag-over")}),e.addEventListener("drop",a=>{a.preventDefault(),e.classList.remove("drag-over");const l=Array.from(a.dataTransfer.files);l.length>0&&J(l)}))}async function J(e){const t=document.getElementById("bulkUploadProgress"),a=document.getElementById("bulkProgressFill"),l=document.getElementById("bulkProgressText"),n=document.getElementById("bulkUploadResults");t.style.display="block",n.style.display="none",n.innerHTML="";const s=[];let r=0;for(const o of e){a.style.width=`${r/e.length*100}%`,l.textContent=`Processing ${o.name}...`;const i=C.find(c=>o.name.toLowerCase().includes(c.fileName.toLowerCase().replace(".xlsx","").replace(".xlsm",""))||c.fileName.toLowerCase()===o.name.toLowerCase());if(!i){s.push({name:o.name,status:"skipped",detail:"Unknown file"}),r++;continue}const d=F[i.parser];if(!d){s.push({name:o.name,status:"skipped",detail:"No parser available"}),r++;continue}try{const c=await o.arrayBuffer(),u=XLSX.read(c,{type:"array",cellDates:!0}),p=d.parse(u),f=h.appData[i.id];h.appData[i.id]=X(f,p),s.push({name:i.name,status:"success",detail:`${p.wells.length} wells loaded`})}catch(c){console.error(`Error processing ${o.name}:`,c),s.push({name:o.name,status:"error",detail:c.message})}r++}P(),a.style.width="100%",l.textContent="Complete!",setTimeout(()=>{t.style.display="none",n.style.display="block",n.innerHTML=s.map(o=>`
            <div class="bulk-result-item ${o.status}">
                <span class="result-icon">${o.status==="success"?"OK":o.status==="error"?"X":"?"}</span>
                <span class="result-name">${o.name}</span>
                <span class="result-detail">${o.detail}</span>
            </div>
        `).join(""),B()},500)}async function Xe(e){const t=document.getElementById("dashboardLoadingOverlay"),a=document.getElementById("dashboardLoadingText"),l=document.getElementById("dashboardLoadingSubtext");t.classList.add("visible"),a.textContent="Processing sheets...",l.textContent=`0 of ${e.length} files`;let n=0,s=0;await new Promise(r=>setTimeout(r,50));for(const r of e){l.textContent=`${n+1} of ${e.length}: ${r.name}`;const o=C.find(d=>r.name.toLowerCase().includes(d.fileName.toLowerCase().replace(".xlsx","").replace(".xlsm",""))||d.fileName.toLowerCase()===r.name.toLowerCase());if(!o){n++;continue}const i=F[o.parser];if(!i){n++;continue}try{const d=await r.arrayBuffer(),c=XLSX.read(d,{type:"array",cellDates:!0}),u=i.parse(c),p=h.appData[o.id];h.appData[o.id]=X(p,u),s++}catch(d){console.error(`Error processing ${r.name}:`,d)}n++,await new Promise(d=>setTimeout(d,10))}a.textContent="Complete!",l.textContent=`${s} of ${e.length} sheets updated`,s>0&&(P(),B()),setTimeout(()=>{t.classList.remove("visible")},600)}let $=null;function Oe(e){$=e}function Ue(){Ve(),qe(),Ge(),ze()}function Ve(){const e=Te();document.getElementById("statDailyOil").textContent=e.totalOil.toLocaleString(),document.getElementById("statDailyWater").textContent=e.totalWater.toLocaleString(),document.getElementById("statDailyGas").textContent=e.totalGas.toLocaleString()}function qe(){const e=document.getElementById("topProducersBody"),t=Ne(10);if(t.length===0){e.innerHTML='<tr><td colspan="5" class="dashboard-empty">No production data available</td></tr>';return}e.innerHTML=t.map((a,l)=>`
        <tr data-well-id="${a.wellId}" data-sheet-id="${a.sheetId}">
            <td>${l+1}</td>
            <td class="well-name-cell">${a.wellName}</td>
            <td class="battery-name-cell">${a.batteryName}</td>
            <td>${a.oil>0?a.oil:"-"}</td>
            <td>${a.water>0?a.water:"-"}</td>
        </tr>
    `).join(""),e.querySelectorAll("tr[data-well-id]").forEach(a=>{a.addEventListener("click",()=>{const l=a.dataset.wellId,n=a.dataset.sheetId;D(n,l)})})}function Ge(){const e=document.getElementById("recentTestsBody"),t=Ee(10);if(t.length===0){e.innerHTML='<tr><td colspan="6" class="dashboard-empty">No test data available</td></tr>';return}e.innerHTML=t.map(a=>`
        <tr data-well-id="${a.wellId}" data-sheet-id="${a.sheetId}">
            <td>${v(a.date)}</td>
            <td class="well-name-cell">${a.wellName}</td>
            <td class="battery-name-cell">${a.batteryName}</td>
            <td>${a.oil!==null?a.oil:"-"}</td>
            <td>${a.water!==null?a.water:"-"}</td>
            <td>${a.gas!==null?a.gas:"-"}</td>
        </tr>
    `).join(""),e.querySelectorAll("tr[data-well-id]").forEach(a=>{a.addEventListener("click",()=>{const l=a.dataset.wellId,n=a.dataset.sheetId;D(n,l)})})}function ze(){const e=document.getElementById("dashboardActionList"),t=Pe(15);if(t.length===0){e.innerHTML='<li class="dashboard-empty" style="border-left-color: #6b7280; opacity: 0.7;">No action items</li>';return}e.innerHTML=t.map(a=>`
        <li data-well-id="${a.wellId}" data-sheet-id="${a.sheetId}">
            <div class="action-item-content">${a.content}</div>
            <div class="action-item-source">
                <span class="source-well">${a.wellName}</span> - ${a.batteryName}
            </div>
        </li>
    `).join(""),e.querySelectorAll("li[data-well-id]").forEach(a=>{a.style.cursor="pointer",a.addEventListener("click",()=>{const l=a.dataset.wellId,n=a.dataset.sheetId;D(n,l)})})}function Ke(){const e=document.getElementById("btnReuploadAll"),t=document.getElementById("bulkFileInputDashboard"),a=document.getElementById("btnClearCache");e&&t&&(e.addEventListener("click",()=>{t.click()}),t.addEventListener("change",l=>{const n=Array.from(l.target.files);n.length>0&&Xe(n),t.value=""})),a&&a.addEventListener("click",()=>{confirm("Clear all cached data? You will need to re-upload your gauge sheets.")&&Ye()})}function Ye(){localStorage.removeItem(W),h.appData={},$&&$()}function k(e,t,a){if(!e||e.length===0){alert("No data available to download.");return}const l=[];l.push(t.join(",")),e.forEach(i=>{const d=t.map(c=>{const u=i[c.toLowerCase().replace(/[^a-z0-9]/g,"")]??i[c]??"",p=String(u).replace(/"/g,'""');return p.includes(",")||p.includes('"')||p.includes(`
`)?`"${p}"`:p});l.push(d.join(","))});const n=l.join(`
`),s=new Blob([n],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a"),o=URL.createObjectURL(s);r.setAttribute("href",o),r.setAttribute("download",a),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(o)}function L(e){return e?new Date(e).toLocaleDateString("en-US"):""}function S(e){document.querySelectorAll(".view").forEach(l=>l.classList.remove("active"));const a={welcome:"welcomeView",gaugeSheet:"gaugeSheetView",well:"wellView",battery:"batteryView",oilChart:"oilChartView",waterChart:"waterChartView",gasChart:"gasChartView"}[e];a&&document.getElementById(a).classList.add("active")}function x(){const e=document.getElementById("welcomeUploadPrompt"),t=document.getElementById("operationsDashboard");ee()?(e.style.display="none",t.style.display="block",Ue()):(e.style.display="block",t.style.display="none")}function te(e){const t=C.find(s=>s.id===e);if(!t)return;h.currentSheet=e,S("gaugeSheet"),document.getElementById("sheetName").textContent=t.name,document.getElementById("sheetBreadcrumb").textContent=`Gauge Sheet: ${t.fileName}`,document.getElementById("expectedFileName").textContent=t.fileName;const a=h.appData[e],l=document.getElementById("uploadPrompt"),n=document.getElementById("uploadStatus");a&&a.wells?(l.style.display="none",n.style.display="flex",document.getElementById("lastUploadDate").textContent=v(a.lastUpdated),document.getElementById("rowCount").textContent=a.rawRowCount||"-"):(l.style.display="block",n.style.display="none"),Je(e)}function D(e,t){const a=h.appData[e];if(!a||!a.wells)return;const l=a.wells.find(s=>s.id===t);if(!l)return;h.currentSheet=e,h.currentWell=t,S("well");const n=C.find(s=>s.id===e);document.getElementById("wellName").textContent=l.name,document.getElementById("wellBreadcrumb").textContent=`${n.name} > ${l.name}`,_(l),Qe(l.wellTests||[]),et(l.chemicalProgram||{}),tt(l.failureHistory||[]),nt("wellActionList",l.actionItems||[]),at(l.pressureReadings||[]),st(l.pressureReadings||[]),ce(),Ze(l)}function Ze(e){const t=e.name.replace(/[^a-zA-Z0-9]/g,"_"),a=document.getElementById("btnDownloadProduction");if(a){const s=a.cloneNode(!0);a.parentNode.replaceChild(s,a),s.addEventListener("click",()=>{const r=e.production||[],o=document.getElementById("productionStartDate"),i=document.getElementById("productionEndDate");let d=r.filter(u=>u.date);if(o&&o.value){const u=new Date(o.value);d=d.filter(p=>new Date(p.date)>=u)}if(i&&i.value){const u=new Date(i.value);u.setHours(23,59,59,999),d=d.filter(p=>new Date(p.date)<=u)}d.sort((u,p)=>new Date(u.date)-new Date(p.date));const c=d.map(u=>({date:L(u.date),oilbbl:u.oil!==null&&u.oil!==void 0?Math.round(u.oil*100)/100:"",waterbbl:u.water!==null&&u.water!==void 0?Math.round(u.water*100)/100:"",gasmcf:u.gas!==null&&u.gas!==void 0?Math.round(Math.max(0,u.gas)*100)/100:""}));k(c,["Date","Oil (bbl)","Water (bbl)","Gas (mcf)"],`${t}_Production.csv`)})}const l=document.getElementById("btnDownloadWellTests");if(l){const s=l.cloneNode(!0);l.parentNode.replaceChild(s,l),s.addEventListener("click",()=>{const r=e.wellTests||[],o=new Date;o.setHours(23,59,59,999);const d=r.filter(c=>new Date(c.date)<=o).map(c=>({date:L(c.date),oilbbl:c.oil!==null?Math.round(c.oil*100)/100:"",waterbbl:c.water!==null?Math.round(c.water*100)/100:"",gasmcf:c.gas!==null?Math.round(Math.max(0,c.gas)*100)/100:""}));k(d,["Date","Oil (bbl)","Water (bbl)","Gas (mcf)"],`${t}_Well_Tests.csv`)})}const n=document.getElementById("btnDownloadPressure");if(n){const s=n.cloneNode(!0);n.parentNode.replaceChild(s,n),s.addEventListener("click",()=>{const o=(e.pressureReadings||[]).map(i=>({date:L(i.date),casingpsi:i.casingPsi||"",tubingpsi:i.tubingPsi||"",flowlinepsi:i.flowlinePsi||"",injvol:i.injVol||""}));k(o,["Date","Casing PSI","Tubing PSI","Flowline PSI","Inj Vol"],`${t}_Pressure_Readings.csv`)})}}function Je(e){const t=document.getElementById("wellsGrid"),a=h.appData[e];if(!a||!a.wells||a.wells.length===0){t.innerHTML='<p class="empty-message">Upload gauge sheet to see wells</p>';return}const l=a.wells.filter(n=>n.status!=="inactive");if(l.length===0){t.innerHTML='<p class="empty-message">No active wells</p>';return}t.innerHTML=l.map(n=>{const s=n.wellTests&&n.wellTests[0],r=s?Math.round(s.oil*100)/100:null,o=s&&s.gas!==null?Math.round(Math.max(0,s.gas)*100)/100:null;return`
            <div class="well-card" data-well-id="${n.id}" data-sheet-id="${e}">
                <h4>${n.name}</h4>
                <div class="well-stats">
                    <div class="well-stat">
                        <span class="well-stat-label">Latest Oil</span>
                        <span class="well-stat-value">${r!==null?r+" bbl":"-"}</span>
                    </div>
                    <div class="well-stat">
                        <span class="well-stat-label">Latest Gas</span>
                        <span class="well-stat-value">${o!==null?o+" mcf":"-"}</span>
                    </div>
                </div>
            </div>
        `}).join(""),t.querySelectorAll(".well-card").forEach(n=>{n.addEventListener("click",()=>{const s=n.dataset.wellId,r=n.dataset.sheetId;D(r,s)})})}function Qe(e){const t=document.querySelector("#wellTestTable tbody"),a=new Date;if(a.setHours(23,59,59,999),!e||e.length===0){t.innerHTML='<tr><td colspan="4" style="text-align: center; color: #6b7280;">No test data</td></tr>';return}const l=e.filter(n=>new Date(n.date)<=a);if(l.length===0){t.innerHTML='<tr><td colspan="4" style="text-align: center; color: #6b7280;">No test data</td></tr>';return}t.innerHTML=l.map(n=>{const s=n.gas!==null?Math.round(Math.max(0,n.gas)*100)/100:null;return`
            <tr>
                <td>${v(n.date)}</td>
                <td>${n.oil!==null?Math.round(n.oil*100)/100:"-"}</td>
                <td>${n.water!==null?Math.round(n.water*100)/100:"-"}</td>
                <td>${s!==null?s:"-"}</td>
            </tr>
        `}).join("")}function et(e){const t=e.continuous||{},a=e.truckTreat||{};document.getElementById("chemContRate").textContent=t.rate||"-",document.getElementById("chemContChems").textContent=t.chems||"-",document.getElementById("chemContPPM").textContent=t.ppm||"-",document.getElementById("chemTruckRate").textContent=a.rate||"-",document.getElementById("chemTruckChems").textContent=a.chems||"-",document.getElementById("chemTruckPPM").textContent=a.ppm||"-"}function tt(e){const t=document.querySelector("#failureTable tbody");if(!e||e.length===0){t.innerHTML='<tr><td colspan="6" style="text-align: center; color: #6b7280;">No failure history</td></tr>';return}t.innerHTML=e.map(a=>`
        <tr>
            <td>${v(a.dateDown)}</td>
            <td>${v(a.dateUp)}</td>
            <td>${a.downtime||"-"}</td>
            <td>${a.oil||"-"}</td>
            <td>${a.reason||"-"}</td>
            <td>${a.comments||"-"}</td>
        </tr>
    `).join("")}function nt(e,t){const a=document.getElementById(e);if(!t||t.length===0){a.innerHTML='<li style="border-left-color: #6b7280; opacity: 0.7;">No action items</li>';return}a.innerHTML=t.map(l=>`<li>${l}</li>`).join("")}function at(e){const t=document.querySelector("#pressureTable tbody");if(!e||e.length===0){t.innerHTML='<tr><td colspan="5" style="text-align: center; color: #6b7280;">No pressure data</td></tr>';return}t.innerHTML=e.map(a=>`
        <tr>
            <td>${v(a.date)}</td>
            <td>${a.casingPsi||"-"}</td>
            <td>${a.tubingPsi||"-"}</td>
            <td>${a.flowlinePsi||"-"}</td>
            <td>${a.injVol||"-"}</td>
        </tr>
    `).join("")}function st(e){const t=document.getElementById("pressureChartsCard"),a=document.getElementById("pressureChartsWrapper");if(h.pressureCharts.psi&&(h.pressureCharts.psi.destroy(),h.pressureCharts.psi=null),h.pressureCharts.injVol&&(h.pressureCharts.injVol.destroy(),h.pressureCharts.injVol=null),!e||e.length<=20){t.style.display="none";return}const l=e.some(i=>i.casingPsi!==null&&i.casingPsi!==void 0&&!isNaN(i.casingPsi)),n=e.some(i=>i.tubingPsi!==null&&i.tubingPsi!==void 0&&!isNaN(i.tubingPsi)),s=e.some(i=>i.flowlinePsi!==null&&i.flowlinePsi!==void 0&&!isNaN(i.flowlinePsi)),r=e.some(i=>i.injVol!==null&&i.injVol!==void 0&&!isNaN(i.injVol)),o=l||n||s;if(!o&&!r){t.style.display="none";return}if(t.style.display="block",a.innerHTML="",o){const i=document.createElement("div");i.className="chart-section";let d="";const c=[];l&&c.push({id:"casing",label:"Casing PSI",color:"#f97316"}),n&&c.push({id:"tubing",label:"Tubing PSI",color:"#3b82f6"}),s&&c.push({id:"flowline",label:"Flowline PSI",color:"#8b5cf6"}),c.length>1&&(d=`
                <div class="pressure-chart-filters">
                    ${c.map(g=>`
                        <label class="pressure-filter-option">
                            <input type="checkbox" class="pressure-filter-checkbox" data-psi-type="${g.id}" checked>
                            <span class="filter-color-indicator" style="background-color: ${g.color};"></span>
                            <span>${g.label}</span>
                        </label>
                    `).join("")}
                </div>
            `),i.innerHTML=`
            <div class="chart-header-with-filters">
                <div class="chart-label">Pressure Readings (PSI)</div>
                ${d}
            </div>
            <div class="canvas-wrapper">
                <canvas id="chart-pressure-psi"></canvas>
            </div>
        `,a.appendChild(i);const u=[];if(l){const g=e.filter(m=>m.date&&m.casingPsi!==null&&m.casingPsi!==void 0).map(m=>({x:new Date(m.date),y:Number(m.casingPsi)})).filter(m=>!isNaN(m.y)).sort((m,w)=>m.x-w.x);u.push({label:"Casing PSI",data:g,borderColor:"#f97316",backgroundColor:"#f97316",pointRadius:2,pointHoverRadius:5,borderWidth:2})}if(n){const g=e.filter(m=>m.date&&m.tubingPsi!==null&&m.tubingPsi!==void 0).map(m=>({x:new Date(m.date),y:Number(m.tubingPsi)})).filter(m=>!isNaN(m.y)).sort((m,w)=>m.x-w.x);u.push({label:"Tubing PSI",data:g,borderColor:"#3b82f6",backgroundColor:"#3b82f6",pointRadius:2,pointHoverRadius:5,borderWidth:2})}if(s){const g=e.filter(m=>m.date&&m.flowlinePsi!==null&&m.flowlinePsi!==void 0).map(m=>({x:new Date(m.date),y:Number(m.flowlinePsi)})).filter(m=>!isNaN(m.y)).sort((m,w)=>m.x-w.x);u.push({label:"Flowline PSI",data:g,borderColor:"#8b5cf6",backgroundColor:"#8b5cf6",pointRadius:2,pointHoverRadius:5,borderWidth:2})}const p=document.getElementById("chart-pressure-psi").getContext("2d");h.pressureCharts.psi=new Chart(p,{type:"line",data:{datasets:u},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:"#282c33",titleColor:"#e8e9eb",bodyColor:"#e8e9eb",callbacks:{title:g=>new Date(g[0].parsed.x).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),label:g=>`${g.dataset.label}: ${g.parsed.y} PSI`}}},scales:{x:{type:"time",time:{displayFormats:{day:"MMM-yy",week:"MMM-yy",month:"MMM-yy",quarter:"MMM-yy",year:"yyyy"}},grid:{color:"#3a3f47"},ticks:{color:"#9ea3ab",maxTicksLimit:8}},y:{beginAtZero:!0,title:{display:!0,text:"PSI",color:"#9ea3ab"},grid:{color:"#3a3f47"},ticks:{color:"#9ea3ab"}}}}}),i.querySelectorAll(".pressure-filter-checkbox").forEach((g,m)=>{g.addEventListener("change",w=>{const y=u.findIndex(b=>{const T=w.target.dataset.psiType;return T==="casing"?b.label==="Casing PSI":T==="tubing"?b.label==="Tubing PSI":T==="flowline"?b.label==="Flowline PSI":!1});if(y!==-1){const b=h.pressureCharts.psi.getDatasetMeta(y);b.hidden=!w.target.checked,h.pressureCharts.psi.update()}})})}if(r){const i=document.createElement("div");i.className="chart-section",i.innerHTML=`
            <div class="chart-label">Injection Volume</div>
            <div class="canvas-wrapper">
                <canvas id="chart-pressure-injvol"></canvas>
            </div>
        `,a.appendChild(i);const d=e.filter(u=>u.date&&u.injVol!==null&&u.injVol!==void 0).map(u=>({x:new Date(u.date),y:Number(u.injVol)})).filter(u=>!isNaN(u.y)).sort((u,p)=>u.x-p.x),c=document.getElementById("chart-pressure-injvol").getContext("2d");h.pressureCharts.injVol=new Chart(c,{type:"line",data:{datasets:[{label:"Injection Volume",data:d,borderColor:"#22c55e",backgroundColor:"#22c55e",pointRadius:2,pointHoverRadius:5,borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:"#282c33",titleColor:"#e8e9eb",bodyColor:"#e8e9eb",callbacks:{title:u=>new Date(u[0].parsed.x).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),label:u=>`Injection Volume: ${u.parsed.y}`}}},scales:{x:{type:"time",time:{displayFormats:{day:"MMM-yy",week:"MMM-yy",month:"MMM-yy",quarter:"MMM-yy",year:"yyyy"}},grid:{color:"#3a3f47"},ticks:{color:"#9ea3ab",maxTicksLimit:8}},y:{beginAtZero:!0,title:{display:!0,text:"Volume",color:"#9ea3ab"},grid:{color:"#3a3f47"},ticks:{color:"#9ea3ab"}}}}})}}function O(e=null,t=null){S("oilChart"),q("oil",e,t)}function U(e=null,t=null){S("waterChart"),q("water",e,t)}function V(e=null,t=null){S("gasChart"),q("gas",e,t)}function q(e,t=null,a=null){var g;const n={oil:{canvasId:"aggregateOilChart",label:"Oil Production (BBL)",unit:"BBL",color:"#78716c",dateRangeVar:"oilChartDateRange",startDateId:"oilChartStartDate",endDateId:"oilChartEndDate",resetBtnId:"btnResetOilDates",showFn:O},water:{canvasId:"aggregateWaterChart",label:"Water Consumption (BBL)",unit:"BBL",color:"#3b82f6",dateRangeVar:"waterChartDateRange",startDateId:"waterChartStartDate",endDateId:"waterChartEndDate",resetBtnId:"btnResetWaterDates",showFn:U},gas:{canvasId:"aggregateGasChart",label:"Gas Production (MCF)",unit:"MCF",color:"#22c55e",dateRangeVar:"gasChartDateRange",startDateId:"gasChartStartDate",endDateId:"gasChartEndDate",resetBtnId:"btnResetGasDates",showFn:V}}[e];if(!n)return;e==="oil"&&h.aggregateOilChart?(h.aggregateOilChart.destroy(),h.aggregateOilChart=null):e==="water"&&h.aggregateWaterChart?(h.aggregateWaterChart.destroy(),h.aggregateWaterChart=null):e==="gas"&&h.aggregateGasChart&&(h.aggregateGasChart.destroy(),h.aggregateGasChart=null);const s=rt(e),r=((g=h.chartState[e])==null?void 0:g.aggregation)||"month";h.chartState[e].selectedBatteries=s;const{data:o,dateRange:i}=xe(e,t,a,r,s);e==="oil"?h.oilChartDateRange=i:e==="water"?h.waterChartDateRange=i:e==="gas"&&(h.gasChartDateRange=i),lt(e,n,t,a,i);const d={oil:"oilChartBatteries",water:"waterChartBatteries",gas:"gasChartBatteries"},c=document.getElementById(d[e]);c&&!c.querySelector(".explorer-battery")&&it(e),ot(e);const u=document.getElementById(n.canvasId);if(!u)return;if(o.length===0){const m=u.getContext("2d");m.clearRect(0,0,u.width,u.height),m.font="14px Archivo, sans-serif",m.fillStyle="#6b7280",m.textAlign="center",m.fillText("No production data available",u.width/2,u.height/2);return}const p=u.getContext("2d"),f=new Chart(p,{type:"line",data:{datasets:[{label:n.label,data:o,backgroundColor:n.color+"33",borderColor:n.color,borderWidth:2,fill:!0,tension:.1,pointRadius:2,pointHoverRadius:5}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:"#282c33",titleColor:"#e8e9eb",bodyColor:"#e8e9eb",callbacks:{title:m=>new Date(m[0].parsed.x).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),label:m=>`${n.label}: ${m.parsed.y.toLocaleString()}`}}},scales:{x:{type:"time",time:{displayFormats:{day:"MMM-yy",week:"MMM-yy",month:"MMM-yy",quarter:"MMM-yy",year:"yyyy"}},grid:{color:"#3a3f47"},ticks:{color:"#9ea3ab",maxTicksLimit:12}},y:{beginAtZero:!0,title:{display:!0,text:n.unit,color:"#9ea3ab"},grid:{color:"#3a3f47"},ticks:{color:"#9ea3ab"}}}}});e==="oil"?h.aggregateOilChart=f:e==="water"?h.aggregateWaterChart=f:e==="gas"&&(h.aggregateGasChart=f)}function lt(e,t,a,l,n){const s=document.getElementById(t.startDateId),r=document.getElementById(t.endDateId),o=document.getElementById(t.resetBtnId);if(!s||!r||!n.min||!n.max)return;const i=m=>m?new Date(m).toISOString().split("T")[0]:"",d=i(n.min),c=i(n.max);s.min=d,s.max=c,r.min=d,r.max=c,s.value=a?i(a):d,r.value=l?i(l):c;const u=s.cloneNode(!0),p=r.cloneNode(!0),f=o.cloneNode(!0);s.parentNode.replaceChild(u,s),r.parentNode.replaceChild(p,r),o.parentNode.replaceChild(f,o);const g=()=>{const m=u.value?new Date(u.value):null,w=p.value?new Date(p.value+"T23:59:59"):null;t.showFn(m,w)};u.addEventListener("change",g),p.addEventListener("change",g),f.addEventListener("click",()=>t.showFn(null,null))}function rt(e){const t={oil:"oilChartBatteries",water:"waterChartBatteries",gas:"gasChartBatteries"},a=document.getElementById(t[e]);if(!a)return null;const l=new Set;return a.querySelectorAll(".battery-checkbox:checked").forEach(n=>{n.dataset.battery&&l.add(n.dataset.battery)}),l.size>0?l:null}function j(e){const a={oil:{startDateId:"oilChartStartDate",endDateId:"oilChartEndDate",showFn:O},water:{startDateId:"waterChartStartDate",endDateId:"waterChartEndDate",showFn:U},gas:{startDateId:"gasChartStartDate",endDateId:"gasChartEndDate",showFn:V}}[e];if(!a)return;const l=document.getElementById(a.startDateId),n=document.getElementById(a.endDateId),s=l&&l.value?new Date(l.value):null,r=n&&n.value?new Date(n.value+"T23:59:59"):null;a.showFn(s,r)}function ot(e){var l;const t=document.querySelectorAll(`input[name="${e}Aggregation"]`);if(!t.length)return;t.forEach(n=>{const s=n.cloneNode(!0);n.parentNode.replaceChild(s,n)});const a=((l=h.chartState[e])==null?void 0:l.aggregation)||"month";document.querySelectorAll(`input[name="${e}Aggregation"]`).forEach(n=>{n.checked=n.value===a,n.addEventListener("change",s=>{h.chartState[e].aggregation=s.target.value,j(e)})})}function it(e){var o;const t={oil:"oilChartBatteries",water:"waterChartBatteries",gas:"gasChartBatteries"},a=document.getElementById(t[e]);if(!a)return;if(a.innerHTML="",!ee()){a.innerHTML='<div class="explorer-empty">No data uploaded</div>';return}const l=()=>{const i={oil:"btnToggleAllOil",water:"btnToggleAllWater",gas:"btnToggleAllGas"},d=document.getElementById(i[e]);if(!d)return;const c=a.querySelectorAll(".battery-checkbox");if(!c.length)return;const u=Array.from(c).every(p=>p.checked);d.textContent=u?"Deselect All":"Select All"},n=((o=h.chartState[e])==null?void 0:o.selectedBatteries)||null;C.forEach(i=>{const d=h.appData[i.id];if(!d||!(d.batteryProduction&&d.batteryProduction.length>0||d.wells&&d.wells.length>0))return;const u=!n||n.has(i.id),p=document.createElement("label");p.className="explorer-battery-simple explorer-checkbox",p.innerHTML=`
            <input type="checkbox" class="battery-checkbox" data-battery="${i.id}" ${u?"checked":""}>
            <span class="checkmark"></span>
            <span class="battery-name">${i.name}</span>
        `,a.appendChild(p),p.querySelector(".battery-checkbox").addEventListener("change",()=>{j(e),l()})});const s={oil:"btnToggleAllOil",water:"btnToggleAllWater",gas:"btnToggleAllGas"},r=document.getElementById(s[e]);if(r){const i=r.cloneNode(!0);r.parentNode.replaceChild(i,r),i.addEventListener("click",()=>{const d=a.querySelectorAll(".battery-checkbox"),c=Array.from(d).every(u=>u.checked);d.forEach(u=>{u.checked=!c}),i.textContent=c?"Select All":"Deselect All",j(e)}),l()}}function dt(){const e=document.getElementById("logoLink");e&&e.addEventListener("click",t=>{t.preventDefault(),document.querySelectorAll(".nav-item").forEach(l=>l.classList.remove("active")),h.currentSheet=null,h.currentWell=null,S("welcome"),x();const a=document.getElementById("nav-dashboard");a&&I(a)})}function ct(){const e=document.getElementById("hamburgerBtn"),t=document.getElementById("sidebar");e&&t&&(e.addEventListener("click",()=>{t.classList.toggle("collapsed");const l=t.classList.contains("collapsed");localStorage.setItem("sidebarCollapsed",l?"true":"false")}),localStorage.getItem("sidebarCollapsed")==="true"&&t.classList.add("collapsed"))}function ne(){const e=document.getElementById("navTree");e.innerHTML="";const t=ut("Home","home-section",[{id:"nav-dashboard",label:"Operations Dashboard",icon:"dashboard",action:()=>{S("welcome"),x()}},{id:"nav-oil-chart",label:"Oil Production",icon:"oil",action:()=>O()},{id:"nav-water-chart",label:"Water Consumption",icon:"water",action:()=>U()},{id:"nav-gas-chart",label:"Gas Production",icon:"gas",action:()=>V()}]);e.appendChild(t);const a=pt();e.appendChild(a)}function ut(e,t,a){const l=document.createElement("div");l.className="nav-section",l.id=t;const n=document.createElement("div");n.className="nav-section-header expanded",n.innerHTML=`
        <span class="nav-section-title">${e}</span>
        <span class="nav-section-chevron">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
        </span>
    `;const s=document.createElement("div");return s.className="nav-section-children visible",a.forEach(r=>{const o=ht(r);s.appendChild(o)}),n.addEventListener("click",()=>{n.classList.toggle("expanded"),s.classList.toggle("visible")}),l.appendChild(n),l.appendChild(s),l}function ht(e){const t=document.createElement("div");t.className="nav-section-item";const a={dashboard:`<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="7" height="7"></rect>
            <rect x="14" y="3" width="7" height="7"></rect>
            <rect x="14" y="14" width="7" height="7"></rect>
            <rect x="3" y="14" width="7" height="7"></rect>
           </svg>`,oil:`<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#78716c" stroke-width="2">
            <path d="M12 2C12 2 4 10 4 15a8 8 0 0 0 16 0c0-5-8-13-8-13z"></path>
           </svg>`,water:`<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#3b82f6" stroke-width="2">
            <path d="M12 2C12 2 4 10 4 15a8 8 0 0 0 16 0c0-5-8-13-8-13z"></path>
           </svg>`,gas:`<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#22c55e" stroke-width="2">
            <path d="M12 2v6m0 4v10M5 12h14M8 6h8M6 18h12"></path>
           </svg>`,chart:`<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
           </svg>`},l=a[e.icon]||a.chart;t.innerHTML=`
        <div class="nav-item" id="${e.id}" data-tooltip="${e.label}">
            <span class="nav-item-icon">${l}</span>
            <span class="nav-item-label">${e.label}</span>
        </div>
    `;const n=t.querySelector(".nav-item");return n.addEventListener("click",s=>{s.stopPropagation(),I(n),e.action()}),t}function pt(){const e=document.createElement("div");e.className="nav-section",e.id="wells-section";const t=document.createElement("div");t.className="nav-section-header expanded",t.innerHTML=`
        <span class="nav-section-title">Wells</span>
        <span class="nav-section-chevron">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
        </span>
    `;const a=document.createElement("div");return a.className="nav-section-children visible",C.forEach(l=>{const n=mt(l);a.appendChild(n)}),t.addEventListener("click",()=>{t.classList.toggle("expanded"),a.classList.toggle("visible")}),e.appendChild(t),e.appendChild(a),e}function mt(e){const t=document.createElement("div");t.className="nav-gauge-sheet";const a=h.appData[e.id]&&h.appData[e.id].wells,l=a?h.appData[e.id].wells.filter(o=>o.status!=="inactive"):[],n=l.length;t.innerHTML=`
        <div class="nav-item" data-sheet-id="${e.id}">
            <span class="icon">&#9632;</span>
            <span class="nav-battery-name">${e.name}</span>
            <span class="upload-indicator ${a?"uploaded":"not-uploaded"}">
                ${a?n+" wells":"No data"}
            </span>
        </div>
        <div class="nav-children" id="sheet-children-${e.id}"></div>
    `;const s=t.querySelector(".nav-item"),r=t.querySelector(".nav-children");return s.addEventListener("click",o=>{o.stopPropagation(),I(s),te(e.id),a&&l.length>0&&(s.classList.toggle("expanded"),r.classList.toggle("visible"))}),a&&l.forEach(o=>{const i=gt(o,e);r.appendChild(i)}),t}function gt(e,t){const a=document.createElement("div");a.className="nav-well",a.innerHTML=`
        <div class="nav-item" data-well-id="${e.id}" data-sheet-id="${t.id}">
            <span class="status-dot active"></span>
            <span class="nav-well-name">${e.name}</span>
        </div>
    `;const l=a.querySelector(".nav-item");return l.addEventListener("click",n=>{n.stopPropagation(),I(l),D(t.id,e.id)}),a}function I(e){document.querySelectorAll(".nav-item").forEach(t=>t.classList.remove("active")),e.classList.add("active")}function B(){ne(),x()}document.addEventListener("DOMContentLoaded",()=>{ae(),re(),ne(),_e(),Fe(),Ke(),dt(),ct(),se(),x(),S("welcome")});de((e,t)=>{D(e,t)});Oe(()=>{B(),x()});
